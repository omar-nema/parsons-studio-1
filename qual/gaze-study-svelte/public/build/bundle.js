var app=function(){"use strict";function e(){}const t=e=>e;function n(e,t){for(const n in t)e[n]=t[n];return e}function r(e){return e()}function i(){return Object.create(null)}function o(e){e.forEach(r)}function s(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let l;function c(e,t){return l||(l=document.createElement("a")),l.href=t,e===l.href}function u(t,...n){if(null==t)return e;const r=t.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function h(e){let t;return u(e,(e=>t=e))(),t}function d(e,t,n){e.$$.on_destroy.push(u(t,n))}function f(e,t,n){return e.set(n),t}const p="undefined"!=typeof window;let g=p?()=>window.performance.now():()=>Date.now(),_=p?e=>requestAnimationFrame(e):e;const m=new Set;function v(e){m.forEach((t=>{t.c(e)||(m.delete(t),t.f())})),0!==m.size&&_(v)}function y(e){let t;return 0===m.size&&_(v),{promise:new Promise((n=>{m.add(t={c:e,f:n})})),abort(){m.delete(t)}}}function w(e,t){e.appendChild(t)}function b(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function C(e){const t=I("style");return function(e,t){w(e.head||e,t)}(b(e),t),t}function x(e,t,n){e.insertBefore(t,n||null)}function k(e){e.parentNode.removeChild(e)}function E(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function I(e){return document.createElement(e)}function S(e){return document.createTextNode(e)}function T(){return S(" ")}function N(){return S("")}function R(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function P(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function M(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function A(e,t){e.value=null==t?"":t}function O(e,t,n,r){e.style.setProperty(t,n,r?"important":"")}function D(e,t){for(let n=0;n<e.options.length;n+=1){const r=e.options[n];if(r.__value===t)return void(r.selected=!0)}e.selectedIndex=-1}function L(e,t,n){e.classList[n?"add":"remove"](t)}const $=new Set;let F,q=0;function j(e,t,n,r,i,o,s,a=0){const l=16.666/r;let c="{\n";for(let e=0;e<=1;e+=l){const r=t+(n-t)*o(e);c+=100*e+`%{${s(r,1-r)}}\n`}const u=c+`100% {${s(n,1-n)}}\n}`,h=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${a}`,d=b(e);$.add(d);const f=d.__svelte_stylesheet||(d.__svelte_stylesheet=C(e).sheet),p=d.__svelte_rules||(d.__svelte_rules={});p[h]||(p[h]=!0,f.insertRule(`@keyframes ${h} ${u}`,f.cssRules.length));const g=e.style.animation||"";return e.style.animation=`${g?`${g}, `:""}${h} ${r}ms linear ${i}ms 1 both`,q+=1,h}function z(e,t){const n=(e.style.animation||"").split(", "),r=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),i=n.length-r.length;i&&(e.style.animation=r.join(", "),q-=i,q||_((()=>{q||($.forEach((e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}})),$.clear())})))}function B(e){F=e}function W(e){(function(){if(!F)throw new Error("Function called outside component initialization");return F})().$$.on_mount.push(e)}const U=[],H=[],V=[],G=[],Y=Promise.resolve();let K=!1;function X(e){V.push(e)}let Q=!1;const J=new Set;function Z(){if(!Q){Q=!0;do{for(let e=0;e<U.length;e+=1){const t=U[e];B(t),ee(t.$$)}for(B(null),U.length=0;H.length;)H.pop()();for(let e=0;e<V.length;e+=1){const t=V[e];J.has(t)||(J.add(t),t())}V.length=0}while(U.length);for(;G.length;)G.pop()();K=!1,Q=!1,J.clear()}}function ee(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(X)}}let te;function ne(e,t,n){e.dispatchEvent(function(e,t,n=!1){const r=document.createEvent("CustomEvent");return r.initCustomEvent(e,n,!1,t),r}(`${t?"intro":"outro"}${n}`))}const re=new Set;let ie;function oe(){ie={r:0,c:[],p:ie}}function se(){ie.r||o(ie.c),ie=ie.p}function ae(e,t){e&&e.i&&(re.delete(e),e.i(t))}function le(e,t,n,r){if(e&&e.o){if(re.has(e))return;re.add(e),ie.c.push((()=>{re.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}}const ce={duration:0};function ue(n,r,i,a){let l=r(n,i),c=a?0:1,u=null,h=null,d=null;function f(){d&&z(n,d)}function p(e,t){const n=e.b-c;return t*=Math.abs(n),{a:c,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function _(r){const{delay:i=0,duration:s=300,easing:a=t,tick:_=e,css:m}=l||ce,v={start:g()+i,b:r};r||(v.group=ie,ie.r+=1),u||h?h=v:(m&&(f(),d=j(n,c,r,s,i,a,m)),r&&_(0,1),u=p(v,s),X((()=>ne(n,r,"start"))),y((e=>{if(h&&e>h.start&&(u=p(h,s),h=null,ne(n,u.b,"start"),m&&(f(),d=j(n,c,u.b,u.duration,0,a,l.css))),u)if(e>=u.end)_(c=u.b,1-c),ne(n,u.b,"end"),h||(u.b?f():--u.group.r||o(u.group.c)),u=null;else if(e>=u.start){const t=e-u.start;c=u.a+u.d*a(t/u.duration),_(c,1-c)}return!(!u&&!h)})))}return{run(e){s(l)?(te||(te=Promise.resolve(),te.then((()=>{te=null}))),te).then((()=>{l=l(),_(e)})):_(e)},end(){f(),u=h=null}}}const he="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function de(e){e&&e.c()}function fe(e,t,n,i){const{fragment:a,on_mount:l,on_destroy:c,after_update:u}=e.$$;a&&a.m(t,n),i||X((()=>{const t=l.map(r).filter(s);c?c.push(...t):o(t),e.$$.on_mount=[]})),u.forEach(X)}function pe(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ge(e,t){-1===e.$$.dirty[0]&&(U.push(e),K||(K=!0,Y.then(Z)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function _e(t,n,r,s,a,l,c,u=[-1]){const h=F;B(t);const d=t.$$={fragment:null,ctx:null,props:l,update:e,not_equal:a,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(h?h.$$.context:[])),callbacks:i(),dirty:u,skip_bound:!1,root:n.target||h.$$.root};c&&c(d.root);let f=!1;if(d.ctx=r?r(t,n.props||{},((e,n,...r)=>{const i=r.length?r[0]:n;return d.ctx&&a(d.ctx[e],d.ctx[e]=i)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](i),f&&ge(t,e)),n})):[],d.update(),f=!0,o(d.before_update),d.fragment=!!s&&s(d.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);d.fragment&&d.fragment.l(e),e.forEach(k)}else d.fragment&&d.fragment.c();n.intro&&ae(t.$$.fragment),fe(t,n.target,n.anchor,n.customElement),Z()}B(h)}class me{$destroy(){pe(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const ve=[];function ye(t,n=e){let r;const i=new Set;function o(e){if(a(t,e)&&(t=e,r)){const e=!ve.length;for(const e of i)e[1](),ve.push(e,t);if(e){for(let e=0;e<ve.length;e+=2)ve[e][0](ve[e+1]);ve.length=0}}}return{set:o,update:function(e){o(e(t))},subscribe:function(s,a=e){const l=[s,a];return i.add(l),1===i.size&&(r=n(o)||e),s(t),()=>{i.delete(l),0===i.size&&(r(),r=null)}}}}let we=ye("gallery"),be=ye("intro"),Ce=ye(null),xe=ye([]),ke=ye([]),Ee=ye(!1),Ie=ye(!1),Se=ye(!1),Te=ye(null),Ne=function(e,t){return{subscribe:ye(e,t).subscribe}}(10),Re=ye(0),Pe=ye(!0),Me=ye(null),Ae=ye(null),Oe=ye(null),De=ye(null),Le=ye(null),$e=ye(null),Fe=ye(null),qe=ye(null),je=ye(-1);var ze=()=>{const e=window.innerWidth,t=window.innerHeight,n={mobile:e<640,sm:e>=640&&e<768,md:e>=768&&e<1024,lg:e>=1024&&e<1100,medLg:e>=1100&&e<1280,xl:e>=1280&&e<1536,"2xl":e>=1536},r=Object.keys(n).filter((e=>n[e]))[0];return{windowW:e,windowH:t,screens:n,screenSize:r}};function Be(e){const t=e-1;return t*t*t+1}function We(e){return--e*e*e*e*e+1}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function Ue(e,{delay:n=0,duration:r=400,easing:i=t}={}){const o=+getComputedStyle(e).opacity;return{delay:n,duration:r,easing:i,css:e=>"opacity: "+e*o}}function He(e,{delay:t=0,duration:n=400,easing:r=Be}={}){const i=getComputedStyle(e),o=+i.opacity,s=parseFloat(i.height),a=parseFloat(i.paddingTop),l=parseFloat(i.paddingBottom),c=parseFloat(i.marginTop),u=parseFloat(i.marginBottom),h=parseFloat(i.borderTopWidth),d=parseFloat(i.borderBottomWidth);return{delay:t,duration:n,easing:r,css:e=>`overflow: hidden;opacity: ${Math.min(20*e,1)*o};height: ${e*s}px;padding-top: ${e*a}px;padding-bottom: ${e*l}px;margin-top: ${e*c}px;margin-bottom: ${e*u}px;border-top-width: ${e*h}px;border-bottom-width: ${e*d}px;`}}function Ve(e){var{fallback:t}=e,r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["fallback"]);const i=new Map,o=new Map;function a(e,i,o){return(a,l)=>(e.set(l.key,{rect:a.getBoundingClientRect()}),()=>{if(i.has(l.key)){const{rect:e}=i.get(l.key);return i.delete(l.key),function(e,t,i){const{delay:o=0,duration:a=(e=>30*Math.sqrt(e)),easing:l=Be}=n(n({},r),i),c=t.getBoundingClientRect(),u=e.left-c.left,h=e.top-c.top,d=e.width/c.width,f=e.height/c.height,p=Math.sqrt(u*u+h*h),g=getComputedStyle(t),_="none"===g.transform?"":g.transform,m=+g.opacity;return{delay:o,duration:s(a)?a(p):a,easing:l,css:(e,t)=>`\n\t\t\t\topacity: ${e*m};\n\t\t\t\ttransform-origin: top left;\n\t\t\t\ttransform: ${_} translate(${t*u}px,${t*h}px) scale(${e+(1-e)*d}, ${e+(1-e)*f});\n\t\t\t`}}(e,a,l)}return e.delete(l.key),t&&t(a,l,o)})}return[a(o,i,!1),a(i,o,!0)]}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function Ge(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))}function Ye(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function Ke(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Xe(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function Qe(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Je=!1,Ze="${JSCORE_VERSION}",et=function(e,t){if(!e)throw tt(t)},tt=function(e){return new Error("Firebase Database ("+Ze+") INTERNAL ASSERT FAILED: "+e)},nt=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},rt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],o=t+1<e.length,s=o?e[t+1]:0,a=t+2<e.length,l=a?e[t+2]:0,c=i>>2,u=(3&i)<<4|s>>4;let h=(15&s)<<2|l>>6,d=63&l;a||(d=64,o||(h=64)),r.push(n[c],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(nt(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){const o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{const o=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],o=t<e.length?n[e.charAt(t)]:0;++t;const s=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==o||null==s||null==a)throw Error();const l=i<<2|o>>4;if(r.push(l),64!==s){const e=o<<4&240|s>>2;if(r.push(e),64!==a){const e=s<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},it=function(e){try{return rt.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function ot(e){return st(void 0,e)}function st(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=st(e[n],t[n]));return e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class at{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function lt(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test("undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:"")}function ct(){return!0===Je}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ut extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,ut.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ht.prototype.create)}}class ht{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?function(e,t){return e.replace(dt,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",s=`${this.serviceName}: ${o} (${r}).`;return new ut(r,s,n)}}const dt=/\{\$([^}]+)}/g;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ft(e){return JSON.parse(e)}function pt(e){return JSON.stringify(e)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const gt=function(e){let t={},n={},r={},i="";try{const o=e.split(".");t=ft(it(o[0])||""),n=ft(it(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function _t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function mt(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function vt(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function yt(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function wt(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],o=t[i];if(bt(n)&&bt(o)){if(!wt(n,o))return!1}else if(n!==o)return!1}for(const e of r)if(!n.includes(e))return!1;return!0}function bt(e){return null!==e&&"object"==typeof e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Ct{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"==typeof e)for(let r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){const t=n[e-3]^n[e-8]^n[e-14]^n[e-16];n[e]=4294967295&(t<<1|t>>>31)}let r,i,o=this.chain_[0],s=this.chain_[1],a=this.chain_[2],l=this.chain_[3],c=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(r=l^s&(a^l),i=1518500249):(r=s^a^l,i=1859775393):e<60?(r=s&a|l&(s|a),i=2400959708):(r=s^a^l,i=3395469782);const t=(o<<5|o>>>27)+r+c+i+n[e]&4294967295;c=l,l=a,a=4294967295&(s<<30|s>>>2),s=o,o=t}this.chain_[0]=this.chain_[0]+o&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const i=this.buf_;let o=this.inbuf_;for(;r<t;){if(0===o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let t=0;t<5;t++)for(let r=24;r>=0;r-=8)e[n]=this.chain_[t]>>r&255,++n;return e}}function xt(e,t){return`${e} failed: ${t} argument `}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const kt=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Et(e){return e&&e._delegate?e._delegate:e}var It=function(){function e(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return e.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},e.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},e.prototype.setServiceProps=function(e){return this.serviceProps=e,this},e.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},e}(),St="[DEFAULT]",Tt=function(){function e(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return e.prototype.get=function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new at;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise},e.prototype.getImmediate=function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}},e.prototype.getComponent=function(){return this.component},e.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e))try{this.getOrInitializeService({instanceIdentifier:St})}catch(e){}try{for(var r=Ke(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=Xe(i.value,2),s=o[0],a=o[1],l=this.normalizeInstanceIdentifier(s);try{var c=this.getOrInitializeService({instanceIdentifier:l});a.resolve(c)}catch(e){}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}},e.prototype.clearInstance=function(e){void 0===e&&(e=St),this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)},e.prototype.delete=function(){return Ge(this,void 0,void 0,(function(){var e;return Ye(this,(function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(Qe(Qe([],Xe(e.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()})))),Xe(e.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))))];case 1:return t.sent(),[2]}}))}))},e.prototype.isComponentSet=function(){return null!=this.component},e.prototype.isInitialized=function(e){return void 0===e&&(e=St),this.instances.has(e)},e.prototype.getOptions=function(e){return void 0===e&&(e=St),this.instancesOptions.get(e)||{}},e.prototype.initialize=function(e){var t,n;void 0===e&&(e={});var r=e.options,i=void 0===r?{}:r,o=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(o))throw Error(this.name+"("+o+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var s=this.getOrInitializeService({instanceIdentifier:o,options:i});try{for(var a=Ke(this.instancesDeferred.entries()),l=a.next();!l.done;l=a.next()){var c=Xe(l.value,2),u=c[0],h=c[1];o===this.normalizeInstanceIdentifier(u)&&h.resolve(s)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return s},e.prototype.onInit=function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&e(o,r),function(){i.delete(e)}},e.prototype.invokeOnInitCallbacks=function(e,t){var n,r,i=this.onInitCallbacks.get(t);if(i)try{for(var o=Ke(i),s=o.next();!s.done;s=o.next()){var a=s.value;try{a(e,t)}catch(e){}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},e.prototype.getOrInitializeService=function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===St?void 0:t),options:i}),this.instances.set(n,o),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(o,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(e){}return o||null},e.prototype.normalizeInstanceIdentifier=function(e){return void 0===e&&(e=St),this.component?this.component.multipleInstances?e:St:e},e.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},e}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Nt,Rt=function(){function e(e){this.name=e,this.providers=new Map}return e.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component "+e.name+" has already been registered with "+this.name);t.setComponent(e)},e.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},e.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new Tt(e,this);return this.providers.set(e,t),t},e.prototype.getProviders=function(){return Array.from(this.providers.values())},e}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(Nt||(Nt={}));const Pt={debug:Nt.DEBUG,verbose:Nt.VERBOSE,info:Nt.INFO,warn:Nt.WARN,error:Nt.ERROR,silent:Nt.SILENT},Mt=Nt.INFO,At={[Nt.DEBUG]:"log",[Nt.VERBOSE]:"log",[Nt.INFO]:"info",[Nt.WARN]:"warn",[Nt.ERROR]:"error"},Ot=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=At[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class Dt{constructor(e){this.name=e,this._logLevel=Mt,this._logHandler=Ot,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Nt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?Pt[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Nt.DEBUG,...e),this._logHandler(this,Nt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Nt.VERBOSE,...e),this._logHandler(this,Nt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Nt.INFO,...e),this._logHandler(this,Nt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Nt.WARN,...e),this._logHandler(this,Nt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Nt.ERROR,...e),this._logHandler(this,Nt.ERROR,...e)}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Lt{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const $t="@firebase/app",Ft="0.7.4",qt=new Dt("@firebase/app"),jt="[DEFAULT]",zt={[$t]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},Bt=new Map,Wt=new Map;function Ut(e,t){try{e.container.addComponent(t)}catch(n){qt.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Ht(e){const t=e.name;if(Wt.has(t))return qt.debug(`There were multiple attempts to register component ${t}.`),!1;Wt.set(t,e);for(const t of Bt.values())Ut(t,e);return!0}function Vt(e,t){return e.container.getProvider(t)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Gt=new ht("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function."});
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Yt{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new It("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Gt.create("app-deleted",{appName:this._name})}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Kt="9.1.3";function Xt(e="[DEFAULT]"){const t=Bt.get(e);if(!t)throw Gt.create("no-app",{appName:e});return t}function Qt(e,t,n){var r;let i=null!==(r=zt[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const o=i.match(/\s|\//),s=t.match(/\s|\//);if(o||s){const e=[`Unable to register library "${i}" with version "${t}":`];return o&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&s&&e.push("and"),s&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void qt.warn(e.join(" "))}Ht(new It(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Jt;Jt="",Ht(new It("platform-logger",(e=>new Lt(e)),"PRIVATE")),Qt($t,Ft,Jt),Qt($t,Ft,"esm2017"),Qt("fire-js","");var Zt;
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
Qt("firebase","9.1.3","app"),function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(Zt||(Zt={}));
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const en="firebasestorage.googleapis.com";class tn extends ut{constructor(e,t){super(nn(e),`Firebase Storage: ${t} (${nn(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,tn.prototype)}_codeEquals(e){return nn(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}function nn(e){return"storage/"+e}function rn(e){return new tn("invalid-argument",e)}function on(){return new tn("app-deleted","The Firebase app was deleted.")}function sn(e){throw new tn("internal-error","Internal error: "+e)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class an{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=Zt.NO_ERROR,this.sendPromise_=new Promise((e=>{this.xhr_.addEventListener("abort",(()=>{this.errorCode_=Zt.ABORT,e()})),this.xhr_.addEventListener("error",(()=>{this.errorCode_=Zt.NETWORK_ERROR,e()})),this.xhr_.addEventListener("load",(()=>{e()}))}))}send(e,t,n,r){if(this.sent_)throw sn("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(const e in r)r.hasOwnProperty(e)&&this.xhr_.setRequestHeader(e,r[e].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw sn("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw sn("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponseText(){if(!this.sent_)throw sn("cannot .getResponseText() before sending");return this.xhr_.responseText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class ln{createConnection(){return new an}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class cn{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=cn.makeFromUrl(e,t)}catch(t){return new cn(e,"")}if(""===n.path)return n;throw new tn("invalid-default-bucket","Invalid default bucket '"+e+"'.")}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";const i=new RegExp("^gs://"+r+"(/(.*))?$","i");function o(e){e.path_=decodeURIComponent(e.path)}const s=t.replace(/[.]/g,"\\."),a=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${s}/v[A-Za-z0-9_]+/b/${r}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:o},{regex:new RegExp(`^https?://${t===en?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${r}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:o}];for(let t=0;t<a.length;t++){const r=a[t],i=r.regex.exec(e);if(i){const e=i[r.indices.bucket];let t=i[r.indices.path];t||(t=""),n=new cn(e,t),r.postModify(n);break}}if(null==n)throw function(e){return new tn("invalid-url","Invalid URL '"+e+"'.")}(e);return n}}class un{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function hn(e,t,n,r){if(r<t)throw rn(`Invalid value for '${e}'. Expected ${t} or greater.`);if(r>n)throw rn(`Invalid value for '${e}'. Expected ${n} or less.`)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class dn{constructor(e,t,n,r,i,o,s,a,l,c,u){this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=s,this.errorCallback_=a,this.timeout_=l,this.progressCallback_=c,this.pool_=u,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()}))}start_(){const e=(e,t)=>{if(t)return void e(!1,new fn(!1,null,!0));const n=this.pool_.createConnection();this.pendingConnection_=n;const r=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.body_,this.headers_).then((()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;const t=n.getErrorCode()===Zt.NO_ERROR,i=n.getStatus();if(!t||this.isRetryStatusCode_(i)){const t=n.getErrorCode()===Zt.ABORT;return void e(!1,new fn(!1,null,t))}const o=-1!==this.successCodes_.indexOf(i);e(!0,new fn(o,n))}))},t=(e,t)=>{const n=this.resolve_,r=this.reject_,i=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(i,i.getResponseText());void 0!==e?n(e):n()}catch(e){r(e)}else if(null!==i){const e=new tn("unknown","An unknown error occurred, please check the error payload for server response.");e.serverResponse=i.getResponseText(),this.errorCallback_?r(this.errorCallback_(i,e)):r(e)}else if(t.canceled){r(this.appDelete_?on():new tn("canceled","User canceled the upload/download."))}else{r(new tn("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))}};this.canceled_?t(0,new fn(!1,null,!0)):this.backoffId_=function(e,t,n){let r=1,i=null,o=!1,s=0;function a(){return 2===s}let l=!1;function c(...e){l||(l=!0,t.apply(null,e))}function u(t){i=setTimeout((()=>{i=null,e(h,a())}),t)}function h(e,...t){if(l)return;if(e)return void c.call(null,e,...t);if(a()||o)return void c.call(null,e,...t);let n;r<64&&(r*=2),1===s?(s=2,n=0):n=1e3*(r+Math.random()),u(n)}let d=!1;function f(e){d||(d=!0,l||(null!==i?(e||(s=2),clearTimeout(i),u(0)):e||(s=1)))}return u(0),setTimeout((()=>{o=!0,f(!0)}),n),f}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function(e){e(!1)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}isRetryStatusCode_(e){const t=e>=500&&e<600,n=-1!==[408,429].indexOf(e),r=-1!==this.additionalRetryCodes_.indexOf(e);return t||n||r}}class fn{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function pn(e,t,n,r,i,o){const s=function(e){const t=encodeURIComponent;let n="?";for(const r in e)e.hasOwnProperty(r)&&(n=n+(t(r)+"=")+t(e[r])+"&");return n=n.slice(0,-1),n}(e.urlParams),a=e.url+s,l=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(l,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(l,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!=t?t:"AppManager")}(l,o),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(l,r),new dn(a,e.method,l,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class gn{constructor(e,t){this._service=e,this._location=t instanceof cn?t:cn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new gn(e,t)}get root(){const e=new cn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return function(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new cn(this._location.bucket,e);return new gn(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new tn("invalid-root-operation","The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function _n(e,t){const n=null==t?void 0:t.storageBucket;return null==n?null:cn.makeFromBucketSpec(n,e)}class mn{constructor(e,t,n,r,i,o){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._pool=r,this._url=i,this._firebaseVersion=o,this._bucket=null,this._host=en,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?cn.makeFromBucketSpec(i,this._host):_n(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=cn.makeFromBucketSpec(this._url,e):this._bucket=_n(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){hn("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){hn("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach((e=>e.cancel())),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new gn(this,e)}_makeRequest(e,t,n){if(this._deleted)return new un(on());{const r=pn(e,this._appId,t,n,this._pool,this._firebaseVersion);return this._requests.add(r),r.getPromise().then((()=>this._requests.delete(r)),(()=>this._requests.delete(r))),r}}async makeRequestWithTokens(e){const[t,n]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n)}}const vn="@firebase/storage",yn="0.8.4",wn="storage";function bn(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return new mn(n,r,i,new ln,t,Kt)}Ht(new It(wn,bn,"PUBLIC").setMultipleInstances(!0)),Qt(vn,yn,""),Qt(vn,yn,"esm2017");const Cn="@firebase/database",xn="0.12.2";
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
let kn="";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class En{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),pt(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:ft(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class In{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return _t(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Sn=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new En(t)}}catch(e){}return new In},Tn=Sn("localStorage"),Nn=Sn("sessionStorage"),Rn=new Dt("@firebase/database"),Pn=function(){let e=1;return function(){return e++}}(),Mn=function(e){const t=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);if(i>=55296&&i<=56319){const t=i-55296;r++,et(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(t<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}(e),n=new Ct;n.update(t);const r=n.digest();return rt.encodeByteArray(r)},An=function(...e){let t="";for(let n=0;n<e.length;n++){const r=e[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?t+=An.apply(null,r):t+="object"==typeof r?pt(r):r,t+=" "}return t};let On=null,Dn=!0;const Ln=function(...e){var t,n;if(!0===Dn&&(Dn=!1,null===On&&!0===Nn.get("logging_enabled")&&(t=!0,et(!n||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(Rn.logLevel=Nt.VERBOSE,On=Rn.log.bind(Rn),n&&Nn.set("logging_enabled",!0)):"function"==typeof t?On=t:(On=null,Nn.remove("logging_enabled")))),On){const t=An.apply(null,e);On(t)}},$n=function(e){return function(...t){Ln(e,...t)}},Fn=function(...e){const t="FIREBASE INTERNAL ERROR: "+An(...e);Rn.error(t)},qn=function(...e){const t=`FIREBASE FATAL ERROR: ${An(...e)}`;throw Rn.error(t),new Error(t)},jn=function(...e){const t="FIREBASE WARNING: "+An(...e);Rn.warn(t)},zn=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},Bn="[MIN_NAME]",Wn="[MAX_NAME]",Un=function(e,t){if(e===t)return 0;if(e===Bn||t===Wn)return-1;if(t===Bn||e===Wn)return 1;{const n=Jn(e),r=Jn(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}},Hn=function(e,t){return e===t?0:e<t?-1:1},Vn=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+pt(t))},Gn=function(e){if("object"!=typeof e||null===e)return pt(e);const t=[];for(const n in e)t.push(n);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=pt(t[r]),n+=":",n+=Gn(e[t[r]]);return n+="}",n},Yn=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function Kn(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const Xn=function(e){et(!zn(e),"Invalid JSON number");const t=1023;let n,r,i,o,s;0===e?(r=0,i=0,n=1/e==-1/0?1:0):(n=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(o=Math.min(Math.floor(Math.log(e)/Math.LN2),t),r=o+t,i=Math.round(e*Math.pow(2,52-o)-Math.pow(2,52))):(r=0,i=Math.round(e/Math.pow(2,-1074))));const a=[];for(s=52;s;s-=1)a.push(i%2?1:0),i=Math.floor(i/2);for(s=11;s;s-=1)a.push(r%2?1:0),r=Math.floor(r/2);a.push(n?1:0),a.reverse();const l=a.join("");let c="";for(s=0;s<64;s+=8){let e=parseInt(l.substr(s,8),2).toString(16);1===e.length&&(e="0"+e),c+=e}return c.toLowerCase()},Qn=new RegExp("^-?(0*)\\d{1,10}$"),Jn=function(e){if(Qn.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},Zn=function(e){try{e()}catch(e){setTimeout((()=>{const t=e.stack||"";throw jn("Exception was thrown by user callback.",t),e}),Math.floor(0))}},er=function(e,t){const n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n};
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class tr{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){jn(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class nr{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(Ln("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',jn(e)}}class rr{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}rr.OWNER="owner";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const ir=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,or="websocket",sr="long_polling";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class ar{constructor(e,t,n,r,i=!1,o="",s=!1){this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Tn.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Tn.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function lr(e,t,n){let r;if(et("string"==typeof t,"typeof type must == string"),et("object"==typeof n,"typeof params must == object"),t===or)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==sr)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const i=[];return Kn(n,((e,t)=>{i.push(e+"="+t)})),r+i.join("&")}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class cr{constructor(){this.counters_={}}incrementCounter(e,t=1){_t(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return ot(this.counters_)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const ur={},hr={};function dr(e){const t=e.toString();return ur[t]||(ur[t]=new cr),ur[t]}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class fr{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&Zn((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const pr="start";class gr{constructor(e,t,n,r,i,o,s){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=s,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=$n(e),this.stats_=dr(t),this.urlFn=e=>(this.appCheckToken&&(e.ac=this.appCheckToken),lr(t,sr,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new fr(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new _r(((...e)=>{const[t,n,r,i,o]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===pr)this.id=n,this.password=r;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...e)=>{const[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)}),(()=>{this.onClosed_()}),this.urlFn);const e={start:"t"};e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&ir.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){gr.forceAllow_=!0}static forceDisallow(){gr.forceDisallow_=!0}static isAvailable(){return!!gr.forceAllow_||!(gr.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI)}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=pt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=function(e){const t=nt(e);return rt.encodeByteArray(t,!0)}(t),r=Yn(n,1840);for(let e=0;e<r.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=pt(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class _r{constructor(e,t,n,r){this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Pn(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=_r.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)){n='<script>document.domain="'+document.domain+'";<\/script>'}const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(e){Ln("frame writing exception"),e.stack&&Ln(e.stack),Ln(e)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Ln("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(r),n()}))}addTag(e,t){setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{Ln("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(e){}}),Math.floor(1))}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */let mr=null;"undefined"!=typeof MozWebSocket?mr=MozWebSocket:"undefined"!=typeof WebSocket&&(mr=WebSocket);class vr{constructor(e,t,n,r,i,o,s){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=$n(this.connId),this.stats_=dr(t),this.connURL=vr.connectionURL_(t,o,s,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r){const i={v:"5"};return"undefined"!=typeof location&&location.hostname&&ir.test(location.hostname)&&(i.r="f"),t&&(i.s=t),n&&(i.ls=n),r&&(i.ac=r),lr(e,or,i)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Tn.set("previous_websocket_failure",!0);try{if(ct());else{const e={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new mr(this.connURL,[],e)}}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){vr.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==mr&&!vr.forceDisallow_}static previouslyFailed(){return Tn.isInMemoryStorage||!0===Tn.get("previous_websocket_failure")}markConnectionHealthy(){Tn.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=ft(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(et(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=pt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=Yn(t,16384);n.length>1&&this.sendString_(String(n.length));for(let e=0;e<n.length;e++)this.sendString_(n[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}vr.responsesRequiredToBeHealthy=2,vr.healthyTimeout=3e4;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class yr{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[gr,vr]}initTransports_(e){const t=vr&&vr.isAvailable();let n=t&&!vr.previouslyFailed();if(e.webSocketOnly&&(t||jn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[vr];else{const e=this.transports_=[];for(const t of yr.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t)}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class wr{constructor(e,t,n,r,i,o,s,a,l,c){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=s,this.onDisconnect_=a,this.onKill_=l,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=$n("c:"+this.id+":"),this.transportManager_=new yr(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=er((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Vn("t",e),n=Vn("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Vn("t",e),n=Vn("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Vn("t",e);if("d"in e){const n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?Fn("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Fn("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&jn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),er((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):er((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Tn.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class br{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Cr{constructor(e){this.allowedEvents_=e,this.listeners_={},et(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let e=0;e<n.length;e++)n[e].callback.apply(n[e].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let e=0;e<r.length;e++)if(r[e].callback===t&&(!n||n===r[e].context))return void r.splice(e,1)}validateEventType_(e){et(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class xr extends Cr{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||lt()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new xr}getInitialEvent(e){return et("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class kr{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Er(){return new kr("")}function Ir(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function Sr(e){return e.pieces_.length-e.pieceNum_}function Tr(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new kr(e.pieces_,t)}function Nr(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function Rr(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function Pr(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new kr(t,0)}function Mr(e,t){const n=[];for(let t=e.pieceNum_;t<e.pieces_.length;t++)n.push(e.pieces_[t]);if(t instanceof kr)for(let e=t.pieceNum_;e<t.pieces_.length;e++)n.push(t.pieces_[e]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new kr(n,0)}function Ar(e){return e.pieceNum_>=e.pieces_.length}function Or(e,t){const n=Ir(e),r=Ir(t);if(null===n)return t;if(n===r)return Or(Tr(e),Tr(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Dr(e,t){if(Sr(e)!==Sr(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Lr(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(Sr(e)>Sr(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class $r{constructor(e,t){this.errorPrefix_=t,this.parts_=Rr(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let e=0;e<this.parts_.length;e++)this.byteLength_+=kt(this.parts_[e]);Fr(this)}}function Fr(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+qr(e))}function qr(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class jr extends Cr{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new jr}getInitialEvent(e){return et("visible"===e,"Unknown event type: "+e),[this.visible_]}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const zr=1e3;class Br extends br{constructor(e,t,n,r,i,o,s,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=s,this.authOverride_=a,this.id=Br.nextPersistentConnectionId_++,this.log_=$n("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=zr,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!ct())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");jr.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&xr.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(pt(i)),et(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new at,n={p:e._path.toString(),q:e._queryObject},r={action:"g",request:n,onComplete:e=>{const r=e.d;"ok"===e.s?(this.onDataUpdate_(n.p,r,!1,null),t.resolve(r)):t.reject(r)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_||setTimeout((()=>{const e=this.outstandingGets_[i];void 0!==e&&r===e&&(delete this.outstandingGets_[i],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),this.log_("get "+i+" timed out on connection"),t.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(i),t.promise}listen(e,t,n,r){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),et(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),et(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const s={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(o).set(i,s),this.connected_&&this.sendListen_(s)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest("q",i,(i=>{const o=i.d,s=i.s;Br.warnOnListenWarnings_(o,t);(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",i),"ok"!==s&&this.removeListen_(n,r),e.onComplete&&e.onComplete(s,o))}))}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&_t(e,"w")){const n=mt(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();jn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(e){const t=gt(e).claims;return"object"==typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=function(e){const t=gt(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")}(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),et(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(e=>{r&&setTimeout((()=>{r(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();const o={p:t,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;const s=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(s):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+pt(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):Fn("Unrecognized action received from server: "+pt(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){et(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=zr,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=zr,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=zr),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+Br.nextConnectionId_++,i=this.lastSessionId;let o=!1,s=null;const a=function(){s?s.close():(o=!0,n())},l=function(e){et(s,"sendRequest call when we're not connected not allowed."),s.sendRequest(e)};this.realtime_={close:a,sendRequest:l};const c=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[a,l]=await Promise.all([this.authTokenProvider_.getToken(c),this.appCheckTokenProvider_.getToken(c)]);o?Ln("getToken() completed but was canceled"):(Ln("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=l&&l.token,s=new wr(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{jn(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),i))}catch(e){this.log_("Failed to get token: "+e),o||(this.repoInfo_.nodeAdmin&&jn(e),a())}}}interrupt(e){Ln("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Ln("Resuming connection for reason: "+e),delete this.interruptReasons_[e],vt(this.interruptReasons_)&&(this.reconnectDelay_=zr,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>Gn(e))).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new kr(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){Ln("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Ln("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};e["sdk.js."+kn.replace(/\./g,"-")]=1,lt()?e["framework.cordova"]=1:"object"==typeof navigator&&"ReactNative"===navigator.product&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=xr.getInstance().currentlyOnline();return vt(this.interruptReasons_)&&e}}Br.nextPersistentConnectionId_=0,Br.nextConnectionId_=0;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Wr{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Wr(e,t)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ur{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new Wr(Bn,e),r=new Wr(Bn,t);return 0!==this.compare(n,r)}minPost(){return Wr.MIN}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */let Hr;class Vr extends Ur{static get __EMPTY_NODE(){return Hr}static set __EMPTY_NODE(e){Hr=e}compare(e,t){return Un(e.name,t.name)}isDefinedOn(e){throw tt("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Wr.MIN}maxPost(){return new Wr(Wn,Hr)}makePost(e,t){return et("string"==typeof e,"KeyIndex indexValue must always be a string."),new Wr(e,Hr)}toString(){return".key"}}const Gr=new Vr;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Yr{constructor(e,t,n,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?n(e.key,t):1,r&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Kr{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Kr.RED,this.left=null!=r?r:Xr.EMPTY_NODE,this.right=null!=i?i:Xr.EMPTY_NODE}copy(e,t,n,r,i){return new Kr(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return Xr.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return Xr.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Kr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Kr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Kr.RED=!0,Kr.BLACK=!1;class Xr{constructor(e,t=Xr.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Xr(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Kr.BLACK,null,null))}remove(e){return new Xr(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Kr.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Yr(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Yr(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Yr(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Yr(this.root_,null,this.comparator_,!0,e)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Qr(e,t){return Un(e.name,t.name)}function Jr(e,t){return Un(e,t)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */let Zr;Xr.EMPTY_NODE=new class{copy(e,t,n,r,i){return this}insert(e,t,n){return new Kr(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const ei=function(e){return"number"==typeof e?"number:"+Xn(e):"string:"+e},ti=function(e){if(e.isLeafNode()){const t=e.val();et("string"==typeof t||"number"==typeof t||"object"==typeof t&&_t(t,".sv"),"Priority must be a string or number.")}else et(e===Zr||e.isEmpty(),"priority of unexpected type.");et(e===Zr||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
let ni,ri,ii;class oi{constructor(e,t=oi.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,et(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),ti(this.priorityNode_)}static set __childrenNodeConstructor(e){ni=e}static get __childrenNodeConstructor(){return ni}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new oi(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:oi.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Ar(e)?this:".priority"===Ir(e)?this.priorityNode_:oi.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:oi.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=Ir(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(et(".priority"!==n||1===Sr(e),".priority must be the last token in a path"),this.updateImmediateChild(n,oi.__childrenNodeConstructor.EMPTY_NODE.updateChild(Tr(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+ei(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?Xn(this.value_):this.value_,this.lazyHash_=Mn(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===oi.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof oi.__childrenNodeConstructor?-1:(et(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=oi.VALUE_TYPE_ORDER.indexOf(t),i=oi.VALUE_TYPE_ORDER.indexOf(n);return et(r>=0,"Unknown leaf type: "+t),et(i>=0,"Unknown leaf type: "+n),r===i?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}oi.VALUE_TYPE_ORDER=["object","boolean","number","string"];const si=new class extends Ur{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?Un(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Wr.MIN}maxPost(){return new Wr(Wn,new oi("[PRIORITY-POST]",ii))}makePost(e,t){const n=ri(e);return new Wr(t,new oi("[PRIORITY-POST]",n))}toString(){return".priority"}},ai=Math.log(2);
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class li{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/ai,10)),this.current_=this.count-1;const n=(r=this.count,parseInt(Array(r+1).join("1"),2));var r;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const ci=function(e,t,n,r){e.sort(t);const i=function(t,r){const o=r-t;let s,a;if(0===o)return null;if(1===o)return s=e[t],a=n?n(s):s,new Kr(a,s.node,Kr.BLACK,null,null);{const l=parseInt(o/2,10)+t,c=i(t,l),u=i(l+1,r);return s=e[l],a=n?n(s):s,new Kr(a,s.node,Kr.BLACK,c,u)}},o=function(t){let r=null,o=null,s=e.length;const a=function(t,r){const o=s-t,a=s;s-=t;const c=i(o+1,a),u=e[o],h=n?n(u):u;l(new Kr(h,u.node,r,null,c))},l=function(e){r?(r.left=e,r=e):(o=e,r=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),r=Math.pow(2,t.count-(e+1));n?a(r,Kr.BLACK):(a(r,Kr.BLACK),a(r,Kr.RED))}return o}(new li(e.length));return new Xr(r||t,o)};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */let ui;const hi={};class di{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return et(hi&&si,"ChildrenNode.ts has not been loaded"),ui=ui||new di({".priority":hi},{".priority":si}),ui}get(e){const t=mt(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Xr?t:null}hasIndex(e){return _t(this.indexSet_,e.toString())}addIndex(e,t){et(e!==Gr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const i=t.getIterator(Wr.Wrap);let o,s=i.getNext();for(;s;)r=r||e.isDefinedOn(s.node),n.push(s),s=i.getNext();o=r?ci(n,e.getCompare()):hi;const a=e.toString(),l=Object.assign({},this.indexSet_);l[a]=e;const c=Object.assign({},this.indexes_);return c[a]=o,new di(c,l)}addToIndexes(e,t){const n=yt(this.indexes_,((n,r)=>{const i=mt(this.indexSet_,r);if(et(i,"Missing index implementation for "+r),n===hi){if(i.isDefinedOn(e.node)){const n=[],r=t.getIterator(Wr.Wrap);let o=r.getNext();for(;o;)o.name!==e.name&&n.push(o),o=r.getNext();return n.push(e),ci(n,i.getCompare())}return hi}{const r=t.get(e.name);let i=n;return r&&(i=i.remove(new Wr(e.name,r))),i.insert(e,e.node)}}));return new di(n,this.indexSet_)}removeFromIndexes(e,t){const n=yt(this.indexes_,(n=>{if(n===hi)return n;{const r=t.get(e.name);return r?n.remove(new Wr(e.name,r)):n}}));return new di(n,this.indexSet_)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */let fi;class pi{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&ti(this.priorityNode_),this.children_.isEmpty()&&et(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return fi||(fi=new pi(new Xr(Jr),null,di.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||fi}updatePriority(e){return this.children_.isEmpty()?this:new pi(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?fi:t}}getChild(e){const t=Ir(e);return null===t?this:this.getImmediateChild(t).getChild(Tr(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(et(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new Wr(e,t);let r,i;t.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),i=this.indexMap_.addToIndexes(n,this.children_));const o=r.isEmpty()?fi:this.priorityNode_;return new pi(r,o,i)}}updateChild(e,t){const n=Ir(e);if(null===n)return t;{et(".priority"!==Ir(e)||1===Sr(e),".priority must be the last token in a path");const r=this.getImmediateChild(n).updateChild(Tr(e),t);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,i=!0;if(this.forEachChild(si,((o,s)=>{t[o]=s.val(e),n++,i&&pi.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):i=!1})),!e&&i&&r<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+ei(this.getPriority().val())+":"),this.forEachChild(si,((t,n)=>{const r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":Mn(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new Wr(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Wr(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Wr(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,Wr.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,Wr.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===gi?-1:0}withIndex(e){if(e===Gr||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new pi(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Gr||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(si),n=t.getIterator(si);let r=e.getNext(),i=n.getNext();for(;r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=e.getNext(),i=n.getNext()}return null===r&&null===i}return!1}return!1}}resolveIndex_(e){return e===Gr?null:this.indexMap_.get(e.toString())}}pi.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const gi=new class extends pi{constructor(){super(new Xr(Jr),pi.EMPTY_NODE,di.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return pi.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Wr,{MIN:{value:new Wr(Bn,pi.EMPTY_NODE)},MAX:{value:new Wr(Wn,gi)}}),Vr.__EMPTY_NODE=pi.EMPTY_NODE,oi.__childrenNodeConstructor=pi,Zr=gi,function(e){ii=e}(gi);function _i(e,t=null){if(null===e)return pi.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),et(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e){return new oi(e,_i(t))}if(e instanceof Array){let n=pi.EMPTY_NODE;return Kn(e,((t,r)=>{if(_t(e,t)&&"."!==t.substring(0,1)){const e=_i(r);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}})),n.updatePriority(_i(t))}{const n=[];let r=!1;if(Kn(e,((e,t)=>{if("."!==e.substring(0,1)){const i=_i(t);i.isEmpty()||(r=r||!i.getPriority().isEmpty(),n.push(new Wr(e,i)))}})),0===n.length)return pi.EMPTY_NODE;const i=ci(n,Qr,(e=>e.name),Jr);if(r){const e=ci(n,si.getCompare());return new pi(i,_i(t),new di({".priority":e},{".priority":si}))}return new pi(i,_i(t),di.Default)}}!function(e){ri=e}(_i);
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class mi extends Ur{constructor(e){super(),this.indexPath_=e,et(!Ar(e)&&".priority"!==Ir(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?Un(e.name,t.name):i}makePost(e,t){const n=_i(e),r=pi.EMPTY_NODE.updateChild(this.indexPath_,n);return new Wr(t,r)}maxPost(){const e=pi.EMPTY_NODE.updateChild(this.indexPath_,gi);return new Wr(Wn,e)}toString(){return Rr(this.indexPath_,0).join("/")}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const vi=new class extends Ur{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?Un(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Wr.MIN}maxPost(){return Wr.MAX}makePost(e,t){const n=_i(e);return new Wr(t,n)}toString(){return".value"}};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function yi(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function wi(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function bi(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Ci{constructor(e){this.index_=e}updateChild(e,t,n,r,i,o){et(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const s=e.getImmediateChild(t);return s.getChild(r).equals(n.getChild(r))&&s.isEmpty()===n.isEmpty()?e:(null!=o&&(n.isEmpty()?e.hasChild(t)?o.trackChildChange(wi(t,s)):et(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?o.trackChildChange(yi(t,n)):o.trackChildChange(bi(t,n,s))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(si,((e,r)=>{t.hasChild(e)||n.trackChildChange(wi(e,r))})),t.isLeafNode()||t.forEachChild(si,((t,r)=>{if(e.hasChild(t)){const i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(bi(t,r,i))}else n.trackChildChange(yi(t,r))}))),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?pi.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class xi{constructor(e){this.indexedFilter_=new Ci(e.getIndex()),this.index_=e.getIndex(),this.startPost_=xi.getStartPost_(e),this.endPost_=xi.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,t,n,r,i,o){return this.matches(new Wr(t,n))||(n=pi.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,o)}updateFullNode(e,t,n){t.isLeafNode()&&(t=pi.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(pi.EMPTY_NODE);const i=this;return t.forEachChild(si,((e,t)=>{i.matches(new Wr(e,t))||(r=r.updateImmediateChild(e,pi.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ki{constructor(e){this.rangedFilter_=new xi(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,t,n,r,i,o){return this.rangedFilter_.matches(new Wr(t,n))||(n=pi.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,o):this.fullLimitUpdateChild_(e,t,n,i,o)}updateFullNode(e,t,n){let r;if(t.isLeafNode()||t.isEmpty())r=pi.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;r=pi.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();let i;if(i=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),t)<=0:this.index_.compare(t,this.rangedFilter_.getEndPost())<=0,!i)break;r=r.updateImmediateChild(t.name,t.node),n++}}else{let e,n,i,o;if(r=t.withIndex(this.index_),r=r.updatePriority(pi.EMPTY_NODE),this.reverse_){o=r.getReverseIterator(this.index_),e=this.rangedFilter_.getEndPost(),n=this.rangedFilter_.getStartPost();const t=this.index_.getCompare();i=(e,n)=>t(n,e)}else o=r.getIterator(this.index_),e=this.rangedFilter_.getStartPost(),n=this.rangedFilter_.getEndPost(),i=this.index_.getCompare();let s=0,a=!1;for(;o.hasNext();){const t=o.getNext();!a&&i(e,t)<=0&&(a=!0);a&&s<this.limit_&&i(t,n)<=0?s++:r=r.updateImmediateChild(t.name,pi.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,r,i){let o;if(this.reverse_){const e=this.index_.getCompare();o=(t,n)=>e(n,t)}else o=this.index_.getCompare();const s=e;et(s.numChildren()===this.limit_,"");const a=new Wr(t,n),l=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),c=this.rangedFilter_.matches(a);if(s.hasChild(t)){const e=s.getImmediateChild(t);let u=r.getChildAfterChild(this.index_,l,this.reverse_);for(;null!=u&&(u.name===t||s.hasChild(u.name));)u=r.getChildAfterChild(this.index_,u,this.reverse_);const h=null==u?1:o(u,a);if(c&&!n.isEmpty()&&h>=0)return null!=i&&i.trackChildChange(bi(t,n,e)),s.updateImmediateChild(t,n);{null!=i&&i.trackChildChange(wi(t,e));const n=s.updateImmediateChild(t,pi.EMPTY_NODE);return null!=u&&this.rangedFilter_.matches(u)?(null!=i&&i.trackChildChange(yi(u.name,u.node)),n.updateImmediateChild(u.name,u.node)):n}}return n.isEmpty()?e:c&&o(l,a)>=0?(null!=i&&(i.trackChildChange(wi(l.name,l.node)),i.trackChildChange(yi(t,n))),s.updateImmediateChild(t,n).updateImmediateChild(l.name,pi.EMPTY_NODE)):e}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ei{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=si}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return et(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return et(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Bn}hasEnd(){return this.endSet_}getIndexEndValue(){return et(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return et(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Wn}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return et(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===si}copy(){const e=new Ei;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Ii(e){const t={};if(e.isDefault())return t;let n;return e.index_===si?n="$priority":e.index_===vi?n="$value":e.index_===Gr?n="$key":(et(e.index_ instanceof mi,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=pt(n),e.startSet_&&(t.startAt=pt(e.indexStartValue_),e.startNameSet_&&(t.startAt+=","+pt(e.indexStartName_))),e.endSet_&&(t.endAt=pt(e.indexEndValue_),e.endNameSet_&&(t.endAt+=","+pt(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function Si(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==si&&(t.i=e.index_.toString()),t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ti extends br{constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=$n("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(et(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=Ti.getListenId_(e,n),s={};this.listens_[o]=s;const a=Ii(e._queryParams);this.restRequest_(i+".json",a,((e,t)=>{let a=t;if(404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(i,a,!1,n),mt(this.listens_,o)===s){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",r(t,null)}}))}unlisten(e,t){const n=Ti.getListenId_(e,t);delete this.listens_[n]}get(e){const t=Ii(e._queryParams),n=e._path.toString(),r=new at;return this.restRequest_(n+".json",t,((e,t)=>{let i=t;404===e&&(i=null,e=null),null===e?(this.onDataUpdate_(n,i,!1,null),r.resolve(i)):r.reject(new Error(i))})),r.promise}refreshAuthToken(e){}restRequest_(e,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([r,i])=>{r&&r.accessToken&&(t.auth=r.accessToken),i&&i.token&&(t.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+function(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}(t);this.log_("Sending REST request for "+o);const s=new XMLHttpRequest;s.onreadystatechange=()=>{if(n&&4===s.readyState){this.log_("REST Response for "+o+" received. status:",s.status,"response:",s.responseText);let e=null;if(s.status>=200&&s.status<300){try{e=ft(s.responseText)}catch(e){jn("Failed to parse JSON response for "+o+": "+s.responseText)}n(null,e)}else 401!==s.status&&404!==s.status&&jn("Got unsuccessful REST response for "+o+" Status: "+s.status),n(s.status);n=null}},s.open("GET",o,!0),s.send()}))}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ni{constructor(){this.rootNode_=pi.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ri(){return{value:null,children:new Map}}function Pi(e,t,n){if(Ar(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const r=Ir(t);e.children.has(r)||e.children.set(r,Ri());Pi(e.children.get(r),t=Tr(t),n)}}function Mi(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e,((e,r)=>{Mi(r,new kr(t.toString()+"/"+e),n)}))}class Ai{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Kn(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Oi{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Ai(e);const n=1e4+2e4*Math.random();er(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;Kn(e,((e,r)=>{r>0&&_t(this.statsToReport_,e)&&(t[e]=r,n=!0)})),n&&this.server_.reportStats(t),er(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Di;function Li(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Di||(Di={}));class $i{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Di.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(Ar(this.path)){if(null!=this.affectedTree.value)return et(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new kr(e));return new $i(Er(),t,this.revert)}}return et(Ir(this.path)===e,"operationForChild called for unrelated child."),new $i(Tr(this.path),this.affectedTree,this.revert)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Fi{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Di.OVERWRITE}operationForChild(e){return Ar(this.path)?new Fi(this.source,Er(),this.snap.getImmediateChild(e)):new Fi(this.source,Tr(this.path),this.snap)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class qi{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Di.MERGE}operationForChild(e){if(Ar(this.path)){const t=this.children.subtree(new kr(e));return t.isEmpty()?null:t.value?new Fi(this.source,Er(),t.value):new qi(this.source,Er(),t)}return et(Ir(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new qi(this.source,Tr(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ji{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ar(e))return this.isFullyInitialized()&&!this.filtered_;const t=Ir(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class zi{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Bi(e,t,n,r,i,o){const s=r.filter((e=>e.type===n));s.sort(((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw tt("Should only compare child_ events.");const r=new Wr(t.childName,t.snapshotNode),i=new Wr(n.childName,n.snapshotNode);return e.index_.compare(r,i)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e,t,n))),s.forEach((n=>{const r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,o);i.forEach((i=>{i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function Wi(e,t){return{eventCache:e,serverCache:t}}function Ui(e,t,n,r){return Wi(new ji(t,n,r),e.serverCache)}function Hi(e,t,n,r){return Wi(e.eventCache,new ji(t,n,r))}function Vi(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Gi(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */let Yi;class Ki{constructor(e,t=(()=>(Yi||(Yi=new Xr(Hn)),Yi))()){this.value=e,this.children=t}static fromObject(e){let t=new Ki(null);return Kn(e,((e,n)=>{t=t.set(new kr(e),n)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Er(),value:this.value};if(Ar(e))return null;{const n=Ir(e),r=this.children.get(n);if(null!==r){const i=r.findRootMostMatchingPathAndValue(Tr(e),t);if(null!=i){return{path:Mr(new kr(n),i.path),value:i.value}}return null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(Ar(e))return this;{const t=Ir(e),n=this.children.get(t);return null!==n?n.subtree(Tr(e)):new Ki(null)}}set(e,t){if(Ar(e))return new Ki(t,this.children);{const n=Ir(e),r=(this.children.get(n)||new Ki(null)).set(Tr(e),t),i=this.children.insert(n,r);return new Ki(this.value,i)}}remove(e){if(Ar(e))return this.children.isEmpty()?new Ki(null):new Ki(null,this.children);{const t=Ir(e),n=this.children.get(t);if(n){const r=n.remove(Tr(e));let i;return i=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&i.isEmpty()?new Ki(null):new Ki(this.value,i)}return this}}get(e){if(Ar(e))return this.value;{const t=Ir(e),n=this.children.get(t);return n?n.get(Tr(e)):null}}setTree(e,t){if(Ar(e))return t;{const n=Ir(e),r=(this.children.get(n)||new Ki(null)).setTree(Tr(e),t);let i;return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new Ki(this.value,i)}}fold(e){return this.fold_(Er(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((r,i)=>{n[r]=i.fold_(Mr(e,r),t)})),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,Er(),t)}findOnPath_(e,t,n){const r=!!this.value&&n(t,this.value);if(r)return r;if(Ar(e))return null;{const r=Ir(e),i=this.children.get(r);return i?i.findOnPath_(Tr(e),Mr(t,r),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Er(),t)}foreachOnPath_(e,t,n){if(Ar(e))return this;{this.value&&n(t,this.value);const r=Ir(e),i=this.children.get(r);return i?i.foreachOnPath_(Tr(e),Mr(t,r),n):new Ki(null)}}foreach(e){this.foreach_(Er(),e)}foreach_(e,t){this.children.inorderTraversal(((n,r)=>{r.foreach_(Mr(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Xi{constructor(e){this.writeTree_=e}static empty(){return new Xi(new Ki(null))}}function Qi(e,t,n){if(Ar(t))return new Xi(new Ki(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){const i=r.path;let o=r.value;const s=Or(i,t);return o=o.updateChild(s,n),new Xi(e.writeTree_.set(i,o))}{const r=new Ki(n),i=e.writeTree_.setTree(t,r);return new Xi(i)}}}function Ji(e,t,n){let r=e;return Kn(n,((e,n)=>{r=Qi(r,Mr(t,e),n)})),r}function Zi(e,t){if(Ar(t))return Xi.empty();{const n=e.writeTree_.setTree(t,new Ki(null));return new Xi(n)}}function eo(e,t){return null!=to(e,t)}function to(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(Or(n.path,t)):null}function no(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(si,((e,n)=>{t.push(new Wr(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new Wr(e,n.value))})),t}function ro(e,t){if(Ar(t))return e;{const n=to(e,t);return new Xi(null!=n?new Ki(n):e.writeTree_.subtree(t))}}function io(e){return e.writeTree_.isEmpty()}function oo(e,t){return so(Er(),e.writeTree_,t)}function so(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let r=null;return t.children.inorderTraversal(((t,i)=>{".priority"===t?(et(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=so(Mr(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(Mr(e,".priority"),r)),n}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ao(e,t){return bo(t,e)}function lo(e,t){const n=e.allWrites.findIndex((e=>e.writeId===t));et(n>=0,"removeWrite called with nonexistent writeId.");const r=e.allWrites[n];e.allWrites.splice(n,1);let i=r.visible,o=!1,s=e.allWrites.length-1;for(;i&&s>=0;){const t=e.allWrites[s];t.visible&&(s>=n&&co(t,r.path)?i=!1:Lr(r.path,t.path)&&(o=!0)),s--}if(i){if(o)return function(e){e.visibleWrites=ho(e.allWrites,uo,Er()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;if(r.snap)e.visibleWrites=Zi(e.visibleWrites,r.path);else{Kn(r.children,(t=>{e.visibleWrites=Zi(e.visibleWrites,Mr(r.path,t))}))}return!0}return!1}function co(e,t){if(e.snap)return Lr(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&Lr(Mr(e.path,n),t))return!0;return!1}function uo(e){return e.visible}function ho(e,t,n){let r=Xi.empty();for(let i=0;i<e.length;++i){const o=e[i];if(t(o)){const e=o.path;let t;if(o.snap)Lr(n,e)?(t=Or(n,e),r=Qi(r,t,o.snap)):Lr(e,n)&&(t=Or(e,n),r=Qi(r,Er(),o.snap.getChild(t)));else{if(!o.children)throw tt("WriteRecord should have .snap or .children");if(Lr(n,e))t=Or(n,e),r=Ji(r,t,o.children);else if(Lr(e,n))if(t=Or(e,n),Ar(t))r=Ji(r,Er(),o.children);else{const e=mt(o.children,Ir(t));if(e){const n=e.getChild(Tr(t));r=Qi(r,Er(),n)}}}}}return r}function fo(e,t,n,r,i){if(r||i){const o=ro(e.visibleWrites,t);if(!i&&io(o))return n;if(i||null!=n||eo(o,Er())){const o=function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(Lr(e.path,t)||Lr(t,e.path))};return oo(ho(e.allWrites,o,t),n||pi.EMPTY_NODE)}return null}{const r=to(e.visibleWrites,t);if(null!=r)return r;{const r=ro(e.visibleWrites,t);if(io(r))return n;if(null!=n||eo(r,Er())){return oo(r,n||pi.EMPTY_NODE)}return null}}}function po(e,t,n,r){return fo(e.writeTree,e.treePath,t,n,r)}function go(e,t){return function(e,t,n){let r=pi.EMPTY_NODE;const i=to(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(si,((e,t)=>{r=r.updateImmediateChild(e,t)})),r;if(n){const i=ro(e.visibleWrites,t);return n.forEachChild(si,((e,t)=>{const n=oo(ro(i,new kr(e)),t);r=r.updateImmediateChild(e,n)})),no(i).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}return no(ro(e.visibleWrites,t)).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function _o(e,t,n,r){return function(e,t,n,r,i){et(r||i,"Either existingEventSnap or existingServerSnap must exist");const o=Mr(t,n);if(eo(e.visibleWrites,o))return null;{const t=ro(e.visibleWrites,o);return io(t)?i.getChild(n):oo(t,i.getChild(n))}}(e.writeTree,e.treePath,t,n,r)}function mo(e,t){return function(e,t){return to(e.visibleWrites,t)}(e.writeTree,Mr(e.treePath,t))}function vo(e,t,n,r,i,o){return function(e,t,n,r,i,o,s){let a;const l=ro(e.visibleWrites,t),c=to(l,Er());if(null!=c)a=c;else{if(null==n)return[];a=oo(l,n)}if(a=a.withIndex(s),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=s.getCompare(),n=o?a.getReverseIteratorFrom(r,s):a.getIteratorFrom(r,s);let l=n.getNext();for(;l&&e.length<i;)0!==t(l,r)&&e.push(l),l=n.getNext();return e}}(e.writeTree,e.treePath,t,n,r,i,o)}function yo(e,t,n){return function(e,t,n,r){const i=Mr(t,n),o=to(e.visibleWrites,i);if(null!=o)return o;if(r.isCompleteForChild(n))return oo(ro(e.visibleWrites,i),r.getNode().getImmediateChild(n));return null}(e.writeTree,e.treePath,t,n)}function wo(e,t){return bo(Mr(e.treePath,t),e.writeTree)}function bo(e,t){return{treePath:e,writeTree:t}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Co{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;et("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),et(".priority"!==n,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,bi(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,wi(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,yi(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw tt("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,bi(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const xo=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class ko{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new ji(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return yo(this.writes_,e,t)}}getChildAfterChild(e,t,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Gi(this.viewCache_),i=vo(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Eo(e,t,n,r,i){const o=new Co;let s,a;if(n.type===Di.OVERWRITE){const l=n;l.source.fromUser?s=To(e,t,l.path,l.snap,r,i,o):(et(l.source.fromServer,"Unknown source."),a=l.source.tagged||t.serverCache.isFiltered()&&!Ar(l.path),s=So(e,t,l.path,l.snap,r,i,a,o))}else if(n.type===Di.MERGE){const l=n;l.source.fromUser?s=function(e,t,n,r,i,o,s){let a=t;return r.foreach(((r,l)=>{const c=Mr(n,r);No(t,Ir(c))&&(a=To(e,a,c,l,i,o,s))})),r.foreach(((r,l)=>{const c=Mr(n,r);No(t,Ir(c))||(a=To(e,a,c,l,i,o,s))})),a}(e,t,l.path,l.children,r,i,o):(et(l.source.fromServer,"Unknown source."),a=l.source.tagged||t.serverCache.isFiltered(),s=Po(e,t,l.path,l.children,r,i,a,o))}else if(n.type===Di.ACK_USER_WRITE){const a=n;s=a.revert?function(e,t,n,r,i,o){let s;if(null!=mo(r,n))return t;{const a=new ko(r,t,i),l=t.eventCache.getNode();let c;if(Ar(n)||".priority"===Ir(n)){let n;if(t.serverCache.isFullyInitialized())n=po(r,Gi(t));else{const e=t.serverCache.getNode();et(e instanceof pi,"serverChildren would be complete if leaf node"),n=go(r,e)}n=n,c=e.filter.updateFullNode(l,n,o)}else{const i=Ir(n);let u=yo(r,i,t.serverCache);null==u&&t.serverCache.isCompleteForChild(i)&&(u=l.getImmediateChild(i)),c=null!=u?e.filter.updateChild(l,i,u,Tr(n),a,o):t.eventCache.getNode().hasChild(i)?e.filter.updateChild(l,i,pi.EMPTY_NODE,Tr(n),a,o):l,c.isEmpty()&&t.serverCache.isFullyInitialized()&&(s=po(r,Gi(t)),s.isLeafNode()&&(c=e.filter.updateFullNode(c,s,o)))}return s=t.serverCache.isFullyInitialized()||null!=mo(r,Er()),Ui(t,c,s,e.filter.filtersNodes())}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e,t,a.path,r,i,o):function(e,t,n,r,i,o,s){if(null!=mo(i,n))return t;const a=t.serverCache.isFiltered(),l=t.serverCache;if(null!=r.value){if(Ar(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return So(e,t,n,l.getNode().getChild(n),i,o,a,s);if(Ar(n)){let r=new Ki(null);return l.getNode().forEachChild(Gr,((e,t)=>{r=r.set(new kr(e),t)})),Po(e,t,n,r,i,o,a,s)}return t}{let c=new Ki(null);return r.foreach(((e,t)=>{const r=Mr(n,e);l.isCompleteForPath(r)&&(c=c.set(e,l.getNode().getChild(r)))})),Po(e,t,n,c,i,o,a,s)}}(e,t,a.path,a.affectedTree,r,i,o)}else{if(n.type!==Di.LISTEN_COMPLETE)throw tt("Unknown operation type: "+n.type);s=function(e,t,n,r,i){const o=t.serverCache,s=Hi(t,o.getNode(),o.isFullyInitialized()||Ar(n),o.isFiltered());return Io(e,s,n,r,xo,i)}(e,t,n.path,r,o)}const l=o.getChanges();return function(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=Vi(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push({type:"value",snapshotNode:Vi(t)})}}(t,s,l),{viewCache:s,changes:l}}function Io(e,t,n,r,i,o){const s=t.eventCache;if(null!=mo(r,n))return t;{let a,l;if(Ar(n))if(et(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=Gi(t),i=go(r,n instanceof pi?n:pi.EMPTY_NODE);a=e.filter.updateFullNode(t.eventCache.getNode(),i,o)}else{const n=po(r,Gi(t));a=e.filter.updateFullNode(t.eventCache.getNode(),n,o)}else{const c=Ir(n);if(".priority"===c){et(1===Sr(n),"Can't have a priority with additional path components");const i=s.getNode();l=t.serverCache.getNode();const o=_o(r,n,i,l);a=null!=o?e.filter.updatePriority(i,o):s.getNode()}else{const u=Tr(n);let h;if(s.isCompleteForChild(c)){l=t.serverCache.getNode();const e=_o(r,n,s.getNode(),l);h=null!=e?s.getNode().getImmediateChild(c).updateChild(u,e):s.getNode().getImmediateChild(c)}else h=yo(r,c,t.serverCache);a=null!=h?e.filter.updateChild(s.getNode(),c,h,u,i,o):s.getNode()}}return Ui(t,a,s.isFullyInitialized()||Ar(n),e.filter.filtersNodes())}}function So(e,t,n,r,i,o,s,a){const l=t.serverCache;let c;const u=s?e.filter:e.filter.getIndexedFilter();if(Ar(n))c=u.updateFullNode(l.getNode(),r,null);else if(u.filtersNodes()&&!l.isFiltered()){const e=l.getNode().updateChild(n,r);c=u.updateFullNode(l.getNode(),e,null)}else{const e=Ir(n);if(!l.isCompleteForPath(n)&&Sr(n)>1)return t;const i=Tr(n),o=l.getNode().getImmediateChild(e).updateChild(i,r);c=".priority"===e?u.updatePriority(l.getNode(),o):u.updateChild(l.getNode(),e,o,i,xo,null)}const h=Hi(t,c,l.isFullyInitialized()||Ar(n),u.filtersNodes());return Io(e,h,n,i,new ko(i,h,o),a)}function To(e,t,n,r,i,o,s){const a=t.eventCache;let l,c;const u=new ko(i,t,o);if(Ar(n))c=e.filter.updateFullNode(t.eventCache.getNode(),r,s),l=Ui(t,c,!0,e.filter.filtersNodes());else{const i=Ir(n);if(".priority"===i)c=e.filter.updatePriority(t.eventCache.getNode(),r),l=Ui(t,c,a.isFullyInitialized(),a.isFiltered());else{const o=Tr(n),c=a.getNode().getImmediateChild(i);let h;if(Ar(o))h=r;else{const e=u.getCompleteChild(i);h=null!=e?".priority"===Nr(o)&&e.getChild(Pr(o)).isEmpty()?e:e.updateChild(o,r):pi.EMPTY_NODE}if(c.equals(h))l=t;else{l=Ui(t,e.filter.updateChild(a.getNode(),i,h,o,u,s),a.isFullyInitialized(),e.filter.filtersNodes())}}}return l}function No(e,t){return e.eventCache.isCompleteForChild(t)}function Ro(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function Po(e,t,n,r,i,o,s,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let l,c=t;l=Ar(n)?r:new Ki(null).setTree(n,r);const u=t.serverCache.getNode();return l.children.inorderTraversal(((n,r)=>{if(u.hasChild(n)){const l=Ro(0,t.serverCache.getNode().getImmediateChild(n),r);c=So(e,c,new kr(n),l,i,o,s,a)}})),l.children.inorderTraversal(((n,r)=>{const l=!t.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!u.hasChild(n)&&!l){const l=Ro(0,t.serverCache.getNode().getImmediateChild(n),r);c=So(e,c,new kr(n),l,i,o,s,a)}})),c}class Mo{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,r=new Ci(n.getIndex()),i=(o=n).loadsAllData()?new Ci(o.getIndex()):o.hasLimit()?new ki(o):new xi(o);var o;this.processor_=function(e){return{filter:e}}(i);const s=t.serverCache,a=t.eventCache,l=r.updateFullNode(pi.EMPTY_NODE,s.getNode(),null),c=i.updateFullNode(pi.EMPTY_NODE,a.getNode(),null),u=new ji(l,s.isFullyInitialized(),r.filtersNodes()),h=new ji(c,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=Wi(h,u),this.eventGenerator_=new zi(this.query_)}get query(){return this.query_}}function Ao(e,t){const n=Gi(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!Ar(t)&&!n.getImmediateChild(Ir(t)).isEmpty())?n.getChild(t):null}function Oo(e,t,n,r){t.type===Di.MERGE&&null!==t.source.queryId&&(et(Gi(e.viewCache_),"We should always have a full cache before handling merges"),et(Vi(e.viewCache_),"Missing event cache, even though we have a server cache"));const i=e.viewCache_,o=Eo(e.processor_,i,t,n,r);var s,a;return s=e.processor_,a=o.viewCache,et(a.eventCache.getNode().isIndexed(s.filter.getIndex()),"Event snap not indexed"),et(a.serverCache.getNode().isIndexed(s.filter.getIndex()),"Server snap not indexed"),et(o.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=o.viewCache,function(e,t,n,r){const i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){const i=[],o=[];return t.forEach((t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),Bi(e,i,"child_removed",t,r,n),Bi(e,i,"child_added",t,r,n),Bi(e,i,"child_moved",o,r,n),Bi(e,i,"child_changed",t,r,n),Bi(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e,o.changes,o.viewCache.eventCache.getNode(),null)}let Do,Lo;class $o{constructor(){this.views=new Map}}function Fo(e,t,n,r){const i=t.source.queryId;if(null!==i){const o=e.views.get(i);return et(null!=o,"SyncTree gave us an op for an invalid query."),Oo(o,t,n,r)}{let i=[];for(const o of e.views.values())i=i.concat(Oo(o,t,n,r));return i}}function qo(e,t){let n=null;for(const r of e.views.values())n=n||Ao(r,t);return n}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class jo{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ki(null),this.pendingWriteTree_={visibleWrites:Xi.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function zo(e,t,n,r,i){return function(e,t,n,r,i){et(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=Qi(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?Vo(e,new Fi({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function Bo(e,t,n=!1){const r=function(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(lo(e.pendingWriteTree_,t)){let t=new Ki(null);return null!=r.snap?t=t.set(Er(),!0):Kn(r.children,(e=>{t=t.set(new kr(e),!0)})),Vo(e,new $i(r.path,t,n))}return[]}function Wo(e,t,n){return Vo(e,new Fi({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function Uo(e,t,n){const r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,((e,n)=>{const r=qo(n,Or(e,t));if(r)return r}));return fo(r,t,i,n,!0)}function Ho(e,t){const n=t._path;let r=null;e.syncPointTree_.foreachOnPath(n,((e,t)=>{const i=Or(e,n);r=r||qo(t,i)}));let i=e.syncPointTree_.get(n);i?r=r||qo(i,Er()):(i=new $o,e.syncPointTree_=e.syncPointTree_.set(n,i));const o=null!=r,s=o?new ji(r,!0,!1):null,a=function(e,t,n,r,i){const o=t._queryIdentifier,s=e.views.get(o);if(!s){let e=po(n,i?r:null),o=!1;e?o=!0:r instanceof pi?(e=go(n,r),o=!1):(e=pi.EMPTY_NODE,o=!1);const s=Wi(new ji(e,o,!1),new ji(r,i,!1));return new Mo(t,s)}return s}(i,t,ao(e.pendingWriteTree_,t._path),o?s.getNode():pi.EMPTY_NODE,o);return function(e){return Vi(e.viewCache_)}(a)}function Vo(e,t){return Go(t,e.syncPointTree_,null,ao(e.pendingWriteTree_,Er()))}function Go(e,t,n,r){if(Ar(e.path))return Yo(e,t,n,r);{const i=t.get(Er());null==n&&null!=i&&(n=qo(i,Er()));let o=[];const s=Ir(e.path),a=e.operationForChild(s),l=t.children.get(s);if(l&&a){const e=n?n.getImmediateChild(s):null,t=wo(r,s);o=o.concat(Go(a,l,e,t))}return i&&(o=o.concat(Fo(i,e,r,n))),o}}function Yo(e,t,n,r){const i=t.get(Er());null==n&&null!=i&&(n=qo(i,Er()));let o=[];return t.children.inorderTraversal(((t,i)=>{const s=n?n.getImmediateChild(t):null,a=wo(r,t),l=e.operationForChild(t);l&&(o=o.concat(Yo(l,i,s,a)))})),i&&(o=o.concat(Fo(i,e,r,n))),o}function Ko(e,t){return e.tagToQueryMap.get(t)}function Xo(e){const t=e.indexOf("$");return et(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new kr(e.substr(0,t))}}function Qo(e,t,n){const r=e.syncPointTree_.get(t);et(r,"Missing sync point for query tag that we're tracking");return Fo(r,n,ao(e.pendingWriteTree_,t),null)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Jo{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Jo(t)}node(){return this.node_}}class Zo{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Mr(this.path_,e);return new Zo(this.syncTree_,t)}node(){return Uo(this.syncTree_,this.path_)}}const es=function(e,t,n){return e&&"object"==typeof e?(et(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?ts(e[".sv"],t,n):"object"==typeof e[".sv"]?ns(e[".sv"],t):void et(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},ts=function(e,t,n){if("timestamp"===e)return n.timestamp;et(!1,"Unexpected server value: "+e)},ns=function(e,t,n){e.hasOwnProperty("increment")||et(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const r=e.increment;"number"!=typeof r&&et(!1,"Unexpected increment value: "+r);const i=t.node();if(et(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return"number"!=typeof o?r:o+r},rs=function(e,t,n){return is(e,new Jo(t),n)};function is(e,t,n){const r=e.getPriority().val(),i=es(r,t.getImmediateChild(".priority"),n);let o;if(e.isLeafNode()){const r=e,o=es(r.getValue(),t,n);return o!==r.getValue()||i!==r.getPriority().val()?new oi(o,_i(i)):e}{const r=e;return o=r,i!==r.getPriority().val()&&(o=o.updatePriority(new oi(i))),r.forEachChild(si,((e,r)=>{const i=is(r,t.getImmediateChild(e),n);i!==r&&(o=o.updateImmediateChild(e,i))})),o}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class os{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}function ss(e,t){let n=t instanceof kr?t:new kr(t),r=e,i=Ir(n);for(;null!==i;){const e=mt(r.node.children,i)||{children:{},childCount:0};r=new os(i,r,e),n=Tr(n),i=Ir(n)}return r}function as(e){return e.node.value}function ls(e,t){e.node.value=t,fs(e)}function cs(e){return e.node.childCount>0}function us(e,t){Kn(e.node.children,((n,r)=>{t(new os(n,e,r))}))}function hs(e,t,n,r){n&&!r&&t(e),us(e,(e=>{hs(e,t,!0,r)})),n&&r&&t(e)}function ds(e){return new kr(null===e.parent?e.name:ds(e.parent)+"/"+e.name)}function fs(e){null!==e.parent&&function(e,t,n){const r=function(e){return void 0===as(e)&&!cs(e)}(n),i=_t(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,fs(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,fs(e))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e.parent,e.name,e)}const ps=/[\[\].#$\/\u0000-\u001F\u007F]/,gs=/[\[\].#$\u0000-\u001F\u007F]/,_s=10485760,ms=function(e){return"string"==typeof e&&0!==e.length&&!ps.test(e)},vs=function(e){return"string"==typeof e&&0!==e.length&&!gs.test(e)},ys=function(e,t,n){const r=n instanceof kr?new $r(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+qr(r));if("function"==typeof t)throw new Error(e+"contains a function "+qr(r)+" with contents = "+t.toString());if(zn(t))throw new Error(e+"contains "+t.toString()+" "+qr(r));if("string"==typeof t&&t.length>_s/3&&kt(t)>_s)throw new Error(e+"contains a string greater than "+"10485760 utf8 bytes "+qr(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let n=!1,i=!1;if(Kn(t,((t,o)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(i=!0,!ms(t)))throw new Error(e+" contains an invalid key ("+t+") "+qr(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=kt(t),Fr(e)}(r,t),ys(e,o,r),function(e){const t=e.parts_.pop();e.byteLength_-=kt(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)})),n&&i)throw new Error(e+' contains ".value" child '+qr(r)+" in addition to actual children.")}},ws=function(e,t,n,r){if(!(r&&void 0===n||vs(n)))throw new Error(xt(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},bs=function(e,t){const n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!ms(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),vs(e)}(n))throw new Error(xt(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Cs{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function xs(e,t){let n=null;for(let r=0;r<t.length;r++){const i=t[r],o=i.getPath();null===n||Dr(o,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&e.eventLists_.push(n)}function ks(e,t,n){xs(e,n),Es(e,(e=>Lr(e,t)||Lr(t,e)))}function Es(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const i=e.eventLists_[r];if(i){t(i.path)?(Is(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function Is(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const r=n.getEventRunner();On&&Ln("event: "+n.toString()),Zn(r)}}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ss{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Cs,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ri(),this.transactionQueueTree_=new os,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Ts(e,t,n){if(e.stats_=dr(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new Ti(e.repoInfo_,((t,n,r,i)=>{Ps(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>Ms(e,!0)),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{pt(n)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new Br(e.repoInfo_,t,((t,n,r,i)=>{Ps(e,t,n,r,i)}),(t=>{Ms(e,t)}),(t=>{!function(e,t){Kn(t,((t,n)=>{As(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(e,t){const n=e.toString();return hr[n]||(hr[n]=t()),hr[n]}(e.repoInfo_,(()=>new Oi(e.stats_,e.server_))),e.infoData_=new Ni,e.infoSyncTree_=new jo({startListening:(t,n,r,i)=>{let o=[];const s=e.infoData_.getNode(t._path);return s.isEmpty()||(o=Wo(e.infoSyncTree_,t._path,s),setTimeout((()=>{i("ok")}),0)),o},stopListening:()=>{}}),As(e,"connected",!1),e.serverSyncTree_=new jo({startListening:(t,n,r,i)=>(e.server_.listen(t,r,n,((n,r)=>{const o=i(n,r);ks(e.eventQueue_,t._path,o)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function Ns(e){const t=e.infoData_.getNode(new kr(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function Rs(e){return(t=(t={timestamp:Ns(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function Ps(e,t,n,r,i){e.dataUpdateCount++;const o=new kr(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let s=[];if(i)if(r){const t=yt(n,(e=>_i(e)));s=function(e,t,n,r){const i=Ko(e,r);if(i){const r=Xo(i),o=r.path,s=r.queryId,a=Or(o,t),l=Ki.fromObject(n);return Qo(e,o,new qi(Li(s),a,l))}return[]}(e.serverSyncTree_,o,t,i)}else{const t=_i(n);s=function(e,t,n,r){const i=Ko(e,r);if(null!=i){const r=Xo(i),o=r.path,s=r.queryId,a=Or(o,t);return Qo(e,o,new Fi(Li(s),a,n))}return[]}(e.serverSyncTree_,o,t,i)}else if(r){const t=yt(n,(e=>_i(e)));s=function(e,t,n){const r=Ki.fromObject(n);return Vo(e,new qi({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,o,t)}else{const t=_i(n);s=Wo(e.serverSyncTree_,o,t)}let a=o;s.length>0&&(a=js(e,o)),ks(e.eventQueue_,a,s)}function Ms(e,t){As(e,"connected",t),!1===t&&function(e){$s(e,"onDisconnectEvents");const t=Rs(e),n=Ri();Mi(e.onDisconnect_,Er(),((r,i)=>{const o=function(e,t,n,r){return is(t,new Zo(n,e),r)}(r,i,e.serverSyncTree_,t);Pi(n,r,o)}));let r=[];Mi(n,Er(),((t,n)=>{r=r.concat(Wo(e.serverSyncTree_,t,n));const i=Hs(e,t);js(e,i)})),e.onDisconnect_=Ri(),ks(e.eventQueue_,Er(),r)}(e)}function As(e,t,n){const r=new kr("/.info/"+t),i=_i(n);e.infoData_.updateSnapshot(r,i);const o=Wo(e.infoSyncTree_,r,i);ks(e.eventQueue_,r,o)}function Os(e){return e.nextWriteId_++}function Ds(e,t){const n=Ho(e.serverSyncTree_,t);return null!=n?Promise.resolve(n):e.server_.get(t).then((n=>{const r=_i(n).withIndex(t._queryParams.getIndex()),i=Wo(e.serverSyncTree_,t._path,r);var o,s;return o=e.eventQueue_,s=t._path,xs(o,i),Es(o,(e=>Dr(e,s))),Promise.resolve(r)}),(n=>($s(e,"get for query "+pt(t)+" failed: "+n),Promise.reject(new Error(n)))))}function Ls(e,t,n,r,i){$s(e,"set",{path:t.toString(),value:n,priority:r});const o=Rs(e),s=_i(n,r),a=Uo(e.serverSyncTree_,t),l=rs(s,a,o),c=Os(e),u=zo(e.serverSyncTree_,t,l,c,!0);xs(e.eventQueue_,u),e.server_.put(t.toString(),s.val(!0),((n,r)=>{const o="ok"===n;o||jn("set at "+t+" failed: "+n);const s=Bo(e.serverSyncTree_,c,!o);ks(e.eventQueue_,t,s),function(e,t,n,r){t&&Zn((()=>{if("ok"===n)t(null);else{const e=(n||"error").toUpperCase();let i=e;r&&(i+=": "+r);const o=new Error(i);o.code=e,t(o)}}))}(0,i,n,r)}));const h=Hs(e,t);js(e,h),ks(e.eventQueue_,h,[])}function $s(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),Ln(n,...t)}function Fs(e,t,n){return Uo(e.serverSyncTree_,t,n)||pi.EMPTY_NODE}function qs(e,t=e.transactionQueueTree_){if(t||Us(e,t),as(t)){const n=Bs(e,t);et(n.length>0,"Sending zero length transaction queue");n.every((e=>0===e.status))&&function(e,t,n){const r=n.map((e=>e.currentWriteId)),i=Fs(e,t,r);let o=i;const s=i.hash();for(let e=0;e<n.length;e++){const r=n[e];et(0===r.status,"tryToSendTransactionQueue_: items in queue should all be run."),r.status=1,r.retryCount++;const i=Or(t,r.path);o=o.updateChild(i,r.currentOutputSnapshotRaw)}const a=o.val(!0),l=t;e.server_.put(l.toString(),a,(r=>{$s(e,"transaction put response",{path:l.toString(),status:r});let i=[];if("ok"===r){const r=[];for(let t=0;t<n.length;t++)n[t].status=2,i=i.concat(Bo(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&r.push((()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved))),n[t].unwatcher();Us(e,ss(e.transactionQueueTree_,t)),qs(e,e.transactionQueueTree_),ks(e.eventQueue_,t,i);for(let e=0;e<r.length;e++)Zn(r[e])}else{if("datastale"===r)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{jn("transaction at "+l.toString()+" failed: "+r);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=r}js(e,t)}}),s)}(e,ds(t),n)}else cs(t)&&us(t,(t=>{qs(e,t)}))}function js(e,t){const n=zs(e,t),r=ds(n);return function(e,t,n){if(0===t.length)return;const r=[];let i=[];const o=t.filter((e=>0===e.status)).map((e=>e.currentWriteId));for(let a=0;a<t.length;a++){const l=t[a],c=Or(n,l.path);let u,h=!1;if(et(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),4===l.status)h=!0,u=l.abortReason,i=i.concat(Bo(e.serverSyncTree_,l.currentWriteId,!0));else if(0===l.status)if(l.retryCount>=25)h=!0,u="maxretry",i=i.concat(Bo(e.serverSyncTree_,l.currentWriteId,!0));else{const n=Fs(e,l.path,o);l.currentInputSnapshot=n;const r=t[a].update(n.val());if(void 0!==r){ys("transaction failed: Data returned ",r,l.path);let t=_i(r);"object"==typeof r&&null!=r&&_t(r,".priority")||(t=t.updatePriority(n.getPriority()));const s=l.currentWriteId,a=Rs(e),c=rs(t,n,a);l.currentOutputSnapshotRaw=t,l.currentOutputSnapshotResolved=c,l.currentWriteId=Os(e),o.splice(o.indexOf(s),1),i=i.concat(zo(e.serverSyncTree_,l.path,c,l.currentWriteId,l.applyLocally)),i=i.concat(Bo(e.serverSyncTree_,s,!0))}else h=!0,u="nodata",i=i.concat(Bo(e.serverSyncTree_,l.currentWriteId,!0))}ks(e.eventQueue_,n,i),i=[],h&&(t[a].status=2,s=t[a].unwatcher,setTimeout(s,Math.floor(0)),t[a].onComplete&&("nodata"===u?r.push((()=>t[a].onComplete(null,!1,t[a].currentInputSnapshot))):r.push((()=>t[a].onComplete(new Error(u),!1,null)))))}var s;Us(e,e.transactionQueueTree_);for(let e=0;e<r.length;e++)Zn(r[e]);qs(e,e.transactionQueueTree_)}(e,Bs(e,n),r),r}function zs(e,t){let n,r=e.transactionQueueTree_;for(n=Ir(t);null!==n&&void 0===as(r);)r=ss(r,n),n=Ir(t=Tr(t));return r}function Bs(e,t){const n=[];return Ws(e,t,n),n.sort(((e,t)=>e.order-t.order)),n}function Ws(e,t,n){const r=as(t);if(r)for(let e=0;e<r.length;e++)n.push(r[e]);us(t,(t=>{Ws(e,t,n)}))}function Us(e,t){const n=as(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,ls(t,n.length>0?n:void 0)}us(t,(t=>{Us(e,t)}))}function Hs(e,t){const n=ds(zs(e,t)),r=ss(e.transactionQueueTree_,t);return function(e,t,n){let r=n?e:e.parent;for(;null!==r;){if(t(r))return!0;r=r.parent}}(r,(t=>{Vs(e,t)})),Vs(e,r),hs(r,(t=>{Vs(e,t)})),n}function Vs(e,t){const n=as(t);if(n){const r=[];let i=[],o=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?(et(o===t-1,"All SENT items should be at beginning of queue."),o=t,n[t].status=3,n[t].abortReason="set"):(et(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),i=i.concat(Bo(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&r.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===o?ls(t,void 0):n.length=o+1,ks(e.eventQueue_,ds(t),i);for(let e=0;e<r.length;e++)Zn(r[e])}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Gs=function(e,t){const n=Ys(e),r=n.namespace;"firebase.com"===n.domain&&qn(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||qn("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&jn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new ar(n.host,n.secure,r,t,i,"",r!==n.subdomain),path:new kr(n.pathString)}},Ys=function(e){let t="",n="",r="",i="",o="",s=!0,a="https",l=443;if("string"==typeof e){let c=e.indexOf("//");c>=0&&(a=e.substring(0,c-1),e=e.substring(c+2));let u=e.indexOf("/");-1===u&&(u=e.length);let h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(u,h)),u<h&&(i=function(e){let t="";const n=e.split("/");for(let e=0;e<n.length;e++)if(n[e].length>0){let r=n[e];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(e){}t+="/"+r}return t}(e.substring(u,h)));const d=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):jn(`Invalid query segment '${n}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,h)));c=t.indexOf(":"),c>=0?(s="https"===a||"wss"===a,l=parseInt(t.substring(c+1),10)):c=t.length;const f=t.slice(0,c);if("localhost"===f.toLowerCase())n="localhost";else if(f.split(".").length<=2)n=f;else{const e=t.indexOf(".");r=t.substring(0,e).toLowerCase(),n=t.substring(e+1),o=r}"ns"in d&&(o=d.ns)}return{host:t,port:l,domain:n,subdomain:r,secure:s,scheme:a,pathString:i,namespace:o}};
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Ks{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return Ar(this._path)?null:Nr(this._path)}get ref(){return new Xs(this._repo,this._path)}get _queryIdentifier(){const e=Si(this._queryParams),t=Gn(e);return"{}"===t?"default":t}get _queryObject(){return Si(this._queryParams)}isEqual(e){if(!((e=Et(e))instanceof Ks))return!1;const t=this._repo===e._repo,n=Dr(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}class Xs extends Ks{constructor(e,t){super(e,t,new Ei,!1)}get parent(){const e=Pr(this._path);return null===e?null:new Xs(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class Qs{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new kr(e),n=Zs(this.ref,e);return new Qs(this._node.getChild(t),n,si)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){if(this._node.isLeafNode())return!1;return!!this._node.forEachChild(this._index,((t,n)=>e(new Qs(n,Zs(this.ref,t),si))))}hasChild(e){const t=new kr(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Js(e,t){return(e=Et(e))._checkNotDeleted("ref"),void 0!==t?Zs(e._root,t):e._root}function Zs(e,t){var n,r,i,o;return null===Ir((e=Et(e))._path)?(n="child",r="path",o=!1,(i=t)&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),ws(n,r,i,o)):ws("child","path",t,!1),new Xs(e._repo,Mr(e._path,t))}function ea(e,t){(function(e,t){if(".info"===Ir(t))throw new Error(e+" failed = Can't modify data under /.info/")})("set",(e=Et(e))._path),function(e,t,n,r){r&&void 0===t||ys(xt(e,"value"),t,n)}("set",t,e._path,!1);const n=new at;return Ls(e._repo,e._path,t,null,n.wrapCallback((()=>{}))),n.promise}!function(e){et(!Do,"__referenceConstructor has already been defined"),Do=e}(Xs),function(e){et(!Lo,"__referenceConstructor has already been defined"),Lo=e}(Xs);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const ta={};function na(e,t,n,r,i){let o=r||e.options.databaseURL;void 0===o&&(e.options.projectId||qn("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ln("Using default host for project ",e.options.projectId),o=`${e.options.projectId}-default-rtdb.firebaseio.com`);let s,a,l=Gs(o,i),c=l.repoInfo;"undefined"!=typeof process&&(a=process.env.FIREBASE_DATABASE_EMULATOR_HOST),a?(s=!0,o=`http://${a}?ns=${c.namespace}`,l=Gs(o,i),c=l.repoInfo):s=!l.repoInfo.secure;const u=i&&s?new rr(rr.OWNER):new nr(e.name,e.options,t);bs("Invalid Firebase Database URL",l),Ar(l.path)||qn("Database URL must point to the root of a Firebase Database (not including a child path).");const h=function(e,t,n,r){let i=ta[t.name];i||(i={},ta[t.name]=i);let o=i[e.toURLString()];o&&qn("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return o=new Ss(e,false,n,r),i[e.toURLString()]=o,o}(c,e,u,new tr(e.name,n));return new ra(h,e)}class ra{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Ts(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Xs(this._repo,Er())),this._rootInternal}_delete(){return null!==this._rootInternal&&(!function(e,t){const n=ta[t];n&&n[e.key]===e||qn(`Database ${t}(${e.repoInfo_}) has already been deleted.`),function(e){e.persistentConnection_&&e.persistentConnection_.interrupt("repo_interrupt")}(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&qn("Cannot call "+e+" on a deleted database.")}}Br.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Br.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)},
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(e){!function(e){kn=e}(Kt),Ht(new It("database",((e,{instanceIdentifier:t})=>na(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)),"PUBLIC").setMultipleInstances(!0)),Qt(Cn,xn,e),Qt(Cn,xn,"esm2017")}();const ia=function(e,t={}){if("object"!=typeof t){t={name:t}}const n=Object.assign({name:jt,automaticDataCollectionEnabled:!1},t),r=n.name;if("string"!=typeof r||!r)throw Gt.create("bad-app-name",{appName:String(r)});const i=Bt.get(r);if(i){if(wt(e,i.options)&&wt(n,i.config))return i;throw Gt.create("duplicate-app",{appName:r})}const o=new Rt(r);for(const e of Wt.values())o.addComponent(e);const s=new Yt(e,n,o);return Bt.set(r,s),s}({apiKey:"AIzaSyCFE8TqTBWCDSBee0CuT9HXLnNNRtSA4S8",authDomain:"eye-tracking-8adeb.firebaseapp.com",databaseURL:"https://eye-tracking-8adeb-default-rtdb.firebaseio.com",projectId:"eye-tracking-8adeb",storageBucket:"eye-tracking-8adeb.appspot.com",messagingSenderId:"214459503975",appId:"1:214459503975:web:ff62018ff95cb21cfe8bc2",measurementId:"G-55T3T75PPR"}),oa=function(e=Xt(),t){return Vt(e,"database").getImmediate({identifier:t})}(ia);async function sa(e){try{let n=await(t=Zs(Js(oa),e),Ds((t=Et(t))._repo,t).then((e=>new Qs(e,new Xs(t._repo,t._path),t._queryParams.getIndex()))));return n.exists()?n.val():null}catch(e){console.error(e)}var t}async function aa(e,t){try{return await ea(Js(oa,e),t),"db write done"}catch(e){console.error(e)}}function la(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function ca(e){let t=e,n=e,r=e;function i(e,t,i=0,o=e.length){if(i<o){if(0!==n(t,t))return o;do{const n=i+o>>>1;r(e[n],t)<0?i=n+1:o=n}while(i<o)}return i}return 2!==e.length&&(t=(t,n)=>e(t)-n,n=la,r=(t,n)=>la(e(t),n)),{left:i,center:function(e,n,r=0,o=e.length){const s=i(e,n,r,o-1);return s>r&&t(e[s-1],n)>-t(e[s],n)?s-1:s},right:function(e,t,i=0,o=e.length){if(i<o){if(0!==n(t,t))return o;do{const n=i+o>>>1;r(e[n],t)<=0?i=n+1:o=n}while(i<o)}return i}}}!function(e=Xt(),t){Vt(e=Et(e),wn).getImmediate({identifier:t})}(ia);const ua=ca(la).right;ca((function(e){return null===e?NaN:+e})).center;var ha=ua;class da{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=t[r],o=e+i,s=Math.abs(e)<Math.abs(i)?e-(o-i):i-(o-e);s&&(t[n++]=s),e=o}return t[n]=e,this._n=n+1,this}valueOf(){const e=this._partials;let t,n,r,i=this._n,o=0;if(i>0){for(o=e[--i];i>0&&(t=o,n=e[--i],o=t+n,r=n-(o-t),!r););i>0&&(r<0&&e[i-1]<0||r>0&&e[i-1]>0)&&(n=2*r,t=o+n,n==t-o&&(o=t))}return o}}var fa=Math.sqrt(50),pa=Math.sqrt(10),ga=Math.sqrt(2);function _a(e,t,n){var r,i,o,s,a=-1;if(n=+n,(e=+e)===(t=+t)&&n>0)return[e];if((r=t<e)&&(i=e,e=t,t=i),0===(s=ma(e,t,n))||!isFinite(s))return[];if(s>0){let n=Math.round(e/s),r=Math.round(t/s);for(n*s<e&&++n,r*s>t&&--r,o=new Array(i=r-n+1);++a<i;)o[a]=(n+a)*s}else{s=-s;let n=Math.round(e*s),r=Math.round(t*s);for(n/s<e&&++n,r/s>t&&--r,o=new Array(i=r-n+1);++a<i;)o[a]=(n+a)/s}return r&&o.reverse(),o}function ma(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=fa?10:o>=pa?5:o>=ga?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=fa?10:o>=pa?5:o>=ga?2:1)}function va(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=fa?i*=10:o>=pa?i*=5:o>=ga&&(i*=2),t<e?-i:i}function ya(e){return Math.ceil(Math.log(function(e,t){let n=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&++n;else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(i=+i)>=i&&++n}return n}(e))/Math.LN2)+1}function wa(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n<t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}var ba={value:()=>{}};function Ca(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new xa(r)}function xa(e){this._=e}function ka(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function Ea(e,t){for(var n,r=0,i=e.length;r<i;++r)if((n=e[r]).name===t)return n.value}function Ia(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=ba,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}xa.prototype=Ca.prototype={constructor:xa,on:function(e,t){var n,r=this._,i=ka(e+"",r),o=-1,s=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++o<s;)if(n=(e=i[o]).type)r[n]=Ia(r[n],e.name,t);else if(null==t)for(n in r)r[n]=Ia(r[n],e.name,null);return this}for(;++o<s;)if((n=(e=i[o]).type)&&(n=Ea(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new xa(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=0,n=(r=this._[e]).length;o<n;++o)r[o].value.apply(t,i)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};var Sa="http://www.w3.org/1999/xhtml",Ta={svg:"http://www.w3.org/2000/svg",xhtml:Sa,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Na(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),Ta.hasOwnProperty(t)?{space:Ta[t],local:e}:e}function Ra(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Sa&&t.documentElement.namespaceURI===Sa?t.createElement(e):t.createElementNS(n,e)}}function Pa(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Ma(e){var t=Na(e);return(t.local?Pa:Ra)(t)}function Aa(){}function Oa(e){return null==e?Aa:function(){return this.querySelector(e)}}function Da(e){return null==e?[]:Array.isArray(e)?e:Array.from(e)}function La(){return[]}function $a(e){return null==e?La:function(){return this.querySelectorAll(e)}}function Fa(e){return function(){return this.matches(e)}}function qa(e){return function(t){return t.matches(e)}}var ja=Array.prototype.find;function za(){return this.firstElementChild}var Ba=Array.prototype.filter;function Wa(){return Array.from(this.children)}function Ua(e){return new Array(e.length)}function Ha(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function Va(e){return function(){return e}}function Ga(e,t,n,r,i,o){for(var s,a=0,l=t.length,c=o.length;a<c;++a)(s=t[a])?(s.__data__=o[a],r[a]=s):n[a]=new Ha(e,o[a]);for(;a<l;++a)(s=t[a])&&(i[a]=s)}function Ya(e,t,n,r,i,o,s){var a,l,c,u=new Map,h=t.length,d=o.length,f=new Array(h);for(a=0;a<h;++a)(l=t[a])&&(f[a]=c=s.call(l,l.__data__,a,t)+"",u.has(c)?i[a]=l:u.set(c,l));for(a=0;a<d;++a)c=s.call(e,o[a],a,o)+"",(l=u.get(c))?(r[a]=l,l.__data__=o[a],u.delete(c)):n[a]=new Ha(e,o[a]);for(a=0;a<h;++a)(l=t[a])&&u.get(f[a])===l&&(i[a]=l)}function Ka(e){return e.__data__}function Xa(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function Qa(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Ja(e){return function(){this.removeAttribute(e)}}function Za(e){return function(){this.removeAttributeNS(e.space,e.local)}}function el(e,t){return function(){this.setAttribute(e,t)}}function tl(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function nl(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function rl(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function il(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function ol(e){return function(){this.style.removeProperty(e)}}function sl(e,t,n){return function(){this.style.setProperty(e,t,n)}}function al(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function ll(e,t){return e.style.getPropertyValue(t)||il(e).getComputedStyle(e,null).getPropertyValue(t)}function cl(e){return function(){delete this[e]}}function ul(e,t){return function(){this[e]=t}}function hl(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function dl(e){return e.trim().split(/^|\s+/)}function fl(e){return e.classList||new pl(e)}function pl(e){this._node=e,this._names=dl(e.getAttribute("class")||"")}function gl(e,t){for(var n=fl(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function _l(e,t){for(var n=fl(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function ml(e){return function(){gl(this,e)}}function vl(e){return function(){_l(this,e)}}function yl(e,t){return function(){(t.apply(this,arguments)?gl:_l)(this,e)}}function wl(){this.textContent=""}function bl(e){return function(){this.textContent=e}}function Cl(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function xl(){this.innerHTML=""}function kl(e){return function(){this.innerHTML=e}}function El(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function Il(){this.nextSibling&&this.parentNode.appendChild(this)}function Sl(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Tl(){return null}function Nl(){var e=this.parentNode;e&&e.removeChild(this)}function Rl(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Pl(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Ml(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function Al(e){return function(){var t=this.__on;if(t){for(var n,r=0,i=-1,o=t.length;r<o;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?t.length=i:delete this.__on}}}function Ol(e,t,n){return function(){var r,i=this.__on,o=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(i)for(var s=0,a=i.length;s<a;++s)if((r=i[s]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),void(r.value=t);this.addEventListener(e.type,o,n),r={type:e.type,name:e.name,value:t,listener:o,options:n},i?i.push(r):this.__on=[r]}}function Dl(e,t,n){var r=il(e),i=r.CustomEvent;"function"==typeof i?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function Ll(e,t){return function(){return Dl(this,e,t)}}function $l(e,t){return function(){return Dl(this,e,t.apply(this,arguments))}}Ha.prototype={constructor:Ha,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}},pl.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var Fl=[null];function ql(e,t){this._groups=e,this._parents=t}function jl(){return new ql([[document.documentElement]],Fl)}function zl(e){return"string"==typeof e?new ql([[document.querySelector(e)]],[document.documentElement]):new ql([[e]],Fl)}function Bl(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Wl(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Ul(){}ql.prototype=jl.prototype={constructor:ql,select:function(e){"function"!=typeof e&&(e=Oa(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,s,a=t[i],l=a.length,c=r[i]=new Array(l),u=0;u<l;++u)(o=a[u])&&(s=e.call(o,o.__data__,u,a))&&("__data__"in o&&(s.__data__=o.__data__),c[u]=s);return new ql(r,this._parents)},selectAll:function(e){e="function"==typeof e?function(e){return function(){return Da(e.apply(this,arguments))}}(e):$a(e);for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var s,a=t[o],l=a.length,c=0;c<l;++c)(s=a[c])&&(r.push(e.call(s,s.__data__,c,a)),i.push(s));return new ql(r,i)},selectChild:function(e){return this.select(null==e?za:function(e){return function(){return ja.call(this.children,e)}}("function"==typeof e?e:qa(e)))},selectChildren:function(e){return this.selectAll(null==e?Wa:function(e){return function(){return Ba.call(this.children,e)}}("function"==typeof e?e:qa(e)))},filter:function(e){"function"!=typeof e&&(e=Fa(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,s=t[i],a=s.length,l=r[i]=[],c=0;c<a;++c)(o=s[c])&&e.call(o,o.__data__,c,s)&&l.push(o);return new ql(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,Ka);var n=t?Ya:Ga,r=this._parents,i=this._groups;"function"!=typeof e&&(e=Va(e));for(var o=i.length,s=new Array(o),a=new Array(o),l=new Array(o),c=0;c<o;++c){var u=r[c],h=i[c],d=h.length,f=Xa(e.call(u,u&&u.__data__,c,r)),p=f.length,g=a[c]=new Array(p),_=s[c]=new Array(p),m=l[c]=new Array(d);n(u,h,g,_,m,f,t);for(var v,y,w=0,b=0;w<p;++w)if(v=g[w]){for(w>=b&&(b=w+1);!(y=_[b])&&++b<p;);v._next=y||null}}return(s=new ql(s,r))._enter=a,s._exit=l,s},enter:function(){return new ql(this._enter||this._groups.map(Ua),this._parents)},exit:function(){return new ql(this._exit||this._groups.map(Ua),this._parents)},join:function(e,t,n){var r=this.enter(),i=this,o=this.exit();return"function"==typeof e?(r=e(r))&&(r=r.selection()):r=r.append(e+""),null!=t&&(i=t(i))&&(i=i.selection()),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,o=r.length,s=Math.min(i,o),a=new Array(i),l=0;l<s;++l)for(var c,u=n[l],h=r[l],d=u.length,f=a[l]=new Array(d),p=0;p<d;++p)(c=u[p]||h[p])&&(f[p]=c);for(;l<i;++l)a[l]=n[l];return new ql(a,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,i=e[t],o=i.length-1,s=i[o];--o>=0;)(r=i[o])&&(s&&4^r.compareDocumentPosition(s)&&s.parentNode.insertBefore(r,s),s=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=Qa);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var s,a=n[o],l=a.length,c=i[o]=new Array(l),u=0;u<l;++u)(s=a[u])&&(c[u]=s);c.sort(t)}return new ql(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var s=r[i];if(s)return s}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i,o=t[n],s=0,a=o.length;s<a;++s)(i=o[s])&&e.call(i,i.__data__,s,o);return this},attr:function(e,t){var n=Na(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?Za:Ja:"function"==typeof t?n.local?rl:nl:n.local?tl:el)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?ol:"function"==typeof t?al:sl)(e,t,null==n?"":n)):ll(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?cl:"function"==typeof t?hl:ul)(e,t)):this.node()[e]},classed:function(e,t){var n=dl(e+"");if(arguments.length<2){for(var r=fl(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof t?yl:t?ml:vl)(n,t))},text:function(e){return arguments.length?this.each(null==e?wl:("function"==typeof e?Cl:bl)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?xl:("function"==typeof e?El:kl)(e)):this.node().innerHTML},raise:function(){return this.each(Il)},lower:function(){return this.each(Sl)},append:function(e){var t="function"==typeof e?e:Ma(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"==typeof e?e:Ma(e),r=null==t?Tl:"function"==typeof t?t:Oa(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(Nl)},clone:function(e){return this.select(e?Pl:Rl)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,i,o=Ml(e+""),s=o.length;if(!(arguments.length<2)){for(a=t?Ol:Al,r=0;r<s;++r)this.each(a(o[r],t,n));return this}var a=this.node().__on;if(a)for(var l,c=0,u=a.length;c<u;++c)for(r=0,l=a[c];r<s;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"==typeof t?$l:Ll)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r,i=e[t],o=0,s=i.length;o<s;++o)(r=i[o])&&(yield r)}};var Hl=.7,Vl=1/Hl,Gl="\\s*([+-]?\\d+)\\s*",Yl="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Kl="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Xl=/^#([0-9a-f]{3,8})$/,Ql=new RegExp("^rgb\\("+[Gl,Gl,Gl]+"\\)$"),Jl=new RegExp("^rgb\\("+[Kl,Kl,Kl]+"\\)$"),Zl=new RegExp("^rgba\\("+[Gl,Gl,Gl,Yl]+"\\)$"),ec=new RegExp("^rgba\\("+[Kl,Kl,Kl,Yl]+"\\)$"),tc=new RegExp("^hsl\\("+[Yl,Kl,Kl]+"\\)$"),nc=new RegExp("^hsla\\("+[Yl,Kl,Kl,Yl]+"\\)$"),rc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function ic(){return this.rgb().formatHex()}function oc(){return this.rgb().formatRgb()}function sc(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Xl.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?ac(t):3===n?new hc(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?lc(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?lc(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Ql.exec(e))?new hc(t[1],t[2],t[3],1):(t=Jl.exec(e))?new hc(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Zl.exec(e))?lc(t[1],t[2],t[3],t[4]):(t=ec.exec(e))?lc(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=tc.exec(e))?gc(t[1],t[2]/100,t[3]/100,1):(t=nc.exec(e))?gc(t[1],t[2]/100,t[3]/100,t[4]):rc.hasOwnProperty(e)?ac(rc[e]):"transparent"===e?new hc(NaN,NaN,NaN,0):null}function ac(e){return new hc(e>>16&255,e>>8&255,255&e,1)}function lc(e,t,n,r){return r<=0&&(e=t=n=NaN),new hc(e,t,n,r)}function cc(e){return e instanceof Ul||(e=sc(e)),e?new hc((e=e.rgb()).r,e.g,e.b,e.opacity):new hc}function uc(e,t,n,r){return 1===arguments.length?cc(e):new hc(e,t,n,null==r?1:r)}function hc(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function dc(){return"#"+pc(this.r)+pc(this.g)+pc(this.b)}function fc(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function pc(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function gc(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new mc(e,t,n,r)}function _c(e){if(e instanceof mc)return new mc(e.h,e.s,e.l,e.opacity);if(e instanceof Ul||(e=sc(e)),!e)return new mc;if(e instanceof mc)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),s=NaN,a=o-i,l=(o+i)/2;return a?(s=t===o?(n-r)/a+6*(n<r):n===o?(r-t)/a+2:(t-n)/a+4,a/=l<.5?o+i:2-o-i,s*=60):a=l>0&&l<1?0:s,new mc(s,a,l,e.opacity)}function mc(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function vc(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}Bl(Ul,sc,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:ic,formatHex:ic,formatHsl:function(){return _c(this).formatHsl()},formatRgb:oc,toString:oc}),Bl(hc,uc,Wl(Ul,{brighter:function(e){return e=null==e?Vl:Math.pow(Vl,e),new hc(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?Hl:Math.pow(Hl,e),new hc(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:dc,formatHex:dc,formatRgb:fc,toString:fc})),Bl(mc,(function(e,t,n,r){return 1===arguments.length?_c(e):new mc(e,t,n,null==r?1:r)}),Wl(Ul,{brighter:function(e){return e=null==e?Vl:Math.pow(Vl,e),new mc(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?Hl:Math.pow(Hl,e),new mc(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new hc(vc(e>=240?e-240:e+120,i,r),vc(e,i,r),vc(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var yc=e=>()=>e;function wc(e){return 1==(e=+e)?bc:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):yc(isNaN(t)?n:t)}}function bc(e,t){var n=t-e;return n?function(e,t){return function(n){return e+n*t}}(e,n):yc(isNaN(e)?t:e)}var Cc=function e(t){var n=wc(t);function r(e,t){var r=n((e=uc(e)).r,(t=uc(t)).r),i=n(e.g,t.g),o=n(e.b,t.b),s=bc(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=s(t),e+""}}return r.gamma=e,r}(1);function xc(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(o){for(n=0;n<r;++n)i[n]=e[n]*(1-o)+t[n]*o;return i}}function kc(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,o=new Array(i),s=new Array(r);for(n=0;n<i;++n)o[n]=Pc(e[n],t[n]);for(;n<r;++n)s[n]=t[n];return function(e){for(n=0;n<i;++n)s[n]=o[n](e);return s}}function Ec(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Ic(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Sc(e,t){var n,r={},i={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=Pc(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}var Tc=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Nc=new RegExp(Tc.source,"g");function Rc(e,t){var n,r,i,o=Tc.lastIndex=Nc.lastIndex=0,s=-1,a=[],l=[];for(e+="",t+="";(n=Tc.exec(e))&&(r=Nc.exec(t));)(i=r.index)>o&&(i=t.slice(o,i),a[s]?a[s]+=i:a[++s]=i),(n=n[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,l.push({i:s,x:Ic(n,r)})),o=Nc.lastIndex;return o<t.length&&(i=t.slice(o),a[s]?a[s]+=i:a[++s]=i),a.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)a[(n=l[r]).i]=n.x(e);return a.join("")})}function Pc(e,t){var n,r,i=typeof t;return null==t||"boolean"===i?yc(t):("number"===i?Ic:"string"===i?(n=sc(t))?(t=n,Cc):Rc:t instanceof sc?Cc:t instanceof Date?Ec:(r=t,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(t)?kc:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?Sc:Ic:xc))(e,t)}function Mc(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var Ac,Oc=180/Math.PI,Dc={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Lc(e,t,n,r,i,o){var s,a,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),e*r<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*Oc,skewX:Math.atan(l)*Oc,scaleX:s,scaleY:a}}function $c(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(o,s){var a=[],l=[];return o=e(o),s=e(s),function(e,r,i,o,s,a){if(e!==i||r!==o){var l=s.push("translate(",null,t,null,n);a.push({i:l-4,x:Ic(e,i)},{i:l-2,x:Ic(r,o)})}else(i||o)&&s.push("translate("+i+t+o+n)}(o.translateX,o.translateY,s.translateX,s.translateY,a,l),function(e,t,n,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Ic(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(o.rotate,s.rotate,a,l),function(e,t,n,o){e!==t?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Ic(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(o.skewX,s.skewX,a,l),function(e,t,n,r,o,s){if(e!==n||t!==r){var a=o.push(i(o)+"scale(",null,",",null,")");s.push({i:a-4,x:Ic(e,n)},{i:a-2,x:Ic(t,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,l),o=s=null,function(e){for(var t,n=-1,r=l.length;++n<r;)a[(t=l[n]).i]=t.x(e);return a.join("")}}}var Fc,qc,jc=$c((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Dc:Lc(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),zc=$c((function(e){return null==e?Dc:(Ac||(Ac=document.createElementNS("http://www.w3.org/2000/svg","g")),Ac.setAttribute("transform",e),(e=Ac.transform.baseVal.consolidate())?Lc((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):Dc)}),", ",")",")"),Bc=0,Wc=0,Uc=0,Hc=0,Vc=0,Gc=0,Yc="object"==typeof performance&&performance.now?performance:Date,Kc="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Xc(){return Vc||(Kc(Qc),Vc=Yc.now()+Gc)}function Qc(){Vc=0}function Jc(){this._call=this._time=this._next=null}function Zc(e,t,n){var r=new Jc;return r.restart(e,t,n),r}function eu(){Vc=(Hc=Yc.now())+Gc,Bc=Wc=0;try{!function(){Xc(),++Bc;for(var e,t=Fc;t;)(e=Vc-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Bc}()}finally{Bc=0,function(){var e,t,n=Fc,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:Fc=t);qc=e,nu(r)}(),Vc=0}}function tu(){var e=Yc.now(),t=e-Hc;t>1e3&&(Gc-=t,Hc=e)}function nu(e){Bc||(Wc&&(Wc=clearTimeout(Wc)),e-Vc>24?(e<1/0&&(Wc=setTimeout(eu,e-Yc.now()-Gc)),Uc&&(Uc=clearInterval(Uc))):(Uc||(Hc=Yc.now(),Uc=setInterval(tu,1e3)),Bc=1,Kc(eu)))}function ru(e,t,n){var r=new Jc;return t=null==t?0:+t,r.restart((n=>{r.stop(),e(n+t)}),t,n),r}Jc.prototype=Zc.prototype={constructor:Jc,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?Xc():+n)+(null==t?0:+t),this._next||qc===this||(qc?qc._next=this:Fc=this,qc=this),this._call=e,this._time=n,nu()},stop:function(){this._call&&(this._call=null,this._time=1/0,nu())}};var iu=Ca("start","end","cancel","interrupt"),ou=[];function su(e,t,n,r,i,o){var s=e.__transition;if(s){if(n in s)return}else e.__transition={};!function(e,t,n){var r,i=e.__transition;function o(e){n.state=1,n.timer.restart(s,n.delay,n.time),n.delay<=e&&s(e-n.delay)}function s(o){var c,u,h,d;if(1!==n.state)return l();for(c in i)if((d=i[c]).name===n.name){if(3===d.state)return ru(s);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",e,e.__data__,d.index,d.group),delete i[c]):+c<t&&(d.state=6,d.timer.stop(),d.on.call("cancel",e,e.__data__,d.index,d.group),delete i[c])}if(ru((function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(o))})),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(h=n.tween.length),c=0,u=-1;c<h;++c)(d=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(r[++u]=d);r.length=u+1}}function a(t){for(var i=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(l),n.state=5,1),o=-1,s=r.length;++o<s;)r[o].call(e,i);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){for(var r in n.state=6,n.timer.stop(),delete i[t],i)return;delete e.__transition}i[t]=n,n.timer=Zc(o,0,n.time)}(e,n,{name:t,index:r,group:i,on:iu,tween:ou,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function au(e,t){var n=cu(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function lu(e,t){var n=cu(e,t);if(n.state>3)throw new Error("too late; already running");return n}function cu(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function uu(e,t){var n,r;return function(){var i=lu(this,e),o=i.tween;if(o!==n)for(var s=0,a=(r=n=o).length;s<a;++s)if(r[s].name===t){(r=r.slice()).splice(s,1);break}i.tween=r}}function hu(e,t,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=lu(this,e),s=o.tween;if(s!==r){i=(r=s).slice();for(var a={name:t,value:n},l=0,c=i.length;l<c;++l)if(i[l].name===t){i[l]=a;break}l===c&&i.push(a)}o.tween=i}}function du(e,t,n){var r=e._id;return e.each((function(){var e=lu(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)})),function(e){return cu(e,r).value[t]}}function fu(e,t){var n;return("number"==typeof t?Ic:t instanceof sc?Cc:(n=sc(t))?(t=n,Cc):Rc)(e,t)}function pu(e){return function(){this.removeAttribute(e)}}function gu(e){return function(){this.removeAttributeNS(e.space,e.local)}}function _u(e,t,n){var r,i,o=n+"";return function(){var s=this.getAttribute(e);return s===o?null:s===r?i:i=t(r=s,n)}}function mu(e,t,n){var r,i,o=n+"";return function(){var s=this.getAttributeNS(e.space,e.local);return s===o?null:s===r?i:i=t(r=s,n)}}function vu(e,t,n){var r,i,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttribute(e))===(a=l+"")?null:s===r&&a===i?o:(i=a,o=t(r=s,l));this.removeAttribute(e)}}function yu(e,t,n){var r,i,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttributeNS(e.space,e.local))===(a=l+"")?null:s===r&&a===i?o:(i=a,o=t(r=s,l));this.removeAttributeNS(e.space,e.local)}}function wu(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function bu(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Cu(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&bu(e,i)),n}return i._value=t,i}function xu(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&wu(e,i)),n}return i._value=t,i}function ku(e,t){return function(){au(this,e).delay=+t.apply(this,arguments)}}function Eu(e,t){return t=+t,function(){au(this,e).delay=t}}function Iu(e,t){return function(){lu(this,e).duration=+t.apply(this,arguments)}}function Su(e,t){return t=+t,function(){lu(this,e).duration=t}}function Tu(e,t){if("function"!=typeof t)throw new Error;return function(){lu(this,e).ease=t}}function Nu(e,t,n){var r,i,o=function(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}(t)?au:lu;return function(){var s=o(this,e),a=s.on;a!==r&&(i=(r=a).copy()).on(t,n),s.on=i}}var Ru=jl.prototype.constructor;function Pu(e){return function(){this.style.removeProperty(e)}}function Mu(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function Au(e,t,n){var r,i;function o(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&Mu(e,o,n)),r}return o._value=t,o}function Ou(e){return function(t){this.textContent=e.call(this,t)}}function Du(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&Ou(r)),t}return r._value=e,r}var Lu=0;function $u(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Fu(){return++Lu}var qu=jl.prototype;$u.prototype={constructor:$u,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=Oa(e));for(var r=this._groups,i=r.length,o=new Array(i),s=0;s<i;++s)for(var a,l,c=r[s],u=c.length,h=o[s]=new Array(u),d=0;d<u;++d)(a=c[d])&&(l=e.call(a,a.__data__,d,c))&&("__data__"in a&&(l.__data__=a.__data__),h[d]=l,su(h[d],t,n,d,h,cu(a,n)));return new $u(o,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=$a(e));for(var r=this._groups,i=r.length,o=[],s=[],a=0;a<i;++a)for(var l,c=r[a],u=c.length,h=0;h<u;++h)if(l=c[h]){for(var d,f=e.call(l,l.__data__,h,c),p=cu(l,n),g=0,_=f.length;g<_;++g)(d=f[g])&&su(d,t,n,g,f,p);o.push(f),s.push(l)}return new $u(o,s,t,n)},selectChild:qu.selectChild,selectChildren:qu.selectChildren,filter:function(e){"function"!=typeof e&&(e=Fa(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,s=t[i],a=s.length,l=r[i]=[],c=0;c<a;++c)(o=s[c])&&e.call(o,o.__data__,c,s)&&l.push(o);return new $u(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),s=new Array(r),a=0;a<o;++a)for(var l,c=t[a],u=n[a],h=c.length,d=s[a]=new Array(h),f=0;f<h;++f)(l=c[f]||u[f])&&(d[f]=l);for(;a<r;++a)s[a]=t[a];return new $u(s,this._parents,this._name,this._id)},selection:function(){return new Ru(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=Fu(),r=this._groups,i=r.length,o=0;o<i;++o)for(var s,a=r[o],l=a.length,c=0;c<l;++c)if(s=a[c]){var u=cu(s,t);su(s,e,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new $u(r,this._parents,e,n)},call:qu.call,nodes:qu.nodes,node:qu.node,size:qu.size,empty:qu.empty,each:qu.each,on:function(e,t){var n=this._id;return arguments.length<2?cu(this.node(),n).on.on(e):this.each(Nu(n,e,t))},attr:function(e,t){var n=Na(e),r="transform"===n?zc:fu;return this.attrTween(e,"function"==typeof t?(n.local?yu:vu)(n,r,du(this,"attr."+e,t)):null==t?(n.local?gu:pu)(n):(n.local?mu:_u)(n,r,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var r=Na(e);return this.tween(n,(r.local?Cu:xu)(r,t))},style:function(e,t,n){var r="transform"==(e+="")?jc:fu;return null==t?this.styleTween(e,function(e,t){var n,r,i;return function(){var o=ll(this,e),s=(this.style.removeProperty(e),ll(this,e));return o===s?null:o===n&&s===r?i:i=t(n=o,r=s)}}(e,r)).on("end.style."+e,Pu(e)):"function"==typeof t?this.styleTween(e,function(e,t,n){var r,i,o;return function(){var s=ll(this,e),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(e),l=a=ll(this,e)),s===l?null:s===r&&l===i?o:(i=l,o=t(r=s,a))}}(e,r,du(this,"style."+e,t))).each(function(e,t){var n,r,i,o,s="style."+t,a="end."+s;return function(){var l=lu(this,e),c=l.on,u=null==l.value[s]?o||(o=Pu(t)):void 0;c===n&&i===u||(r=(n=c).copy()).on(a,i=u),l.on=r}}(this._id,e)):this.styleTween(e,function(e,t,n){var r,i,o=n+"";return function(){var s=ll(this,e);return s===o?null:s===r?i:i=t(r=s,n)}}(e,r,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!=typeof t)throw new Error;return this.tween(r,Au(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(du(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;return this.tween(t,Du(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,i=cu(this.node(),n).tween,o=0,s=i.length;o<s;++o)if((r=i[o]).name===e)return r.value;return null}return this.each((null==t?uu:hu)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?ku:Eu)(t,e)):cu(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?Iu:Su)(t,e)):cu(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(Tu(t,e)):cu(this.node(),t).ease},easeVarying:function(e){if("function"!=typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!=typeof n)throw new Error;lu(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,r=n._id,i=n.size();return new Promise((function(o,s){var a={value:s},l={value:function(){0==--i&&o()}};n.each((function(){var n=lu(this,r),i=n.on;i!==e&&((t=(e=i).copy())._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),n.on=t})),0===i&&o()}))},[Symbol.iterator]:qu[Symbol.iterator]};var ju={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function zu(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}jl.prototype.interrupt=function(e){return this.each((function(){!function(e,t){var n,r,i,o=e.__transition,s=!0;if(o){for(i in t=null==t?null:t+"",o)(n=o[i]).name===t?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete o[i]):s=!1;s&&delete e.__transition}}(this,e)}))},jl.prototype.transition=function(e){var t,n;e instanceof $u?(t=e._id,e=e._name):(t=Fu(),(n=ju).time=Xc(),e=null==e?null:e+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var s,a=r[o],l=a.length,c=0;c<l;++c)(s=a[c])&&su(s,e,t,c,a,n||zu(s,t));return new $u(r,this._parents,e,t)};var Bu=Array.prototype.slice;function Wu(e,t){return e-t}var Uu=e=>()=>e;function Hu(e,t){for(var n,r=-1,i=t.length;++r<i;)if(n=Vu(e,t[r]))return n;return 0}function Vu(e,t){for(var n=t[0],r=t[1],i=-1,o=0,s=e.length,a=s-1;o<s;a=o++){var l=e[o],c=l[0],u=l[1],h=e[a],d=h[0],f=h[1];if(Gu(l,h,t))return 0;u>r!=f>r&&n<(d-c)*(r-u)/(f-u)+c&&(i=-i)}return i}function Gu(e,t,n){var r,i,o,s;return function(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}(e,t,n)&&(i=e[r=+(e[0]===t[0])],o=n[r],s=t[r],i<=o&&o<=s||s<=o&&o<=i)}function Yu(){}var Ku=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function Xu(){var e=1,t=1,n=ya,r=a;function i(e){var t=n(e);if(Array.isArray(t))t=t.slice().sort(Wu);else{const n=function(e,t){let n,r;if(void 0===t)for(const t of e)null!=t&&(void 0===n?t>=t&&(n=r=t):(n>t&&(n=t),r<t&&(r=t)));else{let i=-1;for(let o of e)null!=(o=t(o,++i,e))&&(void 0===n?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}return[n,r]}(e),r=va(n[0],n[1],t);t=_a(Math.floor(n[0]/r)*r,Math.floor(n[1]/r-1)*r,t)}return t.map((t=>o(e,t)))}function o(n,i){var o=[],a=[];return function(n,r,i){var o,a,l,c,u,h,d=new Array,f=new Array;o=a=-1,c=n[0]>=r,Ku[c<<1].forEach(p);for(;++o<e-1;)l=c,c=n[o+1]>=r,Ku[l|c<<1].forEach(p);Ku[c<<0].forEach(p);for(;++a<t-1;){for(o=-1,c=n[a*e+e]>=r,u=n[a*e]>=r,Ku[c<<1|u<<2].forEach(p);++o<e-1;)l=c,c=n[a*e+e+o+1]>=r,h=u,u=n[a*e+o+1]>=r,Ku[l|c<<1|u<<2|h<<3].forEach(p);Ku[c|u<<3].forEach(p)}o=-1,u=n[a*e]>=r,Ku[u<<2].forEach(p);for(;++o<e-1;)h=u,u=n[a*e+o+1]>=r,Ku[u<<2|h<<3].forEach(p);function p(e){var t,n,r=[e[0][0]+o,e[0][1]+a],l=[e[1][0]+o,e[1][1]+a],c=s(r),u=s(l);(t=f[c])?(n=d[u])?(delete f[t.end],delete d[n.start],t===n?(t.ring.push(l),i(t.ring)):d[t.start]=f[n.end]={start:t.start,end:n.end,ring:t.ring.concat(n.ring)}):(delete f[t.end],t.ring.push(l),f[t.end=u]=t):(t=d[u])?(n=f[c])?(delete d[t.start],delete f[n.end],t===n?(t.ring.push(l),i(t.ring)):d[n.start]=f[t.end]={start:n.start,end:t.end,ring:n.ring.concat(t.ring)}):(delete d[t.start],t.ring.unshift(r),d[t.start=c]=t):d[c]=f[u]={start:c,end:u,ring:[r,l]}}Ku[u<<3].forEach(p)}(n,i,(function(e){r(e,n,i),function(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}(e)>0?o.push([e]):a.push(e)})),a.forEach((function(e){for(var t,n=0,r=o.length;n<r;++n)if(-1!==Hu((t=o[n])[0],e))return void t.push(e)})),{type:"MultiPolygon",value:i,coordinates:o}}function s(t){return 2*t[0]+t[1]*(e+1)*4}function a(n,r,i){n.forEach((function(n){var o,s=n[0],a=n[1],l=0|s,c=0|a,u=r[c*e+l];s>0&&s<e&&l===s&&(o=r[c*e+l-1],n[0]=s+(i-o)/(u-o)-.5),a>0&&a<t&&c===a&&(o=r[(c-1)*e+l],n[1]=a+(i-o)/(u-o)-.5)}))}return i.contour=o,i.size=function(n){if(!arguments.length)return[e,t];var r=Math.floor(n[0]),o=Math.floor(n[1]);if(!(r>=0&&o>=0))throw new Error("invalid size");return e=r,t=o,i},i.thresholds=function(e){return arguments.length?(n="function"==typeof e?e:Array.isArray(e)?Uu(Bu.call(e)):Uu(e),i):n},i.smooth=function(e){return arguments.length?(r=e?a:Yu,i):r===a},i}function Qu(e,t,n){for(var r=e.width,i=e.height,o=1+(n<<1),s=0;s<i;++s)for(var a=0,l=0;a<r+n;++a)a<r&&(l+=e.data[a+s*r]),a>=n&&(a>=o&&(l-=e.data[a-o+s*r]),t.data[a-n+s*r]=l/Math.min(a+1,r-1+o-a,o))}function Ju(e,t,n){for(var r=e.width,i=e.height,o=1+(n<<1),s=0;s<r;++s)for(var a=0,l=0;a<i+n;++a)a<i&&(l+=e.data[s+a*r]),a>=n&&(a>=o&&(l-=e.data[s+(a-o)*r]),t.data[s+(a-n)*r]=l/Math.min(a+1,i-1+o-a,o))}function Zu(e){return e[0]}function eh(e){return e[1]}function th(){return 1}function nh(){var e=Zu,t=eh,n=th,r=960,i=500,o=20,s=2,a=3*o,l=r+2*a>>s,c=i+2*a>>s,u=Uu(20);function h(r){var i=new Float32Array(l*c),h=new Float32Array(l*c),f=Math.pow(2,-s);r.forEach((function(r,o,s){var u=(e(r,o,s)+a)*f,h=(t(r,o,s)+a)*f,d=+n(r,o,s);if(u>=0&&u<l&&h>=0&&h<c){var p=Math.floor(u),g=Math.floor(h),_=u-p-.5,m=h-g-.5;i[p+g*l]+=(1-_)*(1-m)*d,i[p+1+g*l]+=_*(1-m)*d,i[p+1+(g+1)*l]+=_*m*d,i[p+(g+1)*l]+=(1-_)*m*d}})),Qu({width:l,height:c,data:i},{width:l,height:c,data:h},o>>s),Ju({width:l,height:c,data:h},{width:l,height:c,data:i},o>>s),Qu({width:l,height:c,data:i},{width:l,height:c,data:h},o>>s),Ju({width:l,height:c,data:h},{width:l,height:c,data:i},o>>s),Qu({width:l,height:c,data:i},{width:l,height:c,data:h},o>>s),Ju({width:l,height:c,data:h},{width:l,height:c,data:i},o>>s);var p=u(i);if(!Array.isArray(p)){var g=wa(i);p=va(0,g,p),p=function(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),o=new Array(i);++r<i;)o[r]=e+r*n;return o}(0,Math.floor(g/p)*p,p),p.shift()}return Xu().thresholds(p).size([l,c])(i).map(d)}function d(e){return e.value*=Math.pow(2,-2*s),e.coordinates.forEach(f),e}function f(e){e.forEach(p)}function p(e){e.forEach(g)}function g(e){e[0]=e[0]*Math.pow(2,s)-a,e[1]=e[1]*Math.pow(2,s)-a}function _(){return l=r+2*(a=3*o)>>s,c=i+2*a>>s,h}return h.x=function(t){return arguments.length?(e="function"==typeof t?t:Uu(+t),h):e},h.y=function(e){return arguments.length?(t="function"==typeof e?e:Uu(+e),h):t},h.weight=function(e){return arguments.length?(n="function"==typeof e?e:Uu(+e),h):n},h.size=function(e){if(!arguments.length)return[r,i];var t=+e[0],n=+e[1];if(!(t>=0&&n>=0))throw new Error("invalid size");return r=t,i=n,_()},h.cellSize=function(e){if(!arguments.length)return 1<<s;if(!((e=+e)>=1))throw new Error("invalid cell size");return s=Math.floor(Math.log(e)/Math.LN2),_()},h.thresholds=function(e){return arguments.length?(u="function"==typeof e?e:Array.isArray(e)?Uu(Bu.call(e)):Uu(e),h):u},h.bandwidth=function(e){if(!arguments.length)return Math.sqrt(o*(o+1));if(!((e=+e)>=0))throw new Error("invalid bandwidth");return o=Math.round((Math.sqrt(4*e*e+1)-1)/2),_()},h}function rh(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function ih(e){return(e=rh(Math.abs(e)))?e[1]:NaN}var oh,sh=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ah(e){if(!(t=sh.exec(e)))throw new Error("invalid format: "+e);var t;return new lh({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function lh(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function ch(e,t){var n=rh(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}ah.prototype=lh.prototype,lh.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var uh={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>ch(100*e,t),r:ch,s:function(e,t){var n=rh(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(oh=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+rh(e,Math.max(0,t+o-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function hh(e){return e}var dh,fh,ph,gh=Array.prototype.map,_h=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function mh(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?hh:(t=gh.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,o=[],s=0,a=t[0],l=0;i>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),o.push(e.substring(i-=a,i+a)),!((l+=a+1)>r));)a=t[s=(s+1)%t.length];return o.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",s=void 0===e.decimal?".":e.decimal+"",a=void 0===e.numerals?hh:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(gh.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"−":e.minus+"",u=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=ah(e)).fill,n=e.align,h=e.sign,d=e.symbol,f=e.zero,p=e.width,g=e.comma,_=e.precision,m=e.trim,v=e.type;"n"===v?(g=!0,v="g"):uh[v]||(void 0===_&&(_=12),m=!0,v="g"),(f||"0"===t&&"="===n)&&(f=!0,t="0",n="=");var y="$"===d?i:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",w="$"===d?o:/[%p]/.test(v)?l:"",b=uh[v],C=/[defgprs%]/.test(v);function x(e){var i,o,l,d=y,x=w;if("c"===v)x=b(e)+x,e="";else{var k=(e=+e)<0||1/e<0;if(e=isNaN(e)?u:b(Math.abs(e),_),m&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),k&&0==+e&&"+"!==h&&(k=!1),d=(k?"("===h?h:c:"-"===h||"("===h?"":h)+d,x=("s"===v?_h[8+oh/3]:"")+x+(k&&"("===h?")":""),C)for(i=-1,o=e.length;++i<o;)if(48>(l=e.charCodeAt(i))||l>57){x=(46===l?s+e.slice(i+1):e.slice(i))+x,e=e.slice(0,i);break}}g&&!f&&(e=r(e,1/0));var E=d.length+e.length+x.length,I=E<p?new Array(p-E+1).join(t):"";switch(g&&f&&(e=r(I+e,I.length?p-x.length:1/0),I=""),n){case"<":e=d+e+x+I;break;case"=":e=d+I+e+x;break;case"^":e=I.slice(0,E=I.length>>1)+d+e+x+I.slice(E);break;default:e=I+d+e+x}return a(e)}return _=void 0===_?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_)),x.toString=function(){return e+""},x}return{format:h,formatPrefix:function(e,t){var n=h(((e=ah(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(ih(t)/3))),i=Math.pow(10,-r),o=_h[8+r/3];return function(e){return n(i*e)+o}}}}dh=mh({thousands:",",grouping:[3],currency:["$",""]}),fh=dh.format,ph=dh.formatPrefix;var vh=2*Math.PI,yh=Math.abs,wh=Math.sqrt;function bh(){}function Ch(e,t){e&&kh.hasOwnProperty(e.type)&&kh[e.type](e,t)}var xh={Feature:function(e,t){Ch(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)Ch(n[r].geometry,t)}},kh={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){Eh(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Eh(n[r],t,0)},Polygon:function(e,t){Ih(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Ih(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)Ch(n[r],t)}};function Eh(e,t,n){var r,i=-1,o=e.length-n;for(t.lineStart();++i<o;)r=e[i],t.point(r[0],r[1],r[2]);t.lineEnd()}function Ih(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)Eh(e[n],t,1);t.polygonEnd()}function Sh(e,t){e&&xh.hasOwnProperty(e.type)?xh[e.type](e,t):Ch(e,t)}var Th,Nh,Rh,Ph,Mh=e=>e,Ah=new da,Oh=new da,Dh={point:bh,lineStart:bh,lineEnd:bh,polygonStart:function(){Dh.lineStart=Lh,Dh.lineEnd=qh},polygonEnd:function(){Dh.lineStart=Dh.lineEnd=Dh.point=bh,Ah.add(yh(Oh)),Oh=new da},result:function(){var e=Ah/2;return Ah=new da,e}};function Lh(){Dh.point=$h}function $h(e,t){Dh.point=Fh,Th=Rh=e,Nh=Ph=t}function Fh(e,t){Oh.add(Ph*e-Rh*t),Rh=e,Ph=t}function qh(){Fh(Th,Nh)}var jh=Dh,zh=1/0,Bh=zh,Wh=-zh,Uh=Wh;var Hh,Vh,Gh,Yh,Kh={point:function(e,t){e<zh&&(zh=e);e>Wh&&(Wh=e);t<Bh&&(Bh=t);t>Uh&&(Uh=t)},lineStart:bh,lineEnd:bh,polygonStart:bh,polygonEnd:bh,result:function(){var e=[[zh,Bh],[Wh,Uh]];return Wh=Uh=-(Bh=zh=1/0),e}},Xh=0,Qh=0,Jh=0,Zh=0,ed=0,td=0,nd=0,rd=0,id=0,od={point:sd,lineStart:ad,lineEnd:ud,polygonStart:function(){od.lineStart=hd,od.lineEnd=dd},polygonEnd:function(){od.point=sd,od.lineStart=ad,od.lineEnd=ud},result:function(){var e=id?[nd/id,rd/id]:td?[Zh/td,ed/td]:Jh?[Xh/Jh,Qh/Jh]:[NaN,NaN];return Xh=Qh=Jh=Zh=ed=td=nd=rd=id=0,e}};function sd(e,t){Xh+=e,Qh+=t,++Jh}function ad(){od.point=ld}function ld(e,t){od.point=cd,sd(Gh=e,Yh=t)}function cd(e,t){var n=e-Gh,r=t-Yh,i=wh(n*n+r*r);Zh+=i*(Gh+e)/2,ed+=i*(Yh+t)/2,td+=i,sd(Gh=e,Yh=t)}function ud(){od.point=sd}function hd(){od.point=fd}function dd(){pd(Hh,Vh)}function fd(e,t){od.point=pd,sd(Hh=Gh=e,Vh=Yh=t)}function pd(e,t){var n=e-Gh,r=t-Yh,i=wh(n*n+r*r);Zh+=i*(Gh+e)/2,ed+=i*(Yh+t)/2,td+=i,nd+=(i=Yh*e-Gh*t)*(Gh+e),rd+=i*(Yh+t),id+=3*i,sd(Gh=e,Yh=t)}var gd=od;function _d(e){this._context=e}_d.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,vh)}},result:bh};var md,vd,yd,wd,bd,Cd=new da,xd={point:bh,lineStart:function(){xd.point=kd},lineEnd:function(){md&&Ed(vd,yd),xd.point=bh},polygonStart:function(){md=!0},polygonEnd:function(){md=null},result:function(){var e=+Cd;return Cd=new da,e}};function kd(e,t){xd.point=Ed,vd=wd=e,yd=bd=t}function Ed(e,t){wd-=e,bd-=t,Cd.add(wh(wd*wd+bd*bd)),wd=e,bd=t}var Id=xd;function Sd(){this._string=[]}function Td(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function Nd(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function Rd(e){return+e}Sd.prototype={_radius:4.5,_circle:Td(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._string.push("M",e,",",t),this._point=1;break;case 1:this._string.push("L",e,",",t);break;default:null==this._circle&&(this._circle=Td(this._radius)),this._string.push("M",e,",",t,this._circle)}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}return null}};var Pd=[0,1];function Md(e){return e}function Ad(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function Od(e,t,n){var r=e[0],i=e[1],o=t[0],s=t[1];return i<r?(r=Ad(i,r),o=n(s,o)):(r=Ad(r,i),o=n(o,s)),function(e){return o(r(e))}}function Dd(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),s=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<r;)i[s]=Ad(e[s],e[s+1]),o[s]=n(t[s],t[s+1]);return function(t){var n=ha(e,t,1,r)-1;return o[n](i[n](t))}}function Ld(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function $d(){var e,t,n,r,i,o,s=Pd,a=Pd,l=Pc,c=Md;function u(){var e,t,n,l=Math.min(s.length,a.length);return c!==Md&&(e=s[0],t=s[l-1],e>t&&(n=e,e=t,t=n),c=function(n){return Math.max(e,Math.min(t,n))}),r=l>2?Dd:Od,i=o=null,h}function h(t){return null==t||isNaN(t=+t)?n:(i||(i=r(s.map(e),a,l)))(e(c(t)))}return h.invert=function(n){return c(t((o||(o=r(a,s.map(e),Ic)))(n)))},h.domain=function(e){return arguments.length?(s=Array.from(e,Rd),u()):s.slice()},h.range=function(e){return arguments.length?(a=Array.from(e),u()):a.slice()},h.rangeRound=function(e){return a=Array.from(e),l=Mc,u()},h.clamp=function(e){return arguments.length?(c=!!e||Md,u()):c!==Md},h.interpolate=function(e){return arguments.length?(l=e,u()):l},h.unknown=function(e){return arguments.length?(n=e,h):n},function(n,r){return e=n,t=r,u()}}function Fd(){return $d()(Md,Md)}function qd(e,t,n,r){var i,o=va(e,t,n);switch((r=ah(null==r?",f":r)).type){case"s":var s=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(ih(t)/3)))-ih(Math.abs(e)))}(o,s))||(r.precision=i),ph(r,s);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,ih(t)-ih(e))+1}(o,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(e){return Math.max(0,-ih(Math.abs(e)))}(o))||(r.precision=i-2*("%"===r.type))}return fh(r)}function jd(e){var t=e.domain;return e.ticks=function(e){var n=t();return _a(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return qd(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i,o=t(),s=0,a=o.length-1,l=o[s],c=o[a],u=10;for(c<l&&(i=l,l=c,c=i,i=s,s=a,a=i);u-- >0;){if((i=ma(l,c,n))===r)return o[s]=l,o[a]=c,t(o);if(i>0)l=Math.floor(l/i)*i,c=Math.ceil(c/i)*i;else{if(!(i<0))break;l=Math.ceil(l*i)/i,c=Math.floor(c*i)/i}r=i}return e},e}function zd(){var e=Fd();return e.copy=function(){return Ld(e,zd())},Nd.apply(e,arguments),jd(e)}async function Bd(e,t,n,r){let i=zl(t).node().getBoundingClientRect().width,o=.705*i,s=zl(n),a=zd().domain([0,100]).range([30,i-30]),l=zd().domain([0,100]).range([30,o-30]),c=nh().x((e=>a(e.xPct))).y((e=>l(e.yPct))).size([i,o]).bandwidth(25).thresholds(20)(e),u=function(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}(c,(e=>e.value)),h=wa(c,(e=>e.value)),d=zd().domain([h,.75*h,,h/2,h/3,u]).range([0,.5,.75,1,8]),f=zd().domain([h,u]).range([1,1]);s.selectAll(".clipPathGroup").data(c,(e=>e.coordinates[0])).join("g").attr("class","clipPathGroup"),s.selectAll(".clipPathGroup").append("clipPath").attr("id",((e,t)=>"path-"+t)).append("path").attr("stroke-linejoin","round").attr("d",function(e,t){var n,r,i=4.5;function o(e){return e&&("function"==typeof i&&r.pointRadius(+i.apply(this,arguments)),Sh(e,n(r))),r.result()}return o.area=function(e){return Sh(e,n(jh)),jh.result()},o.measure=function(e){return Sh(e,n(Id)),Id.result()},o.bounds=function(e){return Sh(e,n(Kh)),Kh.result()},o.centroid=function(e){return Sh(e,n(gd)),gd.result()},o.projection=function(t){return arguments.length?(n=null==t?(e=null,Mh):(e=t).stream,o):e},o.context=function(e){return arguments.length?(r=null==e?(t=null,new Sd):new _d(t=e),"function"!=typeof i&&r.pointRadius(i),o):t},o.pointRadius=function(e){return arguments.length?(i="function"==typeof e?e:(r.pointRadius(+e),+e),o):i},o.projection(e).context(t)}()),s.selectAll(".clipPathGroup").append("image").attr("clip-path",((e,t)=>`url(#path-${t})`)).attr("width","100%").attr("height","100%").attr("xlink:href",r).style("filter",(e=>`opacity(${f(e.value)}) blur(${d(e.value)}px)`))}function Wd(t){let n,r;return{c(){n=I("div"),r=S(t[2]),P(n,"class","tooltip svelte-txget2"),O(n,"top",t[0]+20+"px"),O(n,"left",t[1]+"px")},m(e,t){x(e,n,t),w(n,r)},p(e,[t]){4&t&&M(r,e[2]),1&t&&O(n,"top",e[0]+20+"px"),2&t&&O(n,"left",e[1]+"px")},i:e,o:e,d(e){e&&k(n)}}}function Ud(e,t,n){let r,i,o;return d(e,qe,(e=>n(0,r=e))),d(e,Fe,(e=>n(1,i=e))),d(e,$e,(e=>n(2,o=e))),[r,i,o]}class Hd extends me{constructor(e){super(),_e(this,e,Ud,Wd,a,{})}}function Vd(e,t,n){n||e||t?(Fe.set(e),qe.set(t),n&&$e.set(n)):$e.set("")}var Gd="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Yd(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets option of @rollup/plugin-commonjs appropriately for this require call to behave properly.')}
/*!
        localForage -- Offline Storage, Improved
        Version 1.10.0
        https://localforage.github.io/localForage
        (c) 2013-2017 Mozilla, Apache License 2.0
    */var Kd,Xd,Qd=(Kd=function(e,t){e.exports=function e(t,n,r){function i(s,a){if(!n[s]){if(!t[s]){if(!a&&Yd)return Yd(s);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[s]={exports:{}};t[s][0].call(c.exports,(function(e){var n=t[s][1][e];return i(n||e)}),c,c.exports,e,t,n,r)}return n[s].exports}for(var o=Yd,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){(function(e){var n,r,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var o=0,s=new i(u),a=e.document.createTextNode("");s.observe(a,{characterData:!0}),n=function(){a.data=o=++o%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var l=new e.MessageChannel;l.port1.onmessage=u,n=function(){l.port2.postMessage(0)}}var c=[];function u(){var e,t;r=!0;for(var n=c.length;n;){for(t=c,c=[],e=-1;++e<n;)t[e]();n=c.length}r=!1}function h(e){1!==c.push(e)||r||n()}t.exports=h}).call(this,void 0!==Gd?Gd:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){var r=e(1);function i(){}var o={},s=["REJECTED"],a=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==i&&f(this,e)}function u(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function h(e,t,n){r((function(){var r;try{r=t(n)}catch(t){return o.reject(e,t)}r===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,r)}))}function d(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var n=!1;function r(t){n||(n=!0,o.reject(e,t))}function i(t){n||(n=!0,o.resolve(e,t))}function s(){t(i,r)}var a=p(s);"error"===a.status&&r(a.value)}function p(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}function g(e){return e instanceof this?e:o.resolve(new this(i),e)}function _(e){var t=new this(i);return o.reject(t,e)}function m(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var s=new Array(n),a=0,l=-1,c=new this(i);++l<n;)u(e[l],l);return c;function u(e,i){function l(e){s[i]=e,++a!==n||r||(r=!0,o.resolve(c,s))}t.resolve(e).then(l,(function(e){r||(r=!0,o.reject(c,e))}))}}function v(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var s=-1,a=new this(i);++s<n;)l(e[s]);return a;function l(e){t.resolve(e).then((function(e){r||(r=!0,o.resolve(a,e))}),(function(e){r||(r=!0,o.reject(a,e))}))}}t.exports=c,c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===s)return this;var n=new this.constructor(i);return this.state!==l?h(n,this.state===a?e:t,this.outcome):this.queue.push(new u(n,e,t)),n},u.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){h(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){o.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){h(this.promise,this.onRejected,e)},o.resolve=function(e,t){var n=p(d,t);if("error"===n.status)return o.reject(e,n.value);var r=n.value;if(r)f(e,r);else{e.state=a,e.outcome=t;for(var i=-1,s=e.queue.length;++i<s;)e.queue[i].callFulfilled(t)}return e},o.reject=function(e,t){e.state=s,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},c.resolve=g,c.reject=_,c.all=m,c.race=v},{1:1}],3:[function(e,t,n){(function(t){"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==Gd?Gd:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}var s=o();function a(){try{if(!s||!s.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}function l(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(i){if("TypeError"!==i.name)throw i;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var c=Promise;function u(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function h(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function d(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function f(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var p="local-forage-detect-blob-support",g=void 0,_={},m=Object.prototype.toString,v="readonly",y="readwrite";function w(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),i=0;i<t;i++)r[i]=e.charCodeAt(i);return n}function b(e){return new c((function(t){var n=e.transaction(p,y),r=l([""]);n.objectStore(p).put(r,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}function C(e){return"boolean"==typeof g?c.resolve(g):b(e).then((function(e){return g=e}))}function x(e){var t=_[e.name],n={};n.promise=new c((function(e,t){n.resolve=e,n.reject=t})),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then((function(){return n.promise})):t.dbReady=n.promise}function k(e){var t=_[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function E(e,t){var n=_[e.name].deferredOperations.pop();if(n)return n.reject(t),n.promise}function I(e,t){return new c((function(n,r){if(_[e.name]=_[e.name]||L(),e.db){if(!t)return n(e.db);x(e),e.db.close()}var i=[e.name];t&&i.push(e.version);var o=s.open.apply(s,i);t&&(o.onupgradeneeded=function(t){var n=o.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore(p)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),o.onerror=function(e){e.preventDefault(),r(o.error)},o.onsuccess=function(){var t=o.result;t.onversionchange=function(e){e.target.close()},n(t),k(e)}}))}function S(e){return I(e,!1)}function T(e){return I(e,!0)}function N(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,i=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),i||n){if(n){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function R(e){return new c((function(t,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");t({__local_forage_encoded_blob:!0,data:r,type:e.type})},r.readAsBinaryString(e)}))}function P(e){return l([w(atob(e.data))],{type:e.type})}function M(e){return e&&e.__local_forage_encoded_blob}function A(e){var t=this,n=t._initReady().then((function(){var e=_[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return h(n,e,e),n}function O(e){x(e);for(var t=_[e.name],n=t.forages,r=0;r<n.length;r++){var i=n[r];i._dbInfo.db&&(i._dbInfo.db.close(),i._dbInfo.db=null)}return e.db=null,S(e).then((function(t){return e.db=t,N(e)?T(e):t})).then((function(r){e.db=t.db=r;for(var i=0;i<n.length;i++)n[i]._dbInfo.db=r})).catch((function(t){throw E(e,t),t}))}function D(e,t,n,r){void 0===r&&(r=1);try{var i=e.db.transaction(e.storeName,t);n(null,i)}catch(i){if(r>0&&(!e.db||"InvalidStateError"===i.name||"NotFoundError"===i.name))return c.resolve().then((function(){if(!e.db||"NotFoundError"===i.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),T(e)})).then((function(){return O(e).then((function(){D(e,t,n,r-1)}))})).catch(n);n(i)}}function L(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function $(e){var t=this,n={db:null};if(e)for(var r in e)n[r]=e[r];var i=_[n.name];i||(i=L(),_[n.name]=i),i.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=A);var o=[];function s(){return c.resolve()}for(var a=0;a<i.forages.length;a++){var l=i.forages[a];l!==t&&o.push(l._initReady().catch(s))}var u=i.forages.slice(0);return c.all(o).then((function(){return n.db=i.db,S(n)})).then((function(e){return n.db=e,N(n,t._defaultConfig.version)?T(n):e})).then((function(e){n.db=i.db=e,t._dbInfo=n;for(var r=0;r<u.length;r++){var o=u[r];o!==t&&(o._dbInfo.db=n.db,o._dbInfo.version=n.version)}}))}function F(e,t){var n=this;e=d(e);var r=new c((function(t,r){n.ready().then((function(){D(n._dbInfo,v,(function(i,o){if(i)return r(i);try{var s=o.objectStore(n._dbInfo.storeName).get(e);s.onsuccess=function(){var e=s.result;void 0===e&&(e=null),M(e)&&(e=P(e)),t(e)},s.onerror=function(){r(s.error)}}catch(e){r(e)}}))})).catch(r)}));return u(r,t),r}function q(e,t){var n=this,r=new c((function(t,r){n.ready().then((function(){D(n._dbInfo,v,(function(i,o){if(i)return r(i);try{var s=o.objectStore(n._dbInfo.storeName).openCursor(),a=1;s.onsuccess=function(){var n=s.result;if(n){var r=n.value;M(r)&&(r=P(r));var i=e(r,n.key,a++);void 0!==i?t(i):n.continue()}else t()},s.onerror=function(){r(s.error)}}catch(e){r(e)}}))})).catch(r)}));return u(r,t),r}function j(e,t,n){var r=this;e=d(e);var i=new c((function(n,i){var o;r.ready().then((function(){return o=r._dbInfo,"[object Blob]"===m.call(t)?C(o.db).then((function(e){return e?t:R(t)})):t})).then((function(t){D(r._dbInfo,y,(function(o,s){if(o)return i(o);try{var a=s.objectStore(r._dbInfo.storeName);null===t&&(t=void 0);var l=a.put(t,e);s.oncomplete=function(){void 0===t&&(t=null),n(t)},s.onabort=s.onerror=function(){var e=l.error?l.error:l.transaction.error;i(e)}}catch(e){i(e)}}))})).catch(i)}));return u(i,n),i}function z(e,t){var n=this;e=d(e);var r=new c((function(t,r){n.ready().then((function(){D(n._dbInfo,y,(function(i,o){if(i)return r(i);try{var s=o.objectStore(n._dbInfo.storeName).delete(e);o.oncomplete=function(){t()},o.onerror=function(){r(s.error)},o.onabort=function(){var e=s.error?s.error:s.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return u(r,t),r}function B(e){var t=this,n=new c((function(e,n){t.ready().then((function(){D(t._dbInfo,y,(function(r,i){if(r)return n(r);try{var o=i.objectStore(t._dbInfo.storeName).clear();i.oncomplete=function(){e()},i.onabort=i.onerror=function(){var e=o.error?o.error:o.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return u(n,e),n}function W(e){var t=this,n=new c((function(e,n){t.ready().then((function(){D(t._dbInfo,v,(function(r,i){if(r)return n(r);try{var o=i.objectStore(t._dbInfo.storeName).count();o.onsuccess=function(){e(o.result)},o.onerror=function(){n(o.error)}}catch(e){n(e)}}))})).catch(n)}));return u(n,e),n}function U(e,t){var n=this,r=new c((function(t,r){e<0?t(null):n.ready().then((function(){D(n._dbInfo,v,(function(i,o){if(i)return r(i);try{var s=o.objectStore(n._dbInfo.storeName),a=!1,l=s.openKeyCursor();l.onsuccess=function(){var n=l.result;n?0===e||a?t(n.key):(a=!0,n.advance(e)):t(null)},l.onerror=function(){r(l.error)}}catch(e){r(e)}}))})).catch(r)}));return u(r,t),r}function H(e){var t=this,n=new c((function(e,n){t.ready().then((function(){D(t._dbInfo,v,(function(r,i){if(r)return n(r);try{var o=i.objectStore(t._dbInfo.storeName).openKeyCursor(),s=[];o.onsuccess=function(){var t=o.result;t?(s.push(t.key),t.continue()):e(s)},o.onerror=function(){n(o.error)}}catch(e){n(e)}}))})).catch(n)}));return u(n,e),n}function V(e,t){t=f.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,i=this;if(e.name){var o=e.name===n.name&&i._dbInfo.db?c.resolve(i._dbInfo.db):S(e).then((function(t){var n=_[e.name],r=n.forages;n.db=t;for(var i=0;i<r.length;i++)r[i]._dbInfo.db=t;return t}));r=e.storeName?o.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var n=t.version+1;x(e);var r=_[e.name],i=r.forages;t.close();for(var o=0;o<i.length;o++){var a=i[o];a._dbInfo.db=null,a._dbInfo.version=n}var l=new c((function(t,r){var i=s.open(e.name,n);i.onerror=function(e){i.result.close(),r(e)},i.onupgradeneeded=function(){i.result.deleteObjectStore(e.storeName)},i.onsuccess=function(){var e=i.result;e.close(),t(e)}}));return l.then((function(e){r.db=e;for(var t=0;t<i.length;t++){var n=i[t];n._dbInfo.db=e,k(n._dbInfo)}})).catch((function(t){throw(E(e,t)||c.resolve()).catch((function(){})),t}))}})):o.then((function(t){x(e);var n=_[e.name],r=n.forages;t.close();for(var i=0;i<r.length;i++)r[i]._dbInfo.db=null;var o=new c((function(t,n){var r=s.deleteDatabase(e.name);r.onerror=function(){var e=r.result;e&&e.close(),n(r.error)},r.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},r.onsuccess=function(){var e=r.result;e&&e.close(),t(e)}}));return o.then((function(e){n.db=e;for(var t=0;t<r.length;t++)k(r[t]._dbInfo)})).catch((function(t){throw(E(e,t)||c.resolve()).catch((function(){})),t}))}))}else r=c.reject("Invalid arguments");return u(r,t),r}var G={_driver:"asyncStorage",_initStorage:$,_support:a(),iterate:q,getItem:F,setItem:j,removeItem:z,clear:B,length:W,key:U,keys:H,dropInstance:V};function Y(){return"function"==typeof openDatabase}var K="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",X="~~local_forage_type~",Q=/^~~local_forage_type~([^~]+)~/,J="__lfsc__:",Z=J.length,ee="arbf",te="blob",ne="si08",re="ui08",ie="uic8",oe="si16",se="si32",ae="ur16",le="ui32",ce="fl32",ue="fl64",he=Z+ee.length,de=Object.prototype.toString;function fe(e){var t,n,r,i,o,s=.75*e.length,a=e.length,l=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var c=new ArrayBuffer(s),u=new Uint8Array(c);for(t=0;t<a;t+=4)n=K.indexOf(e[t]),r=K.indexOf(e[t+1]),i=K.indexOf(e[t+2]),o=K.indexOf(e[t+3]),u[l++]=n<<2|r>>4,u[l++]=(15&r)<<4|i>>2,u[l++]=(3&i)<<6|63&o;return c}function pe(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=K[n[t]>>2],r+=K[(3&n[t])<<4|n[t+1]>>4],r+=K[(15&n[t+1])<<2|n[t+2]>>6],r+=K[63&n[t+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}function ge(e,t){var n="";if(e&&(n=de.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===de.call(e.buffer))){var r,i=J;e instanceof ArrayBuffer?(r=e,i+=ee):(r=e.buffer,"[object Int8Array]"===n?i+=ne:"[object Uint8Array]"===n?i+=re:"[object Uint8ClampedArray]"===n?i+=ie:"[object Int16Array]"===n?i+=oe:"[object Uint16Array]"===n?i+=ae:"[object Int32Array]"===n?i+=se:"[object Uint32Array]"===n?i+=le:"[object Float32Array]"===n?i+=ce:"[object Float64Array]"===n?i+=ue:t(new Error("Failed to get type for BinaryArray"))),t(i+pe(r))}else if("[object Blob]"===n){var o=new FileReader;o.onload=function(){var n=X+e.type+"~"+pe(this.result);t(J+te+n)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(n){console.error("Couldn't convert value into a JSON string: ",e),t(null,n)}}function _e(e){if(e.substring(0,Z)!==J)return JSON.parse(e);var t,n=e.substring(he),r=e.substring(Z,he);if(r===te&&Q.test(n)){var i=n.match(Q);t=i[1],n=n.substring(i[0].length)}var o=fe(n);switch(r){case ee:return o;case te:return l([o],{type:t});case ne:return new Int8Array(o);case re:return new Uint8Array(o);case ie:return new Uint8ClampedArray(o);case oe:return new Int16Array(o);case ae:return new Uint16Array(o);case se:return new Int32Array(o);case le:return new Uint32Array(o);case ce:return new Float32Array(o);case ue:return new Float64Array(o);default:throw new Error("Unkown type: "+r)}}var me={serialize:ge,deserialize:_e,stringToBuffer:fe,bufferToString:pe};function ve(e,t,n,r){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function ye(e){var t=this,n={db:null};if(e)for(var r in e)n[r]="string"!=typeof e[r]?e[r].toString():e[r];var i=new c((function(e,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(e){return r(e)}n.db.transaction((function(i){ve(i,n,(function(){t._dbInfo=n,e()}),(function(e,t){r(t)}))}),r)}));return n.serializer=me,i}function we(e,t,n,r,i,o){e.executeSql(n,r,i,(function(e,s){s.code===s.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,a){a.rows.length?o(e,s):ve(e,t,(function(){e.executeSql(n,r,i,o)}),o)}),o):o(e,s)}),o)}function be(e,t){var n=this;e=d(e);var r=new c((function(t,r){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){we(n,i,"SELECT * FROM "+i.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=i.serializer.deserialize(r)),t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,t),r}function Ce(e,t){var n=this,r=new c((function(t,r){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){we(n,i,"SELECT * FROM "+i.storeName,[],(function(n,r){for(var o=r.rows,s=o.length,a=0;a<s;a++){var l=o.item(a),c=l.value;if(c&&(c=i.serializer.deserialize(c)),void 0!==(c=e(c,l.key,a+1)))return void t(c)}t()}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,t),r}function xe(e,t,n,r){var i=this;e=d(e);var o=new c((function(o,s){i.ready().then((function(){void 0===t&&(t=null);var a=t,l=i._dbInfo;l.serializer.serialize(t,(function(t,c){c?s(c):l.db.transaction((function(n){we(n,l,"INSERT OR REPLACE INTO "+l.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){o(a)}),(function(e,t){s(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(r>0)return void o(xe.apply(i,[e,a,n,r-1]));s(t)}}))}))})).catch(s)}));return u(o,n),o}function ke(e,t,n){return xe.apply(this,[e,t,n,1])}function Ee(e,t){var n=this;e=d(e);var r=new c((function(t,r){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){we(n,i,"DELETE FROM "+i.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,t),r}function Ie(e){var t=this,n=new c((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){we(t,r,"DELETE FROM "+r.storeName,[],(function(){e()}),(function(e,t){n(t)}))}))})).catch(n)}));return u(n,e),n}function Se(e){var t=this,n=new c((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){we(t,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],(function(t,n){var r=n.rows.item(0).c;e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return u(n,e),n}function Te(e,t){var n=this,r=new c((function(t,r){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){we(n,i,"SELECT key FROM "+i.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,t),r}function Ne(e){var t=this,n=new c((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){we(t,r,"SELECT key FROM "+r.storeName,[],(function(t,n){for(var r=[],i=0;i<n.rows.length;i++)r.push(n.rows.item(i).key);e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return u(n,e),n}function Re(e){return new c((function(t,n){e.transaction((function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(n,r){for(var i=[],o=0;o<r.rows.length;o++)i.push(r.rows.item(o).name);t({db:e,storeNames:i})}),(function(e,t){n(t)}))}),(function(e){n(e)}))}))}function Pe(e,t){t=f.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,i=this;return r=e.name?new c((function(t){var r;r=e.name===n.name?i._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:r,storeNames:[e.storeName]}):t(Re(r))})).then((function(e){return new c((function(t,n){e.db.transaction((function(r){function i(e){return new c((function(t,n){r.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){n(t)}))}))}for(var o=[],s=0,a=e.storeNames.length;s<a;s++)o.push(i(e.storeNames[s]));c.all(o).then((function(){t()})).catch((function(e){n(e)}))}),(function(e){n(e)}))}))})):c.reject("Invalid arguments"),u(r,t),r}var Me={_driver:"webSQLStorage",_initStorage:ye,_support:Y(),iterate:Ce,getItem:be,setItem:ke,removeItem:Ee,clear:Ie,length:Se,key:Te,keys:Ne,dropInstance:Pe};function Ae(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function Oe(e,t){var n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}function De(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(e){return!0}}function Le(){return!De()||localStorage.length>0}function $e(e){var t=this,n={};if(e)for(var r in e)n[r]=e[r];return n.keyPrefix=Oe(e,t._defaultConfig),Le()?(t._dbInfo=n,n.serializer=me,c.resolve()):c.reject()}function Fe(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(e)&&localStorage.removeItem(r)}}));return u(n,e),n}function qe(e,t){var n=this;e=d(e);var r=n.ready().then((function(){var t=n._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r}));return u(r,t),r}function je(e,t){var n=this,r=n.ready().then((function(){for(var t=n._dbInfo,r=t.keyPrefix,i=r.length,o=localStorage.length,s=1,a=0;a<o;a++){var l=localStorage.key(a);if(0===l.indexOf(r)){var c=localStorage.getItem(l);if(c&&(c=t.serializer.deserialize(c)),void 0!==(c=e(c,l.substring(i),s++)))return c}}}));return u(r,t),r}function ze(e,t){var n=this,r=n.ready().then((function(){var t,r=n._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t}));return u(r,t),r}function Be(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo,n=localStorage.length,r=[],i=0;i<n;i++){var o=localStorage.key(i);0===o.indexOf(e.keyPrefix)&&r.push(o.substring(e.keyPrefix.length))}return r}));return u(n,e),n}function We(e){var t=this.keys().then((function(e){return e.length}));return u(t,e),t}function Ue(e,t){var n=this;e=d(e);var r=n.ready().then((function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return u(r,t),r}function He(e,t,n){var r=this;e=d(e);var i=r.ready().then((function(){void 0===t&&(t=null);var n=t;return new c((function(i,o){var s=r._dbInfo;s.serializer.serialize(t,(function(t,r){if(r)o(r);else try{localStorage.setItem(s.keyPrefix+e,t),i(n)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||o(e),o(e)}}))}))}));return u(i,n),i}function Ve(e,t){if(t=f.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var n=this.config();e.name=e.name||n.name,e.storeName=e.storeName||n.storeName}var r,i=this;return r=e.name?new c((function(t){e.storeName?t(Oe(e,i._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}})):c.reject("Invalid arguments"),u(r,t),r}var Ge={_driver:"localStorageWrapper",_initStorage:$e,_support:Ae(),iterate:je,getItem:qe,setItem:He,removeItem:Ue,clear:Fe,length:We,key:ze,keys:Be,dropInstance:Ve},Ye=function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},Ke=function(e,t){for(var n=e.length,r=0;r<n;){if(Ye(e[r],t))return!0;r++}return!1},Xe=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Qe={},Je={},Ze={INDEXEDDB:G,WEBSQL:Me,LOCALSTORAGE:Ge},et=[Ze.INDEXEDDB._driver,Ze.WEBSQL._driver,Ze.LOCALSTORAGE._driver],tt=["dropInstance"],nt=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(tt),rt={description:"",driver:et.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function it(e,t){e[t]=function(){var n=arguments;return e.ready().then((function(){return e[t].apply(e,n)}))}}function ot(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(Xe(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}var st=function(){function e(t){for(var n in i(this,e),Ze)if(Ze.hasOwnProperty(n)){var r=Ze[n],o=r._driver;this[n]=o,Qe[o]||this.defineDriver(r)}this._defaultConfig=ot({},rt),this._config=ot({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":r(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var r=new c((function(t,n){try{var r=e._driver,i=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void n(i);for(var o=nt.concat("_initStorage"),s=0,a=o.length;s<a;s++){var l=o[s];if((!Ke(tt,l)||e[l])&&"function"!=typeof e[l])return void n(i)}var h=function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),n=c.reject(t);return u(n,arguments[arguments.length-1]),n}},n=0,r=tt.length;n<r;n++){var i=tt[n];e[i]||(e[i]=t(i))}};h();var d=function(n){Qe[r]&&console.info("Redefining LocalForage driver: "+r),Qe[r]=e,Je[r]=n,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(d,n):d(!!e._support):d(!0)}catch(e){n(e)}}));return h(r,t,n),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var r=Qe[e]?c.resolve(Qe[e]):c.reject(new Error("Driver not found."));return h(r,t,n),r},e.prototype.getSerializer=function(e){var t=c.resolve(me);return h(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return h(n,e,e),n},e.prototype.setDriver=function(e,t,n){var r=this;Xe(e)||(e=[e]);var i=this._getSupportedDrivers(e);function o(){r._config.driver=r.driver()}function s(e){return r._extend(e),o(),r._ready=r._initStorage(r._config),r._ready}function a(e){return function(){var t=0;function n(){for(;t<e.length;){var i=e[t];return t++,r._dbInfo=null,r._ready=null,r.getDriver(i).then(s).catch(n)}o();var a=new Error("No available storage method found.");return r._driverSet=c.reject(a),r._driverSet}return n()}}var l=null!==this._driverSet?this._driverSet.catch((function(){return c.resolve()})):c.resolve();return this._driverSet=l.then((function(){var e=i[0];return r._dbInfo=null,r._ready=null,r.getDriver(e).then((function(e){r._driver=e._driver,o(),r._wrapLibraryMethodsWithReady(),r._initDriver=a(i)}))})).catch((function(){o();var e=new Error("No available storage method found.");return r._driverSet=c.reject(e),r._driverSet})),h(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!Je[e]},e.prototype._extend=function(e){ot(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];this.supports(i)&&t.push(i)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=nt.length;e<t;e++)it(this,nt[e])},e.prototype.createInstance=function(t){return new e(t)},e}(),at=new st;t.exports=at},{3:3}]},{},[4])(4)},Kd(Xd={exports:{}},Xd.exports),Xd.exports);async function Jd(){let e=await document.querySelector("#webgazerVideoContainer");return await document.querySelector("body").append(e),await webgazer.pause(),await webgazer.showVideo(!1)}async function Zd(){if(webgazer.isReady()){console.log("gazer fully loaded"),webgazer.pause(),webgazer.setVideoViewerSize(300,300);let e=document.querySelector("#webgazerVideoContainer");document.querySelector(".container-body").append(e),Ie.set(!0),console.log("gazer initialized")}else await setTimeout(Zd,100)}function ef(){document.querySelector("#webgazerGazeDot").style.opacity=0}function tf(){webgazer.setGazeListener((function(e,t){if(null==e)return;let n=h(xe);n.push({x:e.x,y:e.y}),xe.set(n)})),setTimeout((()=>{webgazer.clearGazeListener(),function(){let e=document.querySelector(".center-dot").getBoundingClientRect(),t=0,n=h(xe);n.map((n=>{let r=n.x-e.x+e.width/2,i=n.y-e.y+e.height/2,o=Math.sqrt(i*i+r*r);return t+=o,o}));let r=100*(1-t/n.length/(document.querySelector(".container-body").getBoundingClientRect().width/2));console.log(r),Qd.setItem("calibrationPct",Math.round(r)),Te.set(Math.round(r))}()}),4e3)}function nf(){webgazer.removeMouseEventListeners()}function rf(t){let n,r,i;return{c(){n=I("div"),n.innerHTML="<span>Close</span>",P(n,"class","clickable svelte-qlaqgs")},m(e,o){x(e,n,o),r||(i=R(n,"click",t[5]),r=!0)},p:e,d(e){e&&k(n),r=!1,i()}}}function of(t){let n,r,i;return{c(){n=I("div"),n.innerHTML='<span>Next</span> \n        <span class="material-icons-round svelte-qlaqgs">navigate_next</span>',P(n,"class","clickable svelte-qlaqgs")},m(e,o){x(e,n,o),r||(i=R(n,"click",t[4]),r=!0)},p:e,d(e){e&&k(n),r=!1,i()}}}function sf(t){let n,r,i,o,s,a,l,c,u,h,d,f,p,g,_,m,v=t[2][t[1]]+"",y=t[1]+1+"",b=t[2].length+"";function C(e,t){return e[1]<e[2].length-1?of:rf}let E=C(t),N=E(t);return{c(){n=I("div"),r=I("div"),i=I("p"),o=S(v),s=T(),a=I("nav"),l=I("div"),l.innerHTML='<span class="material-icons-round svelte-qlaqgs">navigate_before</span> \n      <span>Prev</span>',c=T(),u=I("div"),h=S("Tip "),d=S(y),f=S(" of "),p=S(b),g=T(),N.c(),P(r,"class","text-upper svelte-qlaqgs"),P(l,"class","clickable svelte-qlaqgs"),L(l,"disabled",0==t[1]),P(a,"class","svelte-qlaqgs"),P(n,"class","hint-holder svelte-qlaqgs"),O(n,"top",t[0][t[1]][1]+"px"),O(n,"left",t[0][t[1]][0]+"px")},m(e,v){x(e,n,v),w(n,r),w(r,i),w(i,o),w(n,s),w(n,a),w(a,l),w(a,c),w(a,u),w(u,h),w(u,d),w(u,f),w(u,p),w(a,g),N.m(a,null),_||(m=R(l,"click",t[3]),_=!0)},p(e,[t]){2&t&&v!==(v=e[2][e[1]]+"")&&M(o,v),2&t&&L(l,"disabled",0==e[1]),2&t&&y!==(y=e[1]+1+"")&&M(d,y),E===(E=C(e))&&N?N.p(e,t):(N.d(1),N=E(e),N&&(N.c(),N.m(a,null))),3&t&&O(n,"top",e[0][e[1]][1]+"px"),3&t&&O(n,"left",e[0][e[1]][0]+"px")},i:e,o:e,d(e){e&&k(n),N.d(),_=!1,m()}}}function af(e,t,n){let r;d(e,je,(e=>n(1,r=e)));let{helperTextPositions:i}=t;return e.$$set=e=>{"helperTextPositions"in e&&n(0,i=e.helperTextPositions)},[i,r,["We’re currently visualizing a single gaze. Use the controls below to switch between different viewers' gazes.","Filter between different views above. The ‘animate’ option allows you to play black a viewing session, while ‘aggregate’ shows a single static summary. And lastly, ‘original’ shows the original image, sans gaze.","Are you curious to see what your own gaze would look like? Contribute to the gallery and add your own gaze!"],()=>{f(je,r--,r)},()=>{f(je,r++,r)},()=>{f(je,r=-1,r)}]}class lf extends me{constructor(e){super(),_e(this,e,af,sf,a,{helperTextPositions:0})}}var cf={$:e=>"string"==typeof e?document.querySelector(e):e,extend:(...e)=>Object.assign(...e),cumulativeOffset(e){let t=0,n=0;do{t+=e.offsetTop||0,n+=e.offsetLeft||0,e=e.offsetParent}while(e);return{top:t,left:n}},directScroll:e=>e&&e!==document&&e!==document.body,scrollTop(e,t){let n=void 0!==t;return this.directScroll(e)?n?e.scrollTop=t:e.scrollTop:n?document.documentElement.scrollTop=document.body.scrollTop=t:window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},scrollLeft(e,t){let n=void 0!==t;return this.directScroll(e)?n?e.scrollLeft=t:e.scrollLeft:n?document.documentElement.scrollLeft=document.body.scrollLeft=t:window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0}};const uf={container:"body",duration:500,delay:0,offset:0,easing:function(e){return e<.5?4*e*e*e:.5*Math.pow(2*e-2,3)+1},onStart:e,onDone:e,onAborting:e,scrollX:!1,scrollY:!0},hf=e=>{let{offset:t,duration:n,delay:r,easing:i,x:o=0,y:s=0,scrollX:a,scrollY:l,onStart:c,onDone:u,container:h,onAborting:d,element:f}=e;"function"==typeof t&&(t=t());var p=cf.cumulativeOffset(h),_=f?cf.cumulativeOffset(f):{top:s,left:o},m=cf.scrollLeft(h),v=cf.scrollTop(h),w=_.left-p.left+t,b=_.top-p.top+t,C=w-m,x=b-v;let k=!0,E=!1,I=g()+r,S=I+n;function T(e){e||(E=!0,c(f,{x:o,y:s}))}function N(e){!function(e,t,n){a&&cf.scrollLeft(e,n),l&&cf.scrollTop(e,t)}(h,v+x*e,m+C*e)}function R(){k=!1}return y((e=>{if(!E&&e>=I&&T(!1),E&&e>=S&&(N(1),R(),u(f,{x:o,y:s})),!k)return d(f,{x:o,y:s}),!1;if(E){N(0+1*i((e-I)/n))}return!0})),T(r),N(0),R},df=e=>hf((e=>{let t=cf.extend({},uf,e);return t.container=cf.$(t.container),t.element=cf.$(t.element),t})(e));var ff;ff={offset:-60},cf.extend(uf,ff||{});var pf=e=>{let t=document.querySelector("#"+e);df({element:t})};function gf(e,t,n){const r=e.slice();return r[49]=t[n],r[51]=n,r}function _f(e,t,n){const r=e.slice();return r[52]=t[n],r}function mf(e){let t,n,r,i;return n=new Hd({}),{c(){t=I("div"),de(n.$$.fragment)},m(e,r){x(e,t,r),fe(n,t,null),i=!0},i(e){i||(ae(n.$$.fragment,e),X((()=>{r||(r=ue(t,Ue,{duration:200},!0)),r.run(1)})),i=!0)},o(e){le(n.$$.fragment,e),r||(r=ue(t,Ue,{duration:200},!1)),r.run(0),i=!1},d(e){e&&k(t),pe(n),e&&r&&r.end()}}}function vf(e){let t,n;return t=new lf({props:{helperTextPositions:e[19]}}),{c(){de(t.$$.fragment)},m(e,r){fe(t,e,r),n=!0},p(e,n){const r={};524288&n[0]&&(r.helperTextPositions=e[19]),t.$set(r)},i(e){n||(ae(t.$$.fragment,e),n=!0)},o(e){le(t.$$.fragment,e),n=!1},d(e){pe(t,e)}}}function yf(t){let n,r,i;return{c(){n=I("div"),n.innerHTML='<span class="material-icons-round md-14 svelte-1mxsgxc" style="font-size: 24px; color: #bfb9b9">info</span>',P(n,"class","clickable svelte-1mxsgxc")},m(e,o){x(e,n,o),r||(i=R(n,"click",t[23]),r=!0)},p:e,d(e){e&&k(n),r=!1,i()}}}function wf(e){let t,n,r;return{c(){t=I("span"),t.textContent="Pause",P(t,"class","play-toggle svelte-1mxsgxc")},m(e,i){x(e,t,i),n||(r=R(t,"click",Tf),n=!0)},d(e){e&&k(t),n=!1,r()}}}function bf(e){let t,n,r;return{c(){t=I("span"),t.textContent="Animate",P(t,"class","play-toggle svelte-1mxsgxc")},m(e,i){x(e,t,i),n||(r=R(t,"click",Sf),n=!0)},d(e){e&&k(t),n=!1,r()}}}function Cf(t){let n,r,i,s;return{c(){n=I("div"),r=I("div"),r.innerHTML="<span>Add Gaze</span>",P(r,"class","filter clickable add svelte-1mxsgxc"),P(n,"class","filter-options svelte-1mxsgxc")},m(e,o){x(e,n,o),w(n,r),t[30](r),i||(s=[R(r,"mouseover",t[31]),R(r,"mousemove",t[32]),R(r,"mouseleave",t[33]),R(r,"click",t[34])],i=!0)},p:e,d(e){e&&k(n),t[30](null),i=!1,o(s)}}}function xf(e){let t,n=e[10],r=[];for(let t=0;t<n.length;t+=1)r[t]=kf(_f(e,n,t));return{c(){t=I("div");for(let e=0;e<r.length;e+=1)r[e].c()},m(n,i){x(n,t,i);for(let e=0;e<r.length;e+=1)r[e].m(t,null);e[35](t)},p(e,i){if(1025&i[0]){let o;for(n=e[10],o=0;o<n.length;o+=1){const s=_f(e,n,o);r[o]?r[o].p(s,i):(r[o]=kf(s),r[o].c(),r[o].m(t,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length}},d(n){n&&k(t),E(r,n),e[35](null)}}}function kf(e){let t,n;return{c(){t=I("img"),P(t,"class","clip svelte-1mxsgxc"),O(t,"clip-path","circle("+e[52].r+"% at "+e[52].ctrx+"% "+e[52].ctry+"%)"),O(t,"filter","blur("+e[52].blur+"px)"),O(t,"opacity","$"+e[52].opacity),c(t.src,n=e[0].url)||P(t,"src",n)},m(e,n){x(e,t,n)},p(e,r){1024&r[0]&&O(t,"clip-path","circle("+e[52].r+"% at "+e[52].ctrx+"% "+e[52].ctry+"%)"),1024&r[0]&&O(t,"filter","blur("+e[52].blur+"px)"),1024&r[0]&&O(t,"opacity","$"+e[52].opacity),1&r[0]&&!c(t.src,n=e[0].url)&&P(t,"src",n)},d(e){e&&k(t)}}}function Ef(e){let t,n,r,i,o,s,a,l,c,u,h,d,f,p=e[4][e[49]].name+"",g=e[51]+1+"",_=e[16].length+"";return{c(){t=I("option"),n=I("span"),r=S(p),i=S("'s Gaze"),o=T(),s=I("span"),a=S("("),l=S(g),c=S(" of "),u=S(_),h=S(")"),d=T(),O(n,"font-weight","600"),O(n,"color","black"),O(s,"font-weight","400"),O(s,"color","gray"),t.__value=f=e[49],t.value=t.__value},m(e,f){x(e,t,f),w(t,n),w(n,r),w(n,i),w(t,o),w(t,s),w(s,a),w(s,l),w(s,c),w(s,u),w(s,h),w(t,d)},p(e,n){65552&n[0]&&p!==(p=e[4][e[49]].name+"")&&M(r,p),65536&n[0]&&_!==(_=e[16].length+"")&&M(u,_),65536&n[0]&&f!==(f=e[49])&&(t.__value=f,t.value=t.__value)},d(e){e&&k(t)}}}function If(e){let t,n,r,i,s,a,l,u,h,d,f,p,g,_,m,v,y,b,C,N,$,F,q,j,z,B,W,U,H,V,G,Y,K,Q,J,Z,ee,te,ne,re,ie,ce,ue,he,de,fe,pe,ge=e[0].artist+"",_e=e[0].title+"",me=e[21]&&mf(),ve=e[12]>=0&&vf(e),ye=e[20]>800&&yf(e);function we(e,t){return"pause"==e[9]?bf:wf}let be=we(e),Ce=be(e),xe=e[20]>950&&Cf(e),ke="slice"==e[8]&&xf(e),Ee=e[16],Ie=[];for(let t=0;t<Ee.length;t+=1)Ie[t]=Ef(gf(e,Ee,t));return{c(){me&&me.c(),t=T(),n=I("div"),ve&&ve.c(),r=T(),i=I("div"),s=I("h2"),a=I("div"),a.textContent="Gaze Collection",l=T(),u=I("div"),h=S(ge),d=S(", "),f=I("i"),p=S(_e),g=T(),ye&&ye.c(),_=T(),m=I("div"),v=I("div"),y=I("div"),b=I("div"),Ce.c(),C=T(),N=I("span"),$=I("input"),F=T(),q=I("div"),q.innerHTML="<span>Aggregate</span>",j=T(),z=I("div"),z.innerHTML="<span>Original</span>",B=T(),W=I("div"),xe&&xe.c(),U=T(),H=I("div"),V=I("div"),G=I("img"),K=T(),Q=function(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}("svg"),Z=T(),ke&&ke.c(),ee=T(),te=I("div"),ne=I("div"),ne.innerHTML='<span class="material-icons-round md-18 nav svelte-1mxsgxc" style="font-size: 26px">arrow_left</span> \n        <span>Prev</span>',re=T(),ie=I("select");for(let e=0;e<Ie.length;e+=1)Ie[e].c();ce=T(),ue=I("div"),ue.innerHTML='<span>Next</span> \n        <span class="material-icons-round md-18 nav svelte-1mxsgxc" style="font-size: 26px">arrow_right</span>',O(a,"font-weight","400"),O(a,"color","rgb(126 123 123)"),O(a,"margin-right","15px"),P(f,"class","svelte-1mxsgxc"),O(s,"display","flex"),O(s,"align-items","center"),P(s,"class","svelte-1mxsgxc"),P(i,"class","card-header svelte-1mxsgxc"),P($,"type","range"),P($,"id","slider"),P($,"name","slider"),P($,"min","0"),P($,"max",e[18]),P($,"step","1"),P($,"class","svelte-1mxsgxc"),P(N,"id","slider-holder"),P(N,"class","svelte-1mxsgxc"),P(b,"class","filter time clickable svelte-1mxsgxc"),L(b,"selected","slice"==e[8]),P(q,"class","filter clickable svelte-1mxsgxc"),L(q,"selected","aggregate"==e[8]),P(z,"class","filter clickable svelte-1mxsgxc"),L(z,"selected","original"==e[8]),P(y,"class","filter-options svelte-1mxsgxc"),P(v,"class","visual-filter filter-group svelte-1mxsgxc"),L(v,"info-highlight",1==e[12]),P(W,"class","viewer-filter filter-group svelte-1mxsgxc"),L(W,"info-highlight",2==e[12]),P(m,"class","card-filters svelte-1mxsgxc"),c(G.src,Y=e[0].url)||P(G,"src",Y),P(G,"style",e[15]),P(G,"class","main svelte-1mxsgxc"),L(G,"slice","slice"==e[8]),L(G,"agg","aggregate"==e[8]),P(Q,"class","contour svelte-1mxsgxc"),P(Q,"id",J=e[0].key+"-contour"),O(Q,"width","100%"),O(Q,"height","100%"),O(Q,"position","absolute"),O(Q,"top","0"),O(Q,"left","0"),O(Q,"z-index","10"),L(Q,"active","aggregate"==e[8]),P(V,"class","img-holder svelte-1mxsgxc"),O(V,"width",e[13]),O(V,"height",e[14]),O(V,"max-width",e[0].width+"px"),O(V,"max-height",e[0].height+"px"),P(ne,"class","arrow-nav clickable svelte-1mxsgxc"),L(ne,"disabled",0==e[17]),P(ie,"class","clickable svelte-1mxsgxc"),void 0===e[1]&&X((()=>e[37].call(ie))),P(ue,"class","clickable arrow-nav svelte-1mxsgxc"),L(ue,"disabled",e[17]==e[16].length-1),P(te,"class","filter person svelte-1mxsgxc"),L(te,"info-highlight",0==e[12]),P(H,"class","center svelte-1mxsgxc"),P(n,"class","card-outer svelte-1mxsgxc"),P(n,"id",he=e[0].key),L(n,"active",e[0].key==e[22])},m(o,c){me&&me.m(o,c),x(o,t,c),x(o,n,c),ve&&ve.m(n,null),w(n,r),w(n,i),w(i,s),w(s,a),w(s,l),w(s,u),w(u,h),w(u,d),w(u,f),w(f,p),w(i,g),ye&&ye.m(i,null),w(n,_),w(n,m),w(m,v),w(v,y),w(y,b),Ce.m(b,null),w(b,C),w(b,N),w(N,$),A($,e[3]),w(y,F),w(y,q),w(y,j),w(y,z),e[29](v),w(m,B),w(m,W),xe&&xe.m(W,null),w(n,U),w(n,H),w(H,V),w(V,G),w(V,K),w(V,Q),w(V,Z),ke&&ke.m(V,null),w(H,ee),w(H,te),w(te,ne),w(te,re),w(te,ie);for(let e=0;e<Ie.length;e+=1)Ie[e].m(ie,null);D(ie,e[1]),e[38](ie),w(te,ce),w(te,ue),de=!0,fe||(pe=[R($,"input",e[24]),R($,"change",e[25]),R($,"input",e[25]),R(b,"click",e[26]),R(q,"click",e[27]),R(z,"click",e[28]),R(ne,"click",e[36]),R(ie,"change",e[37]),R(ue,"click",e[39])],fe=!0)},p(e,o){if(e[21]?me?2097152&o[0]&&ae(me,1):(me=mf(),me.c(),ae(me,1),me.m(t.parentNode,t)):me&&(oe(),le(me,1,1,(()=>{me=null})),se()),e[12]>=0?ve?(ve.p(e,o),4096&o[0]&&ae(ve,1)):(ve=vf(e),ve.c(),ae(ve,1),ve.m(n,r)):ve&&(oe(),le(ve,1,1,(()=>{ve=null})),se()),(!de||1&o[0])&&ge!==(ge=e[0].artist+"")&&M(h,ge),(!de||1&o[0])&&_e!==(_e=e[0].title+"")&&M(p,_e),e[20]>800?ye?ye.p(e,o):(ye=yf(e),ye.c(),ye.m(i,null)):ye&&(ye.d(1),ye=null),be!==(be=we(e))&&(Ce.d(1),Ce=be(e),Ce&&(Ce.c(),Ce.m(b,C))),(!de||262144&o[0])&&P($,"max",e[18]),8&o[0]&&A($,e[3]),256&o[0]&&L(b,"selected","slice"==e[8]),256&o[0]&&L(q,"selected","aggregate"==e[8]),256&o[0]&&L(z,"selected","original"==e[8]),4096&o[0]&&L(v,"info-highlight",1==e[12]),e[20]>950?xe?xe.p(e,o):(xe=Cf(e),xe.c(),xe.m(W,null)):xe&&(xe.d(1),xe=null),4096&o[0]&&L(W,"info-highlight",2==e[12]),(!de||1&o[0]&&!c(G.src,Y=e[0].url))&&P(G,"src",Y),(!de||32768&o[0])&&P(G,"style",e[15]),256&o[0]&&L(G,"slice","slice"==e[8]),256&o[0]&&L(G,"agg","aggregate"==e[8]),(!de||1&o[0]&&J!==(J=e[0].key+"-contour"))&&P(Q,"id",J),256&o[0]&&L(Q,"active","aggregate"==e[8]),"slice"==e[8]?ke?ke.p(e,o):(ke=xf(e),ke.c(),ke.m(V,null)):ke&&(ke.d(1),ke=null),(!de||8192&o[0])&&O(V,"width",e[13]),(!de||16384&o[0])&&O(V,"height",e[14]),(!de||1&o[0])&&O(V,"max-width",e[0].width+"px"),(!de||1&o[0])&&O(V,"max-height",e[0].height+"px"),131072&o[0]&&L(ne,"disabled",0==e[17]),65552&o[0]){let t;for(Ee=e[16],t=0;t<Ee.length;t+=1){const n=gf(e,Ee,t);Ie[t]?Ie[t].p(n,o):(Ie[t]=Ef(n),Ie[t].c(),Ie[t].m(ie,null))}for(;t<Ie.length;t+=1)Ie[t].d(1);Ie.length=Ee.length}2&o[0]&&D(ie,e[1]),196608&o[0]&&L(ue,"disabled",e[17]==e[16].length-1),4096&o[0]&&L(te,"info-highlight",0==e[12]),(!de||1&o[0]&&he!==(he=e[0].key))&&P(n,"id",he),4194305&o[0]&&L(n,"active",e[0].key==e[22])},i(e){de||(ae(me),ae(ve),de=!0)},o(e){le(me),le(ve),de=!1},d(r){me&&me.d(r),r&&k(t),r&&k(n),ve&&ve.d(),ye&&ye.d(),Ce.d(),e[29](null),xe&&xe.d(),ke&&ke.d(),E(Ie,r),e[38](null),fe=!1,o(pe)}}}const Sf=()=>{},Tf=()=>{};function Nf(e,t,n){let r,i,o,s,a;d(e,je,(e=>n(12,r=e))),d(e,Ae,(e=>n(20,i=e))),d(e,Oe,(e=>n(42,o=e))),d(e,$e,(e=>n(21,s=e))),d(e,De,(e=>n(22,a=e)));let l,c,{data:u}=t,h=Math.min(i-500,1e3),f=o-250,p="auto",g="auto",_="";u.dimWidthToHt<1?(g=f+"px",_="height: 100%"):(p=h+"px",_="width: 100%");let m=0,v=[];u.sessionData&&(v=u.sessionData);let y=[];v&&(y=Object.keys(v));let w=y.length-1;async function b(e){n(2,c=await sa("sessionData/"+e)),console.log(u,c),function(){n(10,M=[]);let e=10,t=10,r=(20-t)/e,i=6/e,o=1/e;for(let n=e;n>0;n--){let s=r*n+t,a=i*n,l=o*(e-n);M.push({class:"clip",r:s,ctrx:c[0].xPct,ctry:c[0].yPct,blur:a,opacity:l,src:u.url})}}(),c&&n(3,m=0)}l=y[w];let C,x,k,E=100,I=[[],[0,0],[0,0]];function S(e,t){let r,o;r=Math.min(t.x,i-450),o=0==e?t.y-130:t.y+50,n(19,I[e]=[r,o],I)}let T,N,R="slice",P="pause",M=[];return e.$$set=e=>{"data"in e&&n(0,u=e.data)},e.$$.update=()=>{var t,r;18&e.$$.dirty[0]&&b(l),261&e.$$.dirty[0]&&(c&&n(18,E=c.length),"aggregate"==R&&Bd(c,`#${u.key} .img-holder`,`#${u.key}-contour`,u.url)),224&e.$$.dirty[0]&&C&&x&&k&&(S(0,C.getBoundingClientRect()),S(1,x.getBoundingClientRect()),S(2,k.getBoundingClientRect())),524&e.$$.dirty[0]&&("play"==P&&m<c.length-1?setTimeout((()=>{n(3,m++,m)}),50):"play"==P&&m==c.length-1&&n(9,P="pause")),12&e.$$.dirty[0]&&c&&(t=c[m].xPct,r=c[m].yPct,N.forEach((e=>{let n=e.style["clip-path"].split("at ")[0],i=`at ${t}% ${r}%)`;e.style["clip-path"]=n+i}))),2048&e.$$.dirty[0]&&T&&(N=T.childNodes),e.$$.dirty[0],e.$$.dirty[0]},[u,l,c,m,v,C,x,k,R,P,M,T,r,p,g,_,y,w,E,I,i,s,a,()=>{pf(u.key),je.set(0)},()=>{n(8,R="slice")},function(){var e;e=this.value,m=""===e?null:+e,n(3,m),n(9,P),n(2,c)},()=>{"pause"==P?(n(8,R="slice"),m==c.length-1&&n(3,m=0),n(9,P="play")):"slice"==R&&"pause"!==P&&n(9,P="pause")},()=>{n(9,P="pause"),n(8,R="aggregate"),Bd(c,`#${u.key} .img-holder`,`#${u.key}-contour`,u.url)},()=>{n(8,R="original")},function(e){H[e?"unshift":"push"]((()=>{x=e,n(6,x)}))},function(e){H[e?"unshift":"push"]((()=>{k=e,n(7,k)}))},e=>{Vd(e.x,e.y,"Add your gaze to the collection")},e=>{Vd(e.x,e.y)},e=>{Vd()},()=>{Ce.set(u),we.set("record")},function(e){H[e?"unshift":"push"]((()=>{T=e,n(11,T)}))},()=>{n(17,w--,w),n(1,l=y[w])},function(){l=function(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}(this),n(1,l)},function(e){H[e?"unshift":"push"]((()=>{C=e,n(5,C),n(16,y)}))},()=>{n(17,w++,w),n(1,l=y[w])}]}class Rf extends me{constructor(e){super(),_e(this,e,Nf,If,a,{data:0},null,[-1,-1])}}let Pf=ye(null),Mf=ye(null);function Af(e,t,n){const r=e.slice();return r[5]=t[n],r}function Of(e){let t,n;return t=new Rf({props:{data:e[5]}}),{c(){de(t.$$.fragment)},m(e,r){fe(t,e,r),n=!0},p(e,n){const r={};1&n&&(r.data=e[5]),t.$set(r)},i(e){n||(ae(t.$$.fragment,e),n=!0)},o(e){le(t.$$.fragment,e),n=!1},d(e){pe(t,e)}}}function Df(e){let t,n,r,i,o=e[0],s=[];for(let t=0;t<o.length;t+=1)s[t]=Of(Af(e,o,t));const a=e=>le(s[e],1,1,(()=>{s[e]=null}));return{c(){t=I("div"),n=I("div"),n.innerHTML='<h2 class="svelte-10en3mr">Gaze Gallery</h2> \n    <p>Welcome to the Gallery. Each collection below visualizes how individuals\n      gazed at a particular piece of artwork. Study the existing gazes in this\n      gallery, or add your own.</p>',r=T();for(let e=0;e<s.length;e+=1)s[e].c();P(n,"class","card-outer svelte-10en3mr"),P(t,"class","card-holder svelte-10en3mr")},m(e,o){x(e,t,o),w(t,n),w(t,r);for(let e=0;e<s.length;e+=1)s[e].m(t,null);i=!0},p(e,[n]){if(1&n){let r;for(o=e[0],r=0;r<o.length;r+=1){const i=Af(e,o,r);s[r]?(s[r].p(i,n),ae(s[r],1)):(s[r]=Of(i),s[r].c(),ae(s[r],1),s[r].m(t,null))}for(oe(),r=o.length;r<s.length;r+=1)a(r);se()}},i(e){if(!i){for(let e=0;e<o.length;e+=1)ae(s[e]);i=!0}},o(e){s=s.filter(Boolean);for(let e=0;e<s.length;e+=1)le(s[e]);i=!1},d(e){e&&k(t),E(s,e)}}}function Lf(e,t,n){let r;d(e,Le,(e=>n(1,r=e)));let i=[],o=[];return async function(){await async function(){let e=await sa("works");e&&(n(0,i=Object.values(e)),o=Object.keys(e),Pf.set(o),Mf.set(i),De.set(o[0])),document.querySelector("body").className=""}(),window.addEventListener("scroll",(e=>{let t=window.innerHeight/2;document.querySelectorAll(".card-outer").forEach((e=>{let n=e.getBoundingClientRect();t>=n.top&&t<n.height+n.top&&De.set(e.id)}))}))}(),e.$$.update=()=>{2&e.$$.dirty&&pf(r)},[i,r]}class $f extends me{constructor(e){super(),_e(this,e,Lf,Df,a,{})}}function Ff(e){let t;return{c(){t=I("span"),t.textContent="Gaze",P(t,"class","header-sub accent svelte-1incu58"),L(t,"active","record"===e[0])},m(e,n){x(e,t,n)},p(e,n){1&n&&L(t,"active","record"===e[0])},d(e){e&&k(t)}}}function qf(e){let t;return{c(){t=I("span"),t.textContent="Gallery",P(t,"class","header-sub accent svelte-1incu58"),L(t,"active","gallery"===e[0])},m(e,n){x(e,t,n)},p(e,n){1&n&&L(t,"active","gallery"===e[0])},d(e){e&&k(t)}}}function jf(e){let t,n,r,i,s,a,l,c,u,h,d,f,p,g=e[1]>950&&zf();return{c(){t=I("nav"),n=I("div"),r=I("span"),r.textContent="keyboard_arrow_up",i=T(),s=I("div"),a=I("span"),a.textContent="keyboard_arrow_down",l=T(),c=I("div"),c.innerHTML='<span class="material-icons-round svelte-1incu58">view_module</span>',u=T(),g&&g.c(),h=N(),P(r,"class","material-icons-round svelte-1incu58"),P(n,"class","svelte-1incu58"),P(a,"class","material-icons-round svelte-1incu58"),P(s,"class","svelte-1incu58"),P(c,"class","svelte-1incu58"),P(t,"class","svelte-1incu58")},m(o,_){x(o,t,_),w(t,n),w(n,r),w(t,i),w(t,s),w(s,a),w(t,l),w(t,c),x(o,u,_),g&&g.m(o,_),x(o,h,_),d=!0,f||(p=[R(r,"click",e[5]),R(a,"click",e[6]),R(c,"click",e[7])],f=!0)},p(e,t){e[1]>950?g?2&t&&ae(g,1):(g=zf(),g.c(),ae(g,1),g.m(h.parentNode,h)):g&&(oe(),le(g,1,1,(()=>{g=null})),se())},i(e){d||(ae(g),d=!0)},o(e){le(g),d=!1},d(e){e&&k(t),e&&k(u),g&&g.d(e),e&&k(h),f=!1,o(p)}}}function zf(e){let t,n,r;return{c(){t=I("div"),t.textContent="About",P(t,"class","btn clickable active btn-about svelte-1incu58")},m(e,n){x(e,t,n),r=!0},i(e){r||(X((()=>{n||(n=ue(t,Ue,{},!0)),n.run(1)})),r=!0)},o(e){n||(n=ue(t,Ue,{},!1)),n.run(0),r=!1},d(e){e&&k(t),e&&n&&n.end()}}}function Bf(e){let t,n,r,i,o,s,a,l,c,u,h,d,f,p,g;function _(e,t){return"gallery"==e[0]?qf:Ff}let m=_(e),v=m(e),y="gallery"==e[0]&&jf(e);return{c(){t=I("header"),n=I("div"),r=I("div"),i=I("span"),i.textContent="How We Gaze",o=T(),s=I("span"),s.textContent="-",a=T(),v.c(),l=T(),c=I("div"),y&&y.c(),u=T(),h=I("div"),h.innerHTML='<span class="material-icons-round svelte-1incu58">arrow_back</span> \n\n        <span>Back to Gallery</span>',P(s,"class","divider svelte-1incu58"),P(r,"class","header-left"),P(h,"class","btn clickable svelte-1incu58"),L(h,"active","record"===e[0]),P(c,"class","header-right svelte-1incu58"),P(n,"class","header-content svelte-1incu58"),P(t,"class","svelte-1incu58")},m(d,_){x(d,t,_),w(t,n),w(n,r),w(r,i),w(r,o),w(r,s),w(r,a),v.m(r,null),w(n,l),w(n,c),y&&y.m(c,null),w(c,u),w(c,h),f=!0,p||(g=R(h,"click",e[8]),p=!0)},p(e,[t]){m===(m=_(e))&&v?v.p(e,t):(v.d(1),v=m(e),v&&(v.c(),v.m(r,null))),"gallery"==e[0]?y?(y.p(e,t),1&t&&ae(y,1)):(y=jf(e),y.c(),ae(y,1),y.m(c,u)):y&&(oe(),le(y,1,1,(()=>{y=null})),se()),1&t&&L(h,"active","record"===e[0])},i(e){f||(ae(y),X((()=>{d||(d=ue(h,He,{duration:500},!0)),d.run(1)})),f=!0)},o(e){le(y),d||(d=ue(h,He,{duration:500},!1)),d.run(0),f=!1},d(e){e&&k(t),v.d(),y&&y.d(),e&&d&&d.end(),p=!1,g()}}}function Wf(e,t,n){let r,i,o,s,a,l;function c(e){let t=r.indexOf(i)+e;pf(`${r[t]}`)}d(e,Pf,(e=>n(9,r=e))),d(e,De,(e=>n(10,i=e))),d(e,we,(e=>n(0,o=e))),d(e,Ae,(e=>n(1,s=e))),d(e,Ie,(e=>n(2,a=e))),d(e,Se,(e=>n(3,l=e)));return[o,s,a,l,c,()=>{c(-1)},()=>{c(1)},()=>{be.set("nav")},()=>{a&&l&&Jd(),we.set("gallery")}]}class Uf extends me{constructor(e){super(),_e(this,e,Wf,Bf,a,{})}}function Hf(t){let n,r,i,o,s,a,l;return{c(){n=I("h3"),n.textContent="Record Your Gaze: Overview",r=T(),i=I("p"),i.textContent="In order to generate a visualization of your viewing session, we’ll ask you to\r\n  study a piece of artwork for 15 seconds with your webcam turned on.",o=T(),s=I("p"),s.innerHTML="<strong>No personal information will be recorded.</strong> The only information\n  that will be recorded is a series of points corresponding to your eye movement.\n  Please enable webcam permission to proceed!",a=T(),l=I("p"),l.textContent="This should take about 5 minutes total."},m(e,t){x(e,n,t),x(e,r,t),x(e,i,t),x(e,o,t),x(e,s,t),x(e,a,t),x(e,l,t)},p:e,i:e,o:e,d(e){e&&k(n),e&&k(r),e&&k(i),e&&k(o),e&&k(s),e&&k(a),e&&k(l)}}}class Vf extends me{constructor(e){super(),_e(this,e,null,Hf,a,{})}}function Gf(t){let n,r,i;return{c(){n=I("h3"),n.textContent="Calibrate: Video",r=T(),i=I("p"),i.textContent="We’ll need to first calibrate your webcam in order to proceed. Ensure that\r\n    your are in a well-lit environment, and that your face is in the green\r\n    section of the screen below.",P(i,"class","inst")},m(e,t){x(e,n,t),x(e,r,t),x(e,i,t)},p:e,d(e){e&&k(n),e&&k(r),e&&k(i)}}}function Yf(e){let t,n,r,i,o,s,a,l;return{c(){t=I("h3"),t.textContent="Existing Calibration Loaded",n=T(),r=I("p"),i=S("Your webcam was already calibrated with an accuracy rate of "),o=I("strong"),s=S(e[2]),a=S("%"),l=S(". Please ensure your face is centered below, then click to proceed and view\r\n    art!"),P(r,"class","inst")},m(e,c){x(e,t,c),x(e,n,c),x(e,r,c),w(r,i),w(r,o),w(o,s),w(o,a),w(r,l)},p(e,t){4&t&&M(s,e[2])},d(e){e&&k(t),e&&k(n),e&&k(r)}}}function Kf(e){let t;return{c(){t=I("div"),t.innerHTML="<p>Initializing Video Stream...</p>",P(t,"class","video-wrapper glow svelte-10bw9l4")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Xf(t){let n,r;function i(e,t){return 1==e[0]?Yf:0==e[0]?Gf:void 0}let o=i(t),s=o&&o(t),a=!t[1]&&Kf();return{c(){s&&s.c(),n=T(),a&&a.c(),r=N()},m(e,t){s&&s.m(e,t),x(e,n,t),a&&a.m(e,t),x(e,r,t)},p(e,[t]){o===(o=i(e))&&s?s.p(e,t):(s&&s.d(1),s=o&&o(e),s&&(s.c(),s.m(n.parentNode,n))),e[1]?a&&(a.d(1),a=null):a||(a=Kf(),a.c(),a.m(r.parentNode,r))},i:e,o:e,d(e){s&&s.d(e),e&&k(n),a&&a.d(e),e&&k(r)}}}function Qf(e,t,n){let r,i,o;d(e,Se,(e=>n(1,r=e))),d(e,Ie,(e=>n(3,i=e))),d(e,Te,(e=>n(2,o=e)));let{calibrated:s}=t;return e.$$set=e=>{"calibrated"in e&&n(0,s=e.calibrated)},e.$$.update=()=>{10&e.$$.dirty&&i&&(r?async function(){let e=document.querySelector("#webgazerVideoContainer");document.querySelector(".container-body").append(e),await webgazer.resume(),ef(),nf()}():setTimeout((()=>{!async function(){console.log("gazer video init"),await webgazer.resume(),ef(),nf(),Se.set(!0),console.log("video done init")}()}),200))},[s,r,o,i]}class Jf extends me{constructor(e){super(),_e(this,e,Qf,Xf,a,{calibrated:0})}}function Zf(e,t,n){const r=e.slice();return r[7]=t[n],r}function ep(e){let t;function n(e,t){return e[1]>e[3]?ip:rp}let r=n(e),i=r(e);return{c(){i.c(),t=N()},m(e,n){i.m(e,n),x(e,t,n)},p(e,o){r===(r=n(e))&&i?i.p(e,o):(i.d(1),i=r(e),i&&(i.c(),i.m(t.parentNode,t)))},d(e){i.d(e),e&&k(t)}}}function tp(e){let t,n,r,i,o,s,a;return{c(){t=I("p"),t.textContent="Great work! Now stare at the dot at the center of the screen for 5 seconds\r\n    so we can calculate your accuracy rate!",n=T(),r=I("div"),r.textContent="Start staring!",i=T(),o=I("div"),P(t,"class","svelte-19g2675"),P(r,"class","clickable btn btn-stare accent svelte-19g2675"),L(r,"disabled",e[2]),P(o,"class","center-dot svelte-19g2675")},m(l,c){x(l,t,c),x(l,n,c),x(l,r,c),x(l,i,c),x(l,o,c),s||(a=R(r,"click",e[6]),s=!0)},p(e,t){4&t&&L(r,"disabled",e[2])},d(e){e&&k(t),e&&k(n),e&&k(r),e&&k(i),e&&k(o),s=!1,a()}}}function np(e){let t,n=e[4],r=[];for(let t=0;t<n.length;t+=1)r[t]=op(Zf(e,n,t));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=N()},m(e,n){for(let t=0;t<r.length;t+=1)r[t].m(e,n);x(e,t,n)},p(e,i){if(48&i){let o;for(n=e[4],o=0;o<n.length;o+=1){const s=Zf(e,n,o);r[o]?r[o].p(s,i):(r[o]=op(s),r[o].c(),r[o].m(t.parentNode,t))}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length}},d(e){E(r,e),e&&k(t)}}}function rp(e){let t,n,r,i,o,s,a,l,c,u,h;return{c(){t=I("p"),n=S("Your calculated accuracy is "),r=I("strong"),i=S(e[1]),o=S("%"),s=S("."),a=T(),l=I("p"),c=S("Unfortunately we require an accuracy rate of "),u=S(e[3]),h=S("% or\r\n      higher to proceed! Please re-do your calibration, or exit to gallery."),O(t,"color","var(--color-neg)"),P(t,"class","svelte-19g2675"),P(l,"class","svelte-19g2675")},m(e,d){x(e,t,d),w(t,n),w(t,r),w(r,i),w(r,o),w(t,s),x(e,a,d),x(e,l,d),w(l,c),w(l,u),w(l,h)},p(e,t){2&t&&M(i,e[1]),8&t&&M(u,e[3])},d(e){e&&k(t),e&&k(a),e&&k(l)}}}function ip(e){let t,n,r,i,o,s,a,l,c,u,h,d,f,p=100-e[1]+"";return{c(){t=I("p"),n=S("Your calculated accuracy is "),r=I("strong"),i=S(e[1]),o=S("%"),s=S("!"),a=T(),l=I("p"),c=S("This means that the eye tracker can detect your eye movements with a\r\n      margin of error of "),u=S(p),h=S("% of the size of the container\r\n      that holds this text."),d=T(),f=I("p"),f.textContent="Not perfect, but good enough to deduce patterns in how you look at art!\r\n      Lastly, please look at the selected piece of artwork (full-screen) for 20\r\n      seconds, and we’ll generate a custom visual summarizing how you viewed the\r\n      painting.",O(t,"color","var(--color-pos)"),P(t,"class","svelte-19g2675"),P(l,"class","svelte-19g2675"),P(f,"class","svelte-19g2675")},m(e,p){x(e,t,p),w(t,n),w(t,r),w(r,i),w(r,o),w(t,s),x(e,a,p),x(e,l,p),w(l,c),w(l,u),w(l,h),x(e,d,p),x(e,f,p)},p(e,t){2&t&&M(i,e[1]),2&t&&p!==(p=100-e[1]+"")&&M(u,p)},d(e){e&&k(t),e&&k(a),e&&k(l),e&&k(d),e&&k(f)}}}function op(t){let n,r,i;return{c(){n=I("div"),P(n,"class","calibration-pt svelte-19g2675"),O(n,"top",t[7].top),O(n,"right",t[7].right),P(n,"numclicks","0")},m(e,o){x(e,n,o),r||(i=R(n,"click",t[5]),r=!0)},p:e,d(e){e&&k(n),r=!1,i()}}}function sp(t){let n,r,i;function o(e,t){return"dots"==e[0]?np:"stare"==e[0]?tp:"done"==e[0]?ep:void 0}let s=o(t),a=s&&s(t);return{c(){n=I("h3"),n.textContent="Calibrate: Exercise",r=T(),a&&a.c(),i=N()},m(e,t){x(e,n,t),x(e,r,t),a&&a.m(e,t),x(e,i,t)},p(e,[t]){s===(s=o(e))&&a?a.p(e,t):(a&&a.d(1),a=s&&s(e),a&&(a.c(),a.m(i.parentNode,i)))},i:e,o:e,d(e){e&&k(n),e&&k(r),a&&a.d(e),e&&k(i)}}}function ap(e,t,n){let r,i;d(e,Te,(e=>n(1,r=e))),d(e,Ne,(e=>n(3,i=e)));let o="dots";!async function(){webgazer.addMouseEventListeners()}();let s,a=[];for(let e=0;e<4;e++){let t=7,n=5,r=n+(95-n)/3*e,i=(93-t)/3;for(let e=0;e<4;e++){let n=t+i*e;a.push({top:`${r}%`,right:`${n}%`,numClicks:0})}}return e.$$.update=()=>{3&e.$$.dirty&&("stare"==o&&nf(),r&&n(0,o="done")),e.$$.dirty},[o,r,s,i,a,function(e){let t=parseInt(this.getAttribute("numclicks"))+1;this.setAttribute("numclicks",t),this.style.opacity=1-t*(1/3),3==t&&function(){let e=document.querySelectorAll(".calibration-pt"),t=!0;return e.forEach((e=>{parseInt(e.getAttribute("numclicks"))<3&&(t=!1)})),t}()&&n(0,o="stare")},()=>{n(2,s=!0),tf()}]}class lp extends me{constructor(e){super(),_e(this,e,ap,sp,a,{})}}function cp(t){let n,r,i,o,s;return{c(){n=I("h3"),n.textContent="Calibrate: Instructions",r=T(),i=I("p"),i.textContent="Great! Your face calibration will be displayed on the right for reference.\r\n  Next, we’ll calibrate your eye tracking movement on the screen. Remember these\r\n  two rules!",o=T(),s=I("div"),s.innerHTML='<div class="svelte-1i27hj5"><p class="svelte-1i27hj5">#1: Eyes on cursor at all times</p> \n    <img src="./assets/img/explain-eye.svg"/></div> \n  <div class="svelte-1i27hj5"><p class="svelte-1i27hj5">#2: Move cursor to each red dot, and click on dot until it disappears</p> \n    <img src="./assets/img/explain-cursor.svg"/></div>',P(i,"class","instr svelte-1i27hj5"),P(s,"class","explain svelte-1i27hj5")},m(e,t){x(e,n,t),x(e,r,t),x(e,i,t),x(e,o,t),x(e,s,t)},p:e,i:e,o:e,d(e){e&&k(n),e&&k(r),e&&k(i),e&&k(o),e&&k(s)}}}class up extends me{constructor(e){super(),_e(this,e,null,cp,a,{})}}function hp(t){let n,r,i,s,a,l,c,u,h,d;return{c(){n=I("h3"),n.textContent="Calibrate: Results",r=T(),i=I("p"),i.textContent="Great work! We’re generating your custom visualization (it will take up to 30\r\n  seconds). In the meantime, enter the name with which you’d like associate your\r\n  visualization in the gallery!",s=T(),a=I("div"),l=I("input"),c=T(),u=I("div"),u.textContent="Save & View",P(l,"placeholder","Enter name here"),P(l,"class","svelte-18s0wyp"),P(u,"class","btn accent clickable svelte-18s0wyp"),L(u,"disabled-part",1==t[0]),P(a,"class","input-wrapper svelte-18s0wyp")},m(e,o){x(e,n,o),x(e,r,o),x(e,i,o),x(e,s,o),x(e,a,o),w(a,l),A(l,t[1]),w(a,c),w(a,u),h||(d=[R(l,"input",t[3]),R(l,"keyup",t[4]),R(u,"click",t[2])],h=!0)},p(e,[t]){2&t&&l.value!==e[1]&&A(l,e[1]),1&t&&L(u,"disabled-part",1==e[0])},i:e,o:e,d(e){e&&k(n),e&&k(r),e&&k(i),e&&k(s),e&&k(a),h=!1,o(d)}}}function dp(e,t,n){let r,i,o;d(e,Ce,(e=>n(5,r=e))),d(e,ke,(e=>n(6,i=e))),d(e,Me,(e=>n(7,o=e)));let s,a=o,l=i,c=r.key,u=Ce,h=!1;async function f(){n(0,h=!0),await aa("works/"+c+"/sessionData/"+a+"/name",s),new MutationObserver((e=>{e[0].removedNodes.length>0&&(console.log(Ce.key),Le.set(Ce.key),we.set("gallery"))})).observe(document.querySelector(".container-body"),{childList:!0,subtree:!1,characterDataOldValue:!0}),Jd()}!async function(){await aa("sessionData/"+a,l),await aa("sessionData/"+a,l)}(),async function(){let e=await sa("works/"+c);console.log(e),e||await aa("works/"+c,u),await aa("works/"+c+"/sessionData/"+a,{name:"Anonymous"})}();return[h,s,f,function(){s=this.value,n(1,s)},e=>{13===e.keyCode?f():n(0,h=!1)}]}class fp extends me{constructor(e){super(),_e(this,e,dp,hp,a,{})}}function pp(t){let n,r,i,o,s,a;return{c(){n=I("div"),r=I("div"),i=I("img"),s=T(),a=I("p"),a.textContent="Please look at the following image for 20 seconds",P(i,"id","artView"),c(i.src,o=t[1].url)||P(i,"src",o),P(i,"class","svelte-1iaoraq"),L(i,"inactive",1==t[0]),P(a,"class","svelte-1iaoraq"),L(a,"inactive",0==t[0]),P(r,"class","img-holder svelte-1iaoraq"),P(n,"class","wrapper-full svelte-1iaoraq")},m(e,t){x(e,n,t),w(n,r),w(r,i),w(r,s),w(r,a)},p(e,[t]){2&t&&!c(i.src,o=e[1].url)&&P(i,"src",o),1&t&&L(i,"inactive",1==e[0]),1&t&&L(a,"inactive",0==e[0])},i:e,o:e,d(e){e&&k(n)}}}function gp(e,t,n){let r;d(e,Ce,(e=>n(1,r=e)));let i=!0;return setTimeout((()=>{n(0,i=!1),async function(){let e=document.querySelector("#artView").getBoundingClientRect();webgazer.setGazeListener((function(t,n){if(null==t)return;let r={time:n,x:t.x-e.x,y:t.y-e.y,xPct:100*(t.x-e.x)/e.width,yPct:100*(t.y-e.y)/e.height,xMin:e.left,xMax:e.right,yMin:e.top,yMax:e.bottom,sessionID:h(Me)},i=h(ke);i.push(r),ke.set(i)})),setTimeout((()=>{webgazer.clearGazeListener(),console.log(h(ke)),Re.set(h(Re)+1)}),2e4)}()}),3e3),[i,r]}class _p extends me{constructor(e){super(),_e(this,e,gp,pp,a,{})}}function mp(e,t,n){const r=e.slice();return r[22]=t[n],r}function vp(e){let t;return{c(){t=I("div"),P(t,"class","nav-dot svelte-1c3jx3e"),L(t,"active",e[0][e[2]]===e[22])},m(e,n){x(e,t,n)},p(e,n){5&n&&L(t,"active",e[0][e[2]]===e[22])},d(e){e&&k(t)}}}function yp(t){let n,r;return n=new fp({}),{c(){de(n.$$.fragment)},m(e,t){fe(n,e,t),r=!0},p:e,i(e){r||(ae(n.$$.fragment,e),r=!0)},o(e){le(n.$$.fragment,e),r=!1},d(e){pe(n,e)}}}function wp(t){let n,r;return n=new _p({}),{c(){de(n.$$.fragment)},m(e,t){fe(n,e,t),r=!0},p:e,i(e){r||(ae(n.$$.fragment,e),r=!0)},o(e){le(n.$$.fragment,e),r=!1},d(e){pe(n,e)}}}function bp(t){let n,r;return n=new lp({}),{c(){de(n.$$.fragment)},m(e,t){fe(n,e,t),r=!0},p:e,i(e){r||(ae(n.$$.fragment,e),r=!0)},o(e){le(n.$$.fragment,e),r=!1},d(e){pe(n,e)}}}function Cp(t){let n,r;return n=new up({}),{c(){de(n.$$.fragment)},m(e,t){fe(n,e,t),r=!0},p:e,i(e){r||(ae(n.$$.fragment,e),r=!0)},o(e){le(n.$$.fragment,e),r=!1},d(e){pe(n,e)}}}function xp(e){let t,n,r;return n=new Jf({props:{calibrated:e[6]}}),{c(){t=I("div"),de(n.$$.fragment)},m(e,i){x(e,t,i),fe(n,t,null),r=!0},p(e,t){const r={};64&t&&(r.calibrated=e[6]),n.$set(r)},i(e){r||(ae(n.$$.fragment,e),r=!0)},o(e){le(n.$$.fragment,e),r=!1},d(e){e&&k(t),pe(n)}}}function kp(t){let n,r,i;return r=new Vf({}),{c(){n=I("div"),de(r.$$.fragment)},m(e,t){x(e,n,t),fe(r,n,null),i=!0},p:e,i(e){i||(ae(r.$$.fragment,e),i=!0)},o(e){le(r.$$.fragment,e),i=!1},d(e){e&&k(n),pe(r)}}}function Ep(e){let t,n,r,i,o=e[0][e[2]].btnBackLabel+"";return{c(){t=I("div"),n=S(o),P(t,"class","btn-prev btn disabled svelte-1c3jx3e"),L(t,"accent",e[1]&&e[1]<70),L(t,"disabled",1==e[3])},m(o,s){x(o,t,s),w(t,n),r||(i=R(t,"click",e[14]),r=!0)},p(e,r){5&r&&o!==(o=e[0][e[2]].btnBackLabel+"")&&M(n,o),2&r&&L(t,"accent",e[1]&&e[1]<70),8&r&&L(t,"disabled",1==e[3])},d(e){e&&k(t),r=!1,i()}}}function Ip(e){let t,n,r;return{c(){t=I("div"),t.textContent="Re-Calibrate",P(t,"class","btn re-cal clickable svelte-1c3jx3e"),L(t,"disabled",0==e[6])},m(i,o){x(i,t,o),n||(r=R(t,"click",e[9]),n=!0)},p(e,n){64&n&&L(t,"disabled",0==e[6])},d(e){e&&k(t),n=!1,r()}}}function Sp(e){let t,n,r;function i(e,t){return e[8]?Np:Tp}let o=i(e),s=o(e);return{c(){t=I("div"),s.c(),P(t,"class","btn-next btn accent clickable svelte-1c3jx3e"),L(t,"disabled",e[8]||e[4]),L(t,"glow",e[8])},m(i,o){x(i,t,o),s.m(t,null),n||(r=R(t,"click",e[15]),n=!0)},p(e,n){o===(o=i(e))&&s?s.p(e,n):(s.d(1),s=o(e),s&&(s.c(),s.m(t,null))),272&n&&L(t,"disabled",e[8]||e[4]),256&n&&L(t,"glow",e[8])},d(e){e&&k(t),s.d(),n=!1,r()}}}function Tp(e){let t,n=e[0][e[2]].btnLabel+"";return{c(){t=S(n)},m(e,n){x(e,t,n)},p(e,r){5&r&&n!==(n=e[0][e[2]].btnLabel+"")&&M(t,n)},d(e){e&&k(t)}}}function Np(t){let n;return{c(){n=S("Loading...")},m(e,t){x(e,n,t)},p:e,d(e){e&&k(n)}}}function Rp(e){let t,n,r,i,o,s,a,l,c,u,h,d,f,p,g,_,m,v,y=e[7].title+"",b=e[7].artist+"",C=e[0],N=[];for(let t=0;t<C.length;t+=1)N[t]=vp(mp(e,C,t));const R=[kp,xp,Cp,bp,wp,yp],A=[];function O(e,t){return"overview"==e[0][e[2]].sectionName?0:"calibrate-vid"==e[0][e[2]].sectionName?1:"calibrate-instructions"==e[0][e[2]].sectionName?2:"calibrate-exercise"==e[0][e[2]].sectionName?3:"view"==e[0][e[2]].sectionName?4:"results"==e[0][e[2]].sectionName?5:-1}function D(e,t){return e[6]&&e[2]!==e[0].length-1?Ip:Ep}~(f=O(e))&&(p=A[f]=R[f](e));let L=D(e),$=L(e),F=!e[5]&&Sp(e);return{c(){t=I("section"),n=I("div"),r=I("div"),i=S("Gazing at:"),o=I("span"),s=S(y),a=S(" by "),l=S(b),c=T(),u=I("div");for(let e=0;e<N.length;e+=1)N[e].c();h=T(),d=I("div"),p&&p.c(),g=T(),_=I("div"),$.c(),m=T(),F&&F.c(),P(o,"class","selection-holder svelte-1c3jx3e"),P(r,"class","current-selection"),P(u,"class","nav-ind svelte-1c3jx3e"),P(n,"class","container-header svelte-1c3jx3e"),P(d,"class","container-body svelte-1c3jx3e"),P(_,"class","container-footer svelte-1c3jx3e"),P(t,"class","experiment-container svelte-1c3jx3e")},m(e,p){x(e,t,p),w(t,n),w(n,r),w(r,i),w(r,o),w(o,s),w(o,a),w(o,l),w(n,c),w(n,u);for(let e=0;e<N.length;e+=1)N[e].m(u,null);w(t,h),w(t,d),~f&&A[f].m(d,null),w(t,g),w(t,_),$.m(_,null),w(_,m),F&&F.m(_,null),v=!0},p(e,[t]){if((!v||128&t)&&y!==(y=e[7].title+"")&&M(s,y),(!v||128&t)&&b!==(b=e[7].artist+"")&&M(l,b),5&t){let n;for(C=e[0],n=0;n<C.length;n+=1){const r=mp(e,C,n);N[n]?N[n].p(r,t):(N[n]=vp(r),N[n].c(),N[n].m(u,null))}for(;n<N.length;n+=1)N[n].d(1);N.length=C.length}let n=f;f=O(e),f===n?~f&&A[f].p(e,t):(p&&(oe(),le(A[n],1,1,(()=>{A[n]=null})),se()),~f?(p=A[f],p?p.p(e,t):(p=A[f]=R[f](e),p.c()),ae(p,1),p.m(d,null)):p=null),L===(L=D(e))&&$?$.p(e,t):($.d(1),$=L(e),$&&($.c(),$.m(_,m))),e[5]?F&&(F.d(1),F=null):F?F.p(e,t):(F=Sp(e),F.c(),F.m(_,null))},i(e){v||(ae(p),v=!0)},o(e){le(p),v=!1},d(e){e&&k(t),E(N,e),~f&&A[f].d(),$.d(),F&&F.d()}}}function Pp(e,t,n){let r,i,o,s,a,l,c,u;d(e,Ne,(e=>n(11,r=e))),d(e,Te,(e=>n(1,i=e))),d(e,Se,(e=>n(12,o=e))),d(e,Ie,(e=>n(13,s=e))),d(e,Re,(e=>n(2,a=e))),d(e,Me,(e=>n(18,l=e))),d(e,Ce,(e=>n(7,c=e))),d(e,Pe,(e=>n(8,u=e)));let h,p=!1,g=!1,_=!1,m=!1,v=[{sectionName:"overview",videoShown:!1,btnLabel:"Start!",disableBack:!0,showLoader:!0,btnBackLabel:"Back to Overview"},{sectionName:"calibrate-vid",videoShown:!0,videoPos:"middle",disableBack:!1,disableNext:!1,btnBackLabel:"Back to Overview",btnLabel:"Got It - Face is Aligned",showLoader:!0},{sectionName:"calibrate-instructions",videoShown:!0,videoPos:"top",btnBackLabel:"Back to Video Alignment",btnLabel:"Got It - Proceed"},{sectionName:"calibrate-exercise",videoShown:!0,videoPos:"top",disableNext:!0,btnBackLabel:"Restart Eye Calibration",btnLabel:"Proceed to View Art",gazerRecording:!0},{sectionName:"view",videoShown:!1,btnLabel:"Proceed",disableNext:!1,btnBackLabel:"Back to Calibration",showLoader:!0},{sectionName:"results",videoShown:!1,btnLabel:"View Pattern",disableBack:!0,hideNext:!0,btnBackLabel:"Back to Calibration"}],y=[{sectionName:"calibrate-vid",videoShown:!0,videoPos:"middle",disableBack:!0,disableNext:!1,btnBackLabel:"Back to Overview",btnLabel:"Got It - Face is Aligned",showLoader:!0},v[4],v[5]],w=v;!async function(){let e=await Qd.getItem("webgazerGlobalData"),t=await Qd.getItem("calibrationPct");Te.set(t),e&&(e.length>20&&t>r?(n(0,w=y),n(6,m=!0)):n(0,w=v))}(),W((()=>{Re.set(0),l||Me.set((new Date).getTime()),s||(console.log("gazer first init"),webgazer.showVideo(!1),webgazer.begin(),Zd()),document.querySelector("body").className="gaze"}));return e.$$.update=()=>{5125&e.$$.dirty&&(n(10,h=w[a]),1==h.videoShown&&1==o?(webgazer.showVideo(!0),function(e){let t=document.querySelector("#webgazerVideoContainer"),n=320;"top"==e?(n=110,webgazer.setVideoViewerSize(n,n),t.style.top="0%",t.style.left="90%",t.style.width=`${n}px`,t.style.height="auto"):"middle"==e&&(webgazer.setVideoViewerSize(n,n),t.style.width=`${n}px`,t.style.height="auto",t.style.position="absolute",t.style.left="50%",t.style.top="30%",t.style.transform="translate(-50%, -50%)")}(h.videoPos)):webgazer.showVideo(!1),h.disableBack?n(3,p=!0):n(3,p=!1),h.disableNext?n(4,g=!0):n(4,g=!1),h.hideNext?n(5,_=!0):n(5,_=!1)),13312&e.$$.dirty&&(v[0].loadingVar=s,v[1].loadingVar=o,y[0].loadingVar=o,h&&(1!=h.showLoader||h.loadingVar?Pe.set(!1):Pe.set(!0))),2050&e.$$.dirty&&i>r&&n(4,g=!1)},[w,i,a,p,g,_,m,c,u,function(){n(6,m=!1),n(0,w=v),Te.set(null),webgazer.clearData()},h,r,o,s,()=>{"calibrate-exercise"==w[a].sectionName&&(console.log("yea that me"),console.log("uh restarting i guess"),Te.set(null)),f(Re,a--,a)},()=>{a<w.length-2&&f(Re,a++,a)}]}class Mp extends me{constructor(e){super(),_e(this,e,Pp,Rp,a,{})}}function Ap(e,t,n){const r=e.slice();return r[5]=t[n],r}function Op(e){let t,n,r,i,o,s,a,l,u,h,d,f,p,g,_,m=e[5].title+"",v=e[5].artist+"";function y(){return e[4](e[5])}return{c(){t=I("div"),n=I("div"),r=I("img"),o=T(),s=I("div"),a=I("p"),l=I("strong"),u=S(m),h=T(),d=I("p"),f=S(v),p=T(),c(r.src,i=e[5].url)||P(r,"src",i),P(r,"class","svelte-3ck2ij"),P(n,"class","img-holder svelte-3ck2ij"),P(a,"class","svelte-3ck2ij"),P(d,"class","svelte-3ck2ij"),P(s,"class","txt-holder svelte-3ck2ij"),P(t,"class","artwork-holder clickable svelte-3ck2ij")},m(e,i){x(e,t,i),w(t,n),w(n,r),w(t,o),w(t,s),w(s,a),w(a,l),w(l,u),w(s,h),w(s,d),w(d,f),w(t,p),g||(_=R(t,"click",y),g=!0)},p(t,n){e=t,1&n&&!c(r.src,i=e[5].url)&&P(r,"src",i),1&n&&m!==(m=e[5].title+"")&&M(u,m),1&n&&v!==(v=e[5].artist+"")&&M(f,v)},d(e){e&&k(t),g=!1,_()}}}function Dp(e){let t,n,r,i,o,s,a,l,c,u,h,d,f=e[0],p=[];for(let t=0;t<f.length;t+=1)p[t]=Op(Ap(e,f,t));return{c(){t=I("div"),n=I("div"),r=I("div"),i=I("h1"),i.textContent="Navigate Artworks",o=T(),s=I("div"),s.innerHTML='<span class="material-icons-round svelte-3ck2ij">close</span>',a=T(),l=I("div");for(let e=0;e<p.length;e+=1)p[e].c();P(s,"class","btn clickable svelte-3ck2ij"),P(r,"class","cont-header svelte-3ck2ij"),P(l,"class","artwork-container svelte-3ck2ij"),P(n,"class","container svelte-3ck2ij"),P(t,"class","modal svelte-3ck2ij")},m(c,f){x(c,t,f),w(t,n),w(n,r),w(r,i),w(r,o),w(r,s),w(n,a),w(n,l);for(let e=0;e<p.length;e+=1)p[e].m(l,null);u=!0,h||(d=R(s,"click",e[3]),h=!0)},p(e,[t]){if(5&t){let n;for(f=e[0],n=0;n<f.length;n+=1){const r=Ap(e,f,n);p[n]?p[n].p(r,t):(p[n]=Op(r),p[n].c(),p[n].m(l,null))}for(;n<p.length;n+=1)p[n].d(1);p.length=f.length}},i(n){u||(X((()=>{c||(c=ue(t,e[1],{duration:150},!0)),c.run(1)})),u=!0)},o(n){c||(c=ue(t,e[1],{duration:150},!1)),c.run(0),u=!1},d(e){e&&k(t),E(p,e),e&&c&&c.end(),h=!1,d()}}}function Lp(e,t,n){let r;function i(e){pf(`${e.key}`),be.set(null)}d(e,Mf,(e=>n(0,r=e)));return[r,function(e,t){const n=He(e,t);return{duration:t.duration,css:e=>`\n\t\t\t\t${n.css(e)}\n\t\t\t\topacity: ${e};\n\t\t\t`}},i,()=>{be.set(null)},e=>{i(e)}]}class $p extends me{constructor(e){super(),_e(this,e,Lp,Dp,a,{})}}function Fp(t){let n,r,i,s,a,l,c,u,h,d,f,p,g,_,m,v,y,b,C;return{c(){n=I("main"),r=I("div"),r.textContent="Skip Intro",i=T(),s=I("section"),s.innerHTML='<h1 class="svelte-1bdp7c7">How We Gaze</h1>',a=T(),l=I("section"),l.innerHTML='<p class="svelte-1bdp7c7">Imagine a piece of art that you love. How do you look at it?</p>',c=T(),u=I("section"),u.innerHTML='<p class="svelte-1bdp7c7">Do you study the work bit-by-bit? Or do admire it from a distance, and\n      take in as a whole?</p>',h=T(),d=I("section"),d.innerHTML='<p class="svelte-1bdp7c7">How would someone else look at the same work?</p>',f=T(),p=I("section"),p.innerHTML='<p class="svelte-1bdp7c7">What might we learn about someone by seeing how they see?</p>',g=T(),_=I("section"),m=I("div"),m.innerHTML='<span>Enter Gallery</span> \n\n      <span class="material-icons-round" style="font-size: 40px;margin-left: 10px">auto_awesome</span>',P(r,"class","btn-close clickable svelte-1bdp7c7"),P(s,"class","introbg svelte-1bdp7c7"),P(l,"class","svelte-1bdp7c7"),P(u,"class","svelte-1bdp7c7"),P(d,"class","svelte-1bdp7c7"),P(p,"class","svelte-1bdp7c7"),P(m,"class","btn svelte-1bdp7c7"),P(_,"class","svelte-1bdp7c7"),P(n,"class","svelte-1bdp7c7")},m(e,o){x(e,n,o),w(n,r),w(n,i),w(n,s),w(n,a),w(n,l),w(n,c),w(n,u),w(n,h),w(n,d),w(n,f),w(n,p),w(n,g),w(n,_),w(_,m),y=!0,b||(C=[R(r,"click",t[2]),R(m,"click",t[3])],b=!0)},p:e,i(e){y||(X((()=>{v||(v=ue(n,t[1],{duration:300},!0)),v.run(1)})),y=!0)},o(e){v||(v=ue(n,t[1],{duration:300},!1)),v.run(0),y=!1},d(e){e&&k(n),e&&v&&v.end(),b=!1,o(C)}}}function qp(e,t,n){let r;d(e,be,(e=>n(0,r=e)));return[r,function(e,t){const n=He(e,t);return{duration:t.duration,css:e=>`\n\t\t\t\t${n.css(e)}\n\t\t\t\topacity: ${e};\n\t\t\t`}},()=>{f(be,r=null,r)},()=>{f(be,r=null,r)}]}class jp extends me{constructor(e){super(),_e(this,e,qp,Fp,a,{})}}const{document:zp}=he;function Bp(e){let t,n;return t=new jp({}),{c(){de(t.$$.fragment)},m(e,r){fe(t,e,r),n=!0},i(e){n||(ae(t.$$.fragment,e),n=!0)},o(e){le(t.$$.fragment,e),n=!1},d(e){pe(t,e)}}}function Wp(e){let t,n;return t=new $p({}),{c(){de(t.$$.fragment)},m(e,r){fe(t,e,r),n=!0},i(e){n||(ae(t.$$.fragment,e),n=!0)},o(e){le(t.$$.fragment,e),n=!1},d(e){pe(t,e)}}}function Up(e){let t,n,r,i;return n=new Mp({}),{c(){t=I("div"),de(n.$$.fragment),O(t,"height","auto"),O(t,"width","auto")},m(e,r){x(e,t,r),fe(n,t,null),i=!0},i(e){i||(ae(n.$$.fragment,e),X((()=>{r||(r=ue(t,Ue,{},!0)),r.run(1)})),i=!0)},o(e){le(n.$$.fragment,e),r||(r=ue(t,Ue,{},!1)),r.run(0),i=!1},d(e){e&&k(t),pe(n),e&&r&&r.end()}}}function Hp(e){let t,n,r,i;return n=new $f({}),{c(){t=I("div"),de(n.$$.fragment),O(t,"height","auto"),O(t,"width","auto")},m(e,r){x(e,t,r),fe(n,t,null),i=!0},i(e){i||(ae(n.$$.fragment,e),X((()=>{r||(r=ue(t,Ue,{},!0)),r.run(1)})),i=!0)},o(e){le(n.$$.fragment,e),r||(r=ue(t,Ue,{},!1)),r.run(0),i=!1},d(e){e&&k(t),pe(n),e&&r&&r.end()}}}function Vp(e){let t,n,r,i,o,s,a,l,u,h,d,f,p,g,_,m="intro"==e[0]&&Bp();r=new Uf({});let v="nav"==e[0]&&Wp();const y=[Hp,Up],b=[];function C(e,t){return"gallery"==e[1]?0:"record"==e[1]?1:-1}return~(a=C(e))&&(l=b[a]=y[a](e)),{c(){m&&m.c(),t=T(),n=I("main"),de(r.$$.fragment),i=T(),o=I("div"),v&&v.c(),s=T(),l&&l.c(),u=T(),h=I("html"),d=I("script"),P(o,"class","container"),zp.title="How We Gaze",P(h,"lang","en"),c(d.src,f="./assets/webgazer.min.js")||P(d,"src","./assets/webgazer.min.js")},m(l,c){m&&m.m(l,c),x(l,t,c),x(l,n,c),fe(r,n,null),w(n,i),w(n,o),v&&v.m(o,null),w(o,s),~a&&b[a].m(o,null),x(l,u,c),w(zp.head,h),w(zp.head,d),p=!0,g||(_=R(d,"load",e[2]),g=!0)},p(e,[n]){"intro"==e[0]?m?1&n&&ae(m,1):(m=Bp(),m.c(),ae(m,1),m.m(t.parentNode,t)):m&&(oe(),le(m,1,1,(()=>{m=null})),se()),"nav"==e[0]?v?1&n&&ae(v,1):(v=Wp(),v.c(),ae(v,1),v.m(o,s)):v&&(oe(),le(v,1,1,(()=>{v=null})),se());let r=a;a=C(e),a!==r&&(l&&(oe(),le(b[r],1,1,(()=>{b[r]=null})),se()),~a?(l=b[a],l||(l=b[a]=y[a](e),l.c()),ae(l,1),l.m(o,null)):l=null)},i(e){p||(ae(m),ae(r.$$.fragment,e),ae(v),ae(l),p=!0)},o(e){le(m),le(r.$$.fragment,e),le(v),le(l),p=!1},d(e){m&&m.d(e),e&&k(t),e&&k(n),pe(r),v&&v.d(),~a&&b[a].d(),e&&k(u),k(h),k(d),g=!1,_()}}}function Gp(e,t,n){let r,i;function o(){Ae.set(ze().windowW),Oe.set(ze().windowH)}d(e,be,(e=>n(0,r=e))),d(e,we,(e=>n(1,i=e))),Ve({duration:1500,easing:We}),W((()=>{o()})),window.onresize=function(){o()};return e.$$.update=()=>{1&e.$$.dirty&&(document.querySelector("body").style.overflow=r?"hidden":"auto")},[r,i,()=>{Ee.set(!0)}]}const Yp=new class extends me{constructor(e){super(),_e(this,e,Gp,Vp,a,{})}}({target:document.body,props:{name:"world"}});return Yp}();
//# sourceMappingURL=bundle.js.map
